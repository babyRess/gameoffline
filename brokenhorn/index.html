<!DOCTYPE html>
<html lang="en">
<head>
	
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>BrokenHorn</title>
	
	<script src="./jquery-1.11.0.min.js"></script>
	
	
	<meta id="viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<meta name="apple-mobile-web-app-capable" content="yes">
	
	
	<script type="text/javascript" src="./lib/soundjs.min.js"></script>
	<script type="text/javascript" src="./BrokenHorn.js"></script>
	
	<script>
		window.addEventListener ("touchmove", function (event) { event.preventDefault (); }, false);
		if (typeof window.devicePixelRatio != 'undefined' && window.devicePixelRatio > 2) {
			var meta = document.getElementById ("viewport");
			meta.setAttribute ('content', 'width=device-width, initial-scale=' + (2 / window.devicePixelRatio) + ', user-scalable=no');
		}
	</script>
	
	<style>
		html,body { margin: 0; padding: 0; height: 100%; overflow: hidden; }
		#openfl-content { background: #000000; width: 100%; height: 100%; }
		
	</style>
	
</head>
<body>
	
	<div id="openfl-content"></div>
	
	<script type="text/javascript">
		lime.embed ("openfl-content", 0, 0, "000000");
	</script>
	
	<script type="text/javascript">
		window.idAsyncInit = function() {
			// use an idnet event to wait until after init
			ID.Event.subscribe('id.init', function() {
				// use jquery to call methods on clicks
	
				//ID.login(idCallback);
				//ID.register(idCallback);
				
				ID.Protection.isSponsor(preIsSponsorCallback);
			});
			// using an optional callback to capture data on the client
			var idCallback = function(response) {
				if (response) { // That means that the server processed the response
					console.log(response);
					console.log(response.authResponse.details);
				}
			}
			// init the JS interface
			ID.init({
				<!-- appId : '56d7fc76e694aa634b0020a3' -->
				appId : '56d7fc76e694aa634b0020a3'
			});
			// Additional initialization code such as adding Event Listeners goes here
		};
		
		// load the idnet js interface
		(function(d, s, id) {
			var js, fjs = d.getElementsByTagName(s)[0];
			if (d.getElementById(id)) {return;}
			js = d.createElement(s); js.id = id;
			js.src = "./sdk.js";
			fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'id-jssdk'));
		
		var save = {};
		var totalScore = 0;
		var awardsObject = {};
		var awardName;
		var awardKey;
		
		var registerCallback = function(response) {
			//console.log("registerCallback");
			//console.log(response);
			Main.ref.idnetHandler(response, "register");
			//document.getElementById('openfl-content').jsHandler(response);
		}
		var loginCallback = function(response) {
			//console.log("loginCallback");
			//console.log(response);
			Main.ref.idnetHandler(response, "login");
		}		
		var getLoginStatusCallback = function(response) {
			//console.log("getLoginStatusCallback");
			//console.log(response);
			Main.ref.idnetHandler(response, "getLoginStatus");
		}
		var loadSaveCallback = function(response) {
			//console.log("loadSaveCallback");
			//console.log(response);
			
			var from = "loadSave";
			
			if (response.error != null && response.error == "Key not found") {
				from = "resetSave";
			}
			var saveData = decodeURIComponent(response.jsondata);
			Main.ref.idnetHandler(saveData, from);
		}
		var removeSaveCallback = function(response) {
			//console.log("removeSaveCallback");
			//console.log(response);
			Main.ref.idnetHandler(response, "removeSave");
		}
		var createSaveCallback = function(response) {
			console.log("createSaveCallback");
			console.log(response);
			Main.ref.idnetHandler(response, "createSave");
		}
		var leaderboardSaveCallback = function(response) {
			//console.log("leaderboardSaveCallback");
			//console.log(response);
			Main.ref.idnetHandler(response, "leaderboardSave");
		}
		var leaderboardTablesCallback = function(response) {
			//console.log("leaderboardTablesCallback");
			//console.log(response);
		}
		var awardSaveCallback = function(response) {
			//console.log("awardSaveCallback");
			//console.log(response);
		}
		var isBlacklistedCallback = function(response) {
			//console.log("isBlacklisted");
			//console.log(response);
			Main.ref.idnetHandler(response, "isBlacklisted");
		}
		var isSponsorCallback = function(response) {
			//console.log("isSponsor");
			//console.log(response);
			Main.ref.idnetHandler(response, "isSponsor");
		}
		var preIsSponsorCallback = function(response) {
			//console.log("isSponsor");
			//console.log(response);
			
			ApplicationMain.create();
			Preloader.ref.idnetHandler(response, "isSponsor");
		}
		var leaderboardsListCustomCallback = function(response) {
			//console.log("leaderboardsListCustomCallback");
			//console.log(response);
		}
		
	</script>
	
</body>
</html>