(function(a,I){a.SystemTypeEnum={WebBrowser:0,WindowsPhone:1,Android:2,iOS:3};a.AssetResolutionEnum={ResolutionA:0,ResolutionB:1,ResolutionC:2,ResolutionD:3,ResolutionE:4};a.LayoutOrientationEnum={Landscape:0,Portrait:1};a.DirectionEnum={None:0,Right:1,Left:2,Top:3,Bottom:4};a.ObjectTypeEnum={None:0,Spid:1,Bat:2};a.BlockTypeEnum={None:0,Rock:1,Root:2,Wall:3,Doll:4};a.EffectTypeEnum={None:0,ImpactEffect:1,SparkEffect:2,NumberEffect:3,BirdEffect:4,CoinEffect:5,RumbleEffect:6};a.EntityStateEnum={None:0,
Bouncing:1,Dashing:2,Holding:3,Ready:4};a.ShootStateEnum={Ready:0,Expanding:1,Collapsing:2,Pulling:3};a.EntityOutfitEnum={None:0,HollowGoo:1,SuperGoo:2,SantaGoo:3,SnowGoo:4,OrcGoo:5};a.IntroEntityTypeEnum={Boo:0,Spider:1};a.HoldingTypeEnum={None:0,Top:1,Bottom:2};a.GameStateEnum={GameLogo:1,GamePreLoading:2,GameLoading:3,GameRun:4};a.CommandEnum={None:0,Menu:1,Home:2,Refresh:3,GoBack:4,Play:5,Credits:6,Settings:7,PreviousPage:8,NextPage:9,Close:10,NextLevel:11,ReplayLevel:12,QuitLevel:13,Sound:14,
Music:15}})(window.OkijinGame=window.OkijinGame||{});(function(a,I){a.systemType=a.SystemTypeEnum.WebBrowser;a.preloadSounds=!1;a.devMode=!1;a.isDemo=!0;a.isSoundEnabled=!0;a.shopAvailable=!1;a.resetUserData=!1;a.userData={};a.canShare=!0;a.language=["default","en"];a.soundItems={music1:"assets/sound/music1.mp3",start:"assets/sound/start.mp3",coin:"assets/sound/coin.mp3",scared1:"assets/sound/scared1.mp3",scared2:"assets/sound/scared2.mp3",scared3:"assets/sound/scared3.mp3",end:"assets/sound/end.mp3",intro:"assets/sound/intro.mp3",fall:"assets/sound/fall.mp3",
slash1:"assets/sound/slash1.mp3",slash2:"assets/sound/slash2.mp3",slash3:"assets/sound/slash3.mp3",score1:"assets/sound/score1.mp3",score2:"assets/sound/score2.mp3",click:"assets/sound/click.mp3",playon:"assets/sound/playon.mp3"};a.shopItems=[];a.leaderBoardItems=[];a.initializeSystem=function(){"undefined"!==typeof window.external&&"undefined"!==typeof window.external.notify&&(a.systemType=a.SystemTypeEnum.WindowsPhone);switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:a.preloadSounds=!1;break;
case a.SystemTypeEnum.WebBrowser:a.preloadSounds=!0}};a.loadUserData=function(c){if(c===I)switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:window.external.notify("commandLoadUserData");break;case a.SystemTypeEnum.WebBrowser:window.localStorage?(c=a.resetUserData?'{ "intro": 1, "lang": 0, "ads": 1, "review": 0, "tutorial": 1, "soundEnabled": 1, "musicEnabled": 0, "bestScore": 0, "gold": 50, "outfits":[], "selectedOutfit": 0 }':window.localStorage.getItem("ropeninja_azure_userdata"))&&""!==c||
(c='{ "intro": 1, "lang": 0, "ads": 1, "review": 0, "tutorial": 1, "soundEnabled": 1, "musicEnabled": 0, "bestScore": 0, "gold": 50, "outfits":[], "selectedOutfit": 0 }'):c='{ "intro": 1, "lang": 0, "ads": 1, "review": 0, "tutorial": 1, "soundEnabled": 1, "musicEnabled": 0, "bestScore": 0, "gold": 50, "outfits":[], "selectedOutfit": 0 }',a.loadUserData(c)}else a.userData=JSON.parse(c),a.isSoundEnabled=a.userData.soundEnabled?!0:!1,a.userData.review+=1,a.saveUserData()};a.saveUserData=function(){switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:window.external.notify("commandSaveUserData:"+
JSON.stringify(a.userData));break;case a.SystemTypeEnum.WebBrowser:window.localStorage.setItem("ropeninja_azure_userdata",JSON.stringify(a.userData))}};a.enableSound=function(c){a.isSoundEnabled=c;a.userData.soundEnabled=c?1:0;c?a.playSound("music1"):a.stopSound("music1");a.saveUserData()};a.playSound=function(c){if(!1!==a.isSoundEnabled)switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:window.setTimeout(function(){window.external.notify("commandStopSound:"+c);window.external.notify("commandPlaySound:"+
c)},10);break;case a.SystemTypeEnum.WebBrowser:"music1"===c?AudioManager.loopSound(c):AudioManager.playSound(c)}};a.stopSound=function(c){switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:window.external.notify("commandStopSound:"+c);break;case a.SystemTypeEnum.WebBrowser:AudioManager.stopSound(c)}};a.stopAllSounds=function(){for(var c in a.soundItems)a.soundItems.hasOwnProperty(c)&&a.stopSound(c)};a.getMoreGames=function(){switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:window.external.notify("commandGetMoreGames")}};
a.loadShopItems=function(c){switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:window.external.notify("commandGetProductListing");break;case a.SystemTypeEnum.WebBrowser:a.shopItems=JSON.parse('[{ "id":"11001", "name": "Disable Ads", "price": "$0.99", "description": "Disable all ads" },{ "id":"11002", "name": "10x Hints Pack", "price": "$1.99", "description": "Hints pack 10x" },{ "id":"11001", "name": "Level Pack 1", "price": "$0.99", "description": "Level Pack" },{ "id":"11001", "name": "Level Pack 2", "price": "$0.99", "description": "Level Pack" },{ "id":"11002", "name": "30x Hints Pack", "price": "$2.99", "description": "Hints pack 10x" }]'),
a.shopAvailable=!0}};a.loadLeaderboardItems=function(){a.leaderBoardItems.push({id:"Test1",name:"test product 1",price:"200"})};a.buyShopItem=function(c){switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:window.external.notify("commandBuyShopItem:"+a.shopItems[c].id)}};a.rateGame=function(){switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:window.external.notify("commandRateGame")}};a.launchAdUrl=function(c){switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:window.external.notify("commandLaunchAdUrl:"+
c)}}})(window.OkijinGame=window.OkijinGame||{});var onUserDataLoaded=function(a){window.OkijinGame.loadUserData(a)},onBackButtonPressed=function(){return window.OkijinGame.navigateBack()},onProductListingLoaded=function(a){a=JSON.parse(a);window.OkijinGame.shopItems=a.slice(0);0<window.OkijinGame.shopItems.length&&(window.OkijinGame.shopAvailable=!0)},onCoinsAdded=function(a){JSON.parse(a);window.OkijinGame.userData.ads=0;window.OkijinGame.saveUserData()};(function(a,I){a.Camera=function(){if(!(this instanceof a.Camera))throw Error("Constructor called as a function.");this.reset()};a.Camera.prototype.reset=function(){this.y=this.x=0;this.sy=this.sx=1;this.angle=this.ty=this.tx=0;this.matrix=[1,0,0,1,0,0]};a.Camera.prototype.update=function(){this.matrix=[1,0,0,1,0,0];this.translate(this.x,this.y);this.scale(this.sx,this.sy);this.rotate(this.angle)};a.Camera.prototype.translate=function(a,e){this.matrix[4]+=this.matrix[0]*a+this.matrix[2]*e;this.matrix[5]+=
this.matrix[1]*a+this.matrix[3]*e};a.Camera.prototype.scale=function(a,e){this.matrix[0]*=a;this.matrix[1]*=a;this.matrix[2]*=e;this.matrix[3]*=e};a.Camera.prototype.rotate=function(a){var e=Math.cos(a);a=Math.sin(a);var f=this.matrix[1]*e+this.matrix[3]*a,g=this.matrix[0]*-a+this.matrix[2]*e,l=this.matrix[1]*-a+this.matrix[3]*e;this.matrix[0]=this.matrix[0]*e+this.matrix[2]*a;this.matrix[1]=f;this.matrix[2]=g;this.matrix[3]=l};a.Camera.prototype.screenToCamera=function(a,e){var f=a,g=e,l=1/(this.matrix[0]*
this.matrix[3]-this.matrix[1]*this.matrix[2]);a=f*this.matrix[3]*l+g*-this.matrix[2]*l+l*(this.matrix[2]*this.matrix[5]-this.matrix[3]*this.matrix[4]);e=f*-this.matrix[1]*l+g*this.matrix[0]*l+l*(this.matrix[1]*this.matrix[4]-this.matrix[0]*this.matrix[5]);return{x:a,y:e}};a.Camera.prototype.cameraToScreen=function(a,e){var f=a,g=e;a=f*this.matrix[0]+g*this.matrix[2]+this.matrix[4];e=f*this.matrix[1]+g*this.matrix[3]+this.matrix[5];return{x:a,y:e}};a.Camera.prototype.multiply=function(a){var e=this.matrix[1]*
a.matrix[0]+this.matrix[3]*a.matrix[1],f=this.matrix[0]*a.matrix[2]+this.matrix[2]*a.matrix[3],g=this.matrix[1]*a.matrix[2]+this.matrix[3]*a.matrix[3],l=this.matrix[0]*a.matrix[4]+this.matrix[2]*a.matrix[5]+this.matrix[4],p=this.matrix[1]*a.matrix[4]+this.matrix[3]*a.matrix[5]+this.matrix[5];this.matrix[0]=this.matrix[0]*a.matrix[0]+this.matrix[2]*a.matrix[1];this.matrix[1]=e;this.matrix[2]=f;this.matrix[3]=g;this.matrix[4]=l;this.matrix[5]=p}})(window.OkijinGame=window.OkijinGame||{});(function(a,I){a.Entity=function(){if(!(this instanceof a.Entity))throw Error("Constructor called as a function.");this.vy=this.vx=this.y=this.x=0;this.scaleFactor=1;this.angle=0;this.gravity=9.78;this.rotationFactor=0;this.mass=1;this.paused=!1;this.heartBeats=[]};a.Entity.prototype.update=function(a){var e,f,g;if(!this.paused)for(e=0,f=this.heartBeats.length;e<f;e+=1)g=this.heartBeats[e],0===g.direction&&g.time<=g.maxTime?(g.time=Math.min(g.time+a*g.speed1,g.maxTime),g.time===g.maxTime&&(g.direction=
1)):1===g.direction&&0<=g.time&&(g.time=Math.max(g.time-a*g.speed2,0),0===g.time&&(g.direction=0))};a.PlayerEntity=function(c,e,f){if(!(this instanceof a.PlayerEntity))throw Error("Constructor called as a function.");a.Entity.call(this);this.x=c;this.y=e;this.vy=this.vx=0;this.scaleFactor=.83;this.angle=this.scaleModifierY=0;this.gravity=9.78;this.mass=8;this.radius=this.friction=1;this.speed=0;this.baseSpeed=8.2;this.holding=!1;this.state=this.oldState=a.EntityStateEnum.None;this.changedState=!1;
this.deadTime=0;this.isDead=!1;this.vyFactor=0;this.direction=f;this.bouncingTime=this.holdingTime=0;this.grounded=!0;this.holdingType=a.HoldingTypeEnum.None;this.wasHolding=this.spikeWound=this.spiderBite=!1;this.outfit=a.EntityOutfitEnum.None;this.canRotate=!1;this.rotateAccValue=this.rotateCooldown=0;this.rotationSpeed=1.35;this.isOnBlock=!1;this.canShoot=!0;this.drawShoot=!1;this.pullingTime=0;this.shoot={x:c,y:e,tx:c,ty:e,vx:0,vy:0,speed:130};this.heartBeats=[{time:.9*Math.random(),direction:0,
maxTime:1,speed1:1,speed2:2},{time:.9*Math.random(),direction:0,maxTime:1,speed1:3,speed2:1},{time:.9*Math.random(),direction:0,maxTime:1,speed1:1,speed2:1.7},{time:.9*Math.random(),direction:0,maxTime:1,speed1:1,speed2:4}]};a.PlayerEntity.prototype=Object.create(a.Entity.prototype);a.PlayerEntity.prototype.update=function(c){this.oldState!==this.state&&(this.changedState=!0,this.oldState=this.state);0<this.deadTime&&(this.deadTime-=c,0>=this.deadTime&&(this.deadTime=0,this.isDead=!0));0<this.holdingTime&&
(this.holdingTime-=c,0>this.holdingTime&&(this.holdingTime=0));0<this.bouncingTime&&(this.bouncingTime-=c,0>this.bouncingTime&&(this.bouncingTime=0));0<this.rotateCooldown&&(this.rotateAccValue=0,this.rotateCooldown-=c,0>this.rotateCooldown&&(this.rotateCooldown=0));0>this.vx?this.direction=a.DirectionEnum.Right:0<this.vx&&(this.direction=a.DirectionEnum.Left);if(this.canRotate&&0===this.rotateCooldown&&this.state!==a.EntityStateEnum.Holding){var e=2*this.rotationSpeed*Math.PI*c;this.rotateAccValue+=
e;this.rotateAccValue>2*Math.PI-.2&&(this.rotateCooldown=-1);this.angle-=e}else this.angle=0;0<this.scaleModifierY&&(this.scaleModifierY-=c,0>this.scaleModifierY&&(this.scaleModifierY=0));this.pullingTime||(0<this.vx?(this.vx-=this.friction*c,0>this.vx&&(this.vx=0)):0>this.vx&&(this.vx+=this.friction*c,0<this.vx&&(this.vx=0)),0<this.vy?(this.vy-=this.friction*this.gravity*this.mass*c,0>this.vy&&(this.vy=0)):0>this.vy&&(this.vy+=this.friction*this.gravity*this.mass*c,0<this.vy&&(this.vy=0)),this.y+=
c*this.gravity*this.mass);this.x+=this.vx*c;this.y+=this.vy*c;a.Entity.prototype.update.call(this,c)};a.ObjectEntity=function(c,e,f,g,l){if(!(this instanceof a.ObjectEntity))throw Error("Constructor called as a function.");a.Entity.call(this);this.type=c;this.x=e;this.baseY=this.y=f;this.speed=l;this.direction=g;this.radius=.5;this.scaleFactor=.9;this.destroy=this.isDead=!1;this.deadTime=0;this.caught=!1;this.catchTime=0;this.catcherPos={x:0,y:0};this.trailTime=0;this.heartBeats=[{time:0,direction:0,
maxTime:.5,speed1:2,speed2:3}]};a.ObjectEntity.prototype=Object.create(a.Entity.prototype);a.ObjectEntity.prototype.update=function(c){0<this.deadTime&&(this.deadTime-=c,0>=this.deadTime&&(this.deadTime=0,this.destroy=this.isDead=!0));this.catchTime&&(this.catchTime-=c,0>=this.catchTime&&(this.catchTime=0));this.trailTime&&(this.trailTime-=c,0>=this.trailTime&&(this.trailTime=0));if(this.catchTime){var e=a.distance(this.x,this.y,this.catcherPos.x,this.catcherPos.y);e>this.radius&&(this.x+=(this.catcherPos.x-
this.x)/e*7*c,this.y+=(this.catcherPos.y-this.y)/e*7*c)}else this.x+=this.speed*c*(this.direction===a.DirectionEnum.Left?-1:1);a.Entity.prototype.update.call(this,c)};a.BlockEntity=function(c,e,f,g,l,p){if(!(this instanceof a.BlockEntity))throw Error("Constructor called as a function.");a.Entity.call(this);this.type=c;this.x=e;this.y=f;this.scaleFactor=1.02;this.direction=g;this.deadTime=0;this.isDead=!1;this.bouncingTime=0;this.displayType=.5<Math.random()?0:1;this.hasCoin=!0;this.canRaise=l;this.offsetY=
10;this.hasCoin=p;this.heartBeats=[{time:0,direction:0,maxTime:1,speed1:3,speed2:6},{time:0,direction:0,maxTime:.5,speed1:5,speed2:8},{time:0,direction:0,maxTime:.5,speed1:.5,speed2:.5}]};a.BlockEntity.prototype=Object.create(a.Entity.prototype);a.BlockEntity.prototype.update=function(c){0<this.bouncingTime&&(this.bouncingTime-=c,0>this.bouncingTime&&(this.bouncingTime=0));this.canRaise&&0<this.offsetY&&(this.offsetY-=40*c,0>=this.offsetY&&(this.offsetY=0,this.heartBeats[1].time=0,this.heartBeats[1].direction=
0,this.bouncingTime=.5));a.Entity.prototype.update.call(this,c)};a.HandEntity=function(c,e,f,g,l){if(!(this instanceof a.HandEntity))throw Error("Constructor called as a function.");a.Entity.call(this);this.x=c;this.y=e;this.scaleFactor=f?.95:1.1;this.hold=f;this.offset=g;this.oldDirection=0;this.direction=l;this.heartBeats=[{time:0,direction:0,maxTime:1,speed1:3,speed2:1},{time:0,direction:0,maxTime:1,speed1:3,speed2:5}];this.hold?(this.heartBeats[1].speed1=1,this.heartBeats[1].speed2=1):this.heartBeats[0].speed2=
2};a.HandEntity.prototype=Object.create(a.Entity.prototype);a.HandEntity.prototype.update=function(c){a.Entity.prototype.update.call(this,c);this.offset&&this.oldDirection!==this.heartBeats[0].direction&&(this.oldDirection=this.heartBeats[0].direction,0===this.heartBeats[0].direction&&(this.offset=-this.offset,this.direction=this.direction===a.DirectionEnum.Right?a.DirectionEnum.Left:a.DirectionEnum.Right))};a.IntroEntity=function(c,e,f){if(!(this instanceof a.IntroEntity))throw Error("Constructor called as a function.");
a.Entity.call(this);this.type=f;this.x=c;this.y=e;this.scaleFactor=f===a.IntroEntityTypeEnum.Boo?.45:1.3;this.heartTime=f===a.IntroEntityTypeEnum.Boo?.5:0;this.popAnHeart=!1;this.direction=a.DirectionEnum.Left;this.snatchSound=this.scareSound=!1;this.heartBeats=[{time:0,direction:0,maxTime:1,speed1:1,speed2:2},{time:0,direction:0,maxTime:1,speed1:3,speed2:1},{time:0,direction:0,maxTime:1,speed1:5,speed2:2}]};a.IntroEntity.prototype=Object.create(a.Entity.prototype);a.IntroEntity.prototype.update=
function(c){a.Entity.prototype.update.call(this,c);0<this.heartTime&&(this.heartTime-=c,0>this.heartTime&&(this.heartTime=0,this.popAnHeart=!0))}})(window.OkijinGame=window.OkijinGame||{});(function(a,I){a.Effect=function(c,e,f){if(!(this instanceof a.Effect))throw Error("Constructor called as a function.");this.x=c;this.y=e;this.radius=f;this.vy=this.vx=0;this.mass=this.friction=1;this.direction=a.DirectionEnum.None;this.angle=this.rotationSpeed=0;this.gravity=9.78;this.value=0;this.type=a.EffectTypeEnum.None;this.activationCooldown=0;this.selfDestroyTime=-1;this.startFadeTime=1;this.restoreBaseAngle=!1;this.cooldown=0;this.scaleFactor=1;this.scaleTime=-1;this.scaleSpeed=2;this.target=
null};a.Effect.prototype.update=function(c){0<this.activationCooldown&&(this.activationCooldown-=c,0>this.activationCooldown&&(this.activationCooldown=0));0<this.scaleTime&&(this.scaleTime-=c*this.scaleSpeed,0>this.scaleTime&&(this.scaleTime=0));0<this.cooldown&&(this.cooldown-=c,0>this.cooldown&&(this.cooldown=0));0<this.selfDestroyTime&&(this.selfDestroyTime-=c,0>this.selfDestroyTime&&(this.selfDestroyTime=0));0<this.vx?(this.vx-=this.friction*c,0>this.vx&&(this.vx=0)):0>this.vx&&(this.vx+=this.friction*
c,0<this.vx&&(this.vx=0));!this.restoreBaseAngle||this.restoreBaseAngle&&1<Math.abs(this.rotationSpeed)?0<this.rotationSpeed?(this.rotationSpeed-=this.friction*c,0>this.rotationSpeed&&(this.rotationSpeed=0)):0>this.rotationSpeed&&(this.rotationSpeed+=this.friction*c,0<this.rotationSpeed&&(this.rotationSpeed=0)):this.restoreBaseAngle&&(this.rotationSpeed=0);this.restoreBaseAngle&&0===this.rotationSpeed&&0!==this.angle&&(.1<a.shortestArc(this.angle,0)?this.angle=0<this.angle?this.angle+2*Math.PI*c:
this.angle-2*Math.PI*c:this.angle=0);this.angle=this.rotationSpeed?(this.angle+2*this.rotationSpeed*Math.PI*c)%(2*Math.PI):this.angle;this.vy+=this.gravity*c*this.mass;this.y+=this.vy*c;this.x+=this.vx*c};a.RumbleEffect=function(c,e,f,g){if(!(this instanceof a.RumbleEffect))throw Error("Constructor called as a function.");a.Effect.call(this,c,e,f);this.gravity=9.78;this.friction=0;this.mass=.3;this.selfDestroyTime=1.5;this.startFadeTime=1.7;this.type=a.EffectTypeEnum.RumbleEffect;this.angle=this.value=
0;this.rotationSpeed=.3*Math.PI;this.vx=g===a.DirectionEnum.Right?2*Math.random()+1:-(2*Math.random()+1);c=Math.random();this.vy=.5<c?1*(c+1):-1*(c+1);this.scaleFactor=.44+.2*Math.random();this.scaleTime=-1;this.scaleSpeed=2;this.displayType=.5<Math.random()?0:1};a.RumbleEffect.prototype=Object.create(a.Effect.prototype);a.SparkEffect=function(c,e,f){if(!(this instanceof a.SparkEffect))throw Error("Constructor called as a function.");a.Effect.call(this,c,e,f);this.gravity=9.78;this.friction=0;this.mass=
.37;this.selfDestroyTime=3;this.startFadeTime=.5;this.type=a.EffectTypeEnum.SparkEffect;this.angle=this.value=0;this.rotationSpeed=.2*Math.PI;c=2*Math.random();this.vx=1.5<c?1*(c+1):-1*(c+1);Math.random();this.vy=-(3+3*Math.random());this.scaleFactor=.5+Math.random();this.scaleTime=.5;this.scaleSpeed=2;this.displayType=0};a.SparkEffect.prototype=Object.create(a.Effect.prototype);a.ImpactEffect=function(c,e,f){if(!(this instanceof a.ImpactEffect))throw Error("Constructor called as a function.");a.Effect.call(this,
c,e,f);this.gravity=0;this.friction=2;this.mass=.5;this.selfDestroyTime=1;this.startFadeTime=.5;this.type=a.EffectTypeEnum.ImpactEffect;this.value=0;this.angle=2*Math.random();this.rotationSpeed=.2*Math.PI;this.vy=this.vx=0;this.scaleFactor=1.2;this.scaleTime=.6;this.scaleSpeed=2};a.ImpactEffect.prototype=Object.create(a.Effect.prototype);a.NumberEffect=function(c,e,f,g,l){if(!(this instanceof a.NumberEffect))throw Error("Constructor called as a function.");a.Effect.call(this,c,e,.5);this.gravity=
5;this.friction=2;this.mass=.5;this.selfDestroyTime=2;this.startFadeTime=1;this.type=a.EffectTypeEnum.NumberEffect;this.angle=this.value=0;this.rotationSpeed=.5<Math.random()?-.1*Math.PI:.1*Math.PI;this.vx=0;this.vy=-2;this.number=f;this.color=g;this.hasX=l;this.scaleTime=1.2;this.scaleSpeed=1};a.NumberEffect.prototype=Object.create(a.Effect.prototype);a.BirdEffect=function(c,e,f){if(!(this instanceof a.BirdEffect))throw Error("Constructor called as a function.");a.Effect.call(this,c,e,.5);this.gravity=
0;this.mass=this.friction=.5;this.selfDestroyTime=3;this.startFadeTime=2;this.type=a.EffectTypeEnum.BirdEffect;this.rotationSpeed=this.angle=this.value=0;this.vx=-4;this.vy=-(7+3*Math.random());this.scaleTime=.5;this.scaleSpeed=1;this.scaleFactor=.7;this.displayType=f};a.BirdEffect.prototype=Object.create(a.Effect.prototype);a.CoinEffect=function(c,e,f,g,l){if(!(this instanceof a.CoinEffect))throw Error("Constructor called as a function.");a.Effect.call(this,c,e,f);this.gravity=9.78;this.friction=
0;this.mass=1;this.selfDestroyTime=20;this.startFadeTime=.5;this.type=a.EffectTypeEnum.CoinEffect;this.angle=this.value=0;this.rotationSpeed=.3*Math.PI;this.activationCooldown=1;this.target=l;this.vx=g===a.DirectionEnum.Right?3:-3;this.vy=-7;this.scaleFactor=1;this.scaleTime=-1;this.scaleSpeed=2;this.displayType=.5<Math.random()?0:1};a.CoinEffect.prototype=Object.create(a.Effect.prototype)})(window.OkijinGame=window.OkijinGame||{});(function(a,I){a.streamBuffer=[];a.levels=[{}];a.levelSections00=[{items:[{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root}]},{items:[{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},
{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root},{t1:a.BlockTypeEnum.Root}]}];a.fillStreamBuffer=function(c,e){var f;a.streamBuffer=[];for(f=0;f<c;f+=1)a.streamBuffer.push({blockType:a.BlockTypeEnum.Root})}})(window.OkijinGame=window.OkijinGame||{});(function(a,I){function c(c,f,g){var l=a.distance(c.x,c.y,f.x,f.y);if(1<l)return c.vx=(f.x-c.x)/l*c.speed,c.vy=(f.y-c.y)/l*c.speed,c.x+=c.vx*g,c.y+=c.vy*g,l<a.distance(c.x,c.y,f.x,f.y)?(c.x=f.x,c.y=f.y,!0):!1;c.x=f.x;c.y=f.y;return!0}a.SceneManager=function(){if(!(this instanceof a.SceneManager))throw Error("Constructor called as a function.");this.minX=1;this.minY=-10;this.maxX=this.minX+23;this.maxY=this.minY+17;this.width=this.maxX-this.minX;this.height=this.maxY-this.minY;this.size={x:0,y:0};
this.best=this.score=this.bonus=0;this.newBest=!1;this.floorStreamSize=11;this.blockSize=1.4;this.zoomCamera=this.slowCamera=this.shakeCamera=!1;this.floorStream=[];this.effects=[];this.playerEntity={};this.objects=[];this.holdingTime=this.objectsTime=0;this.neverHold=!1;this.targetObject=null;this.theme=0;this.first=!0;this.drawScoreTime=this.drawScore=this.scoreTime=0;this.homeScreen=!0;this.homeScreenTime=0;this.loaderTime=1;this.blockSpacing=this.maxBlockSpacing=6;this.menu=!1;this.menuTime=0;
this.credits=!1;this.creditsTime=0;this.showResults=!1;this.showResultsTime=0;this.tutorial=!1;this.activeEntityId=this.entityChangeTime=this.tutorialTime=this.tutorialHoldTime=this.tutorialEndTime=this.tutorialStep=0;this.entities=[];this.firstTap=!0;this.playOn=1;this.catchCount=0;this.endSession=!1};a.SceneManager.prototype.loadLevel=function(){this.first?this.first=!1:this.theme=1===this.theme?0:1;a.saveUserData();this.maxX=this.minX+35;this.maxY=this.minY+19.6875;this.width=this.maxX-this.minX;
this.height=this.maxY-this.minY;this.score=this.bonus=0;this.best=a.userData.bestScore;this.zoomCamera=this.slowCamera=this.shakeCamera=this.newBest=!1;this.effects=[];this.floorStream=[];this.objects=[];this.holdingTime=this.objectsTime=0;this.neverHold=!1;this.lastBlock=null;this.menu=!1;this.menuTime=0;this.credits=!1;this.creditsTime=0;this.showResults=!1;this.showResultsTime=0;this.firstTap=!0;this.goldMsgTime=0;var c=this.minX;this.floorStream.push({block:new a.BlockEntity(a.BlockTypeEnum.Root,
c,this.maxY-4.5*this.blockSize,a.DirectionEnum.Right,!0)});c+=4.5*this.blockSize;this.floorStream.push({block:new a.BlockEntity(a.BlockTypeEnum.Root,c,this.maxY-4*this.blockSize,a.DirectionEnum.Right,!0)});this.floorStream[1].block.offsetY=0;c+=6*this.blockSize;this.floorStream.push({block:new a.BlockEntity(a.BlockTypeEnum.Root,c,this.maxY-2*this.blockSize,a.DirectionEnum.Right,!0)});c+=6*this.blockSize;this.floorStream.push({block:new a.BlockEntity(a.BlockTypeEnum.Root,c,this.maxY-3*this.blockSize,
a.DirectionEnum.Right,!0,!0)});c+=8.6*this.blockSize;this.floorStream.push({block:new a.BlockEntity(a.BlockTypeEnum.Root,c,this.maxY-5*this.blockSize,a.DirectionEnum.Right,!0)});this.activeEntityId=0;this.entities=[new a.PlayerEntity(this.floorStream[1].block.x-.2,this.minY-7,a.DirectionEnum.Right),new a.PlayerEntity(this.floorStream[0].block.x-.4,this.floorStream[0].block.y-50,a.DirectionEnum.Right)];this.lastBlock=this.floorStream[1].block;this.floorStream[0].block.canRaise=!0;this.floorStream[0].block.offsetY=
0;this.playerEntity=this.entities[this.activeEntityId];this.targetObject=null;this.tutorial=!1;this.tutorialHoldTime=this.tutorialEndTime=this.tutorialStep=0;this.tutorialTime=2.8;this.playOn=1;this.catchCount=0;this.endSession=!1};a.SceneManager.prototype.update=function(e,f){var g,l;this.homeScreen&&(this.homeScreenTime&&(this.loaderTime=0,this.homeScreenTime-=2*e,0>=this.homeScreenTime&&(this.homeScreen=this.homeScreenTime=0)),this.loaderTime&&(this.loaderTime-=e,0>this.loaderTime&&(this.loaderTime=
0)));this.menuTime&&(this.menuTime-=e,0>this.menuTime&&(this.menuTime=0));this.creditsTime&&(this.creditsTime-=e,0>this.creditsTime&&(this.creditsTime=0));this.goldMsgTime&&(this.goldMsgTime-=e,0>this.goldMsgTime&&(this.goldMsgTime=0));this.showResultsTime&&(this.showResultsTime-=e,0>this.showResultsTime&&(this.showResultsTime=0));this.tutorialEndTime&&(this.tutorialEndTime-=e,0>=this.tutorialEndTime&&(this.activeEntityId=this.tutorialEndTime=0,this.playerEntity=this.entities[this.activeEntityId],
this.tutorial=!1,this.lastBlock=this.floorStream[1].block,this.entityChangeTime=1,a.playSound("slash2")));this.tutorialHoldTime&&(f=!0,this.tutorialHoldTime-=e,0>=this.tutorialHoldTime&&(this.tutorialHoldTime=0,f=!1));!this.homeScreen&&this.tutorialTime&&(this.tutorialTime-=e,0>=this.tutorialTime&&(this.tutorialTime=0));this.entityChangeTime&&(this.entityChangeTime-=e,0>this.entityChangeTime&&(this.entityChangeTime=0));if(this.homeScreen&&this.homeScreenTime||!this.homeScreen){this.objectsTime&&(this.objectsTime-=
e,0>=this.objectsTime&&(this.objectsTime=0));this.scoreTime&&(this.scoreTime-=e,0>this.scoreTime&&(this.scoreTime=0));0<this.drawScoreTime&&(this.drawScoreTime-=e,0>this.drawScoreTime&&(this.drawScoreTime=0));0===this.drawScoreTime&&this.drawScore!==this.score&&(this.drawScoreTime=.05,this.drawScore+=1+Math.ceil(.02*this.score),this.drawScore>=this.score&&(this.drawScore=this.score));this.tutorial||0!==this.objectsTime||this.playerEntity.state!==a.EntityStateEnum.Holding?this.tutorial&&1===this.tutorialStep&&
0===this.objectsTime?(this.objectsTime=this.tutorialStep=2,l=new a.ObjectEntity(0,this.playerEntity.x+24,this.minY+this.blockSize,a.DirectionEnum.Left,9),this.objects.push(l)):this.tutorial&&3===this.tutorialStep&&0===this.objectsTime&&(this.tutorialStep=4,this.objectsTime=2,l=new a.ObjectEntity(0,this.playerEntity.x+30,this.minY+this.blockSize,a.DirectionEnum.Left,11),this.objects.push(l),l=new a.ObjectEntity(0,this.playerEntity.x+45,this.minY+this.blockSize,a.DirectionEnum.Left,11),this.objects.push(l)):
3>this.objects.length&&(this.objectsTime=1+Math.random(),l=new a.ObjectEntity(0,this.playerEntity.x+34,this.minY+this.blockSize*Math.random()*2,a.DirectionEnum.Left,6+5*Math.random()),this.objects.push(l),l=new a.ObjectEntity(0,this.playerEntity.x+50,this.minY+this.blockSize*Math.random()*2,a.DirectionEnum.Left,6+5*Math.random()),this.objects.push(l),.07>Math.random()&&(l=new a.ObjectEntity(0,this.playerEntity.x+70,this.minY+this.blockSize*Math.random()*2,a.DirectionEnum.Left,6+5*Math.random()),this.objects.push(l)));
this.targetObject?(this.playerEntity.shoot.tx=this.targetObject.x,this.playerEntity.shoot.ty=this.targetObject.y):(this.playerEntity.shoot.tx=this.playerEntity.x,this.playerEntity.shoot.ty=this.playerEntity.y);for(g=0;g<this.effects.length;g+=1)this.effects[g].update(e);this.floorStream[0].block.x<this.playerEntity.x-2*this.width&&this.floorStream.splice(0,1);l=.7<Math.random()?1.7:1;for(g=this.floorStream[this.floorStream.length-1].block.x+this.blockSize*l*(this.blockSpacing+Math.random()*this.blockSpacing);this.floorStream.length<
this.floorStreamSize;)this.floorStream.push({block:new a.BlockEntity(a.BlockTypeEnum.Root,g,this.maxY-this.blockSize*(2+4*Math.random()),a.DirectionEnum.Right,!0,.7<Math.random()?!0:!1)}),l=.7<Math.random()?1.7:1,g+=this.blockSize*l*(this.blockSpacing+Math.random()*this.blockSpacing);this.tutorial&&(this.playerEntity=this.entities[this.activeEntityId],g=this.entities[1===this.activeEntityId?0:1],l=g.y,g.update(e),g.y=l,g.state=a.EntityStateEnum.Holding);g=this.playerEntity.y;this.playerEntity.update(e);
!this.showResults&&g>this.maxY+25&&(this.showResults=this.neverHold=!0,this.showResultsTime=.3,this.menu=!1,this.menuTime=0,this.credits=!1,this.drawScore=this.creditsTime=0,this.scoreTime=.5,this.endSession=!0,a.playSound("fall"),setTimeout(function(){a.playSound("end")},500),a.userData.bestScore<this.score&&(this.best=a.userData.bestScore=this.score,this.newBest=!0),a.saveUserData());var p=l=!1,C=!1,r=this.maxY-this.playerEntity.scaleFactor+50,u=-1;for(g=0;g<this.floorStream.length;g+=1){var q=
this.floorStream[g].block;q.update(e);if(q.type===a.BlockTypeEnum.Root){var z=this.playerEntity.radius*this.playerEntity.scaleFactor*1.4;if(0===q.offsetY&&q.x-1.2*this.blockSize<this.playerEntity.x+z&&q.x+1.2*this.blockSize>this.playerEntity.x-z){if(this.playerEntity.y<=q.y+.5||this.playerEntity.isOnBlock)l=!0,r=q.y,this.playerEntity.x-q.x>1.3*z&&(p=!0),q.x-this.playerEntity.x>1.3*z&&(C=!0),u=g;0===this.activeEntityId&&q!==this.lastBlock&&(this.lastBlock=q,this.bonus=0===this.bonus?1:1===this.bonus?
4:2*this.bonus)}}}this.playerEntity.isOnBlock=l;this.playerEntity.y>=r&&(this.playerEntity.y=r,this.playerEntity.bouncingTime=0,-1!==u?this.playerEntity.state!==a.EntityStateEnum.Holding?(q=this.floorStream[u].block,q.heartBeats[1].time=0,q.heartBeats[1].direction=0,q.bouncingTime=.5,1===this.bonus?a.playSound("score2"):1<this.bonus?a.playSound("score1"):1===this.activeEntityId&&a.playSound("score2"),0===this.activeEntityId?(this.lastBlock=q,this.score+=1*this.bonus,this.bonus&&(this.effects.push(new a.NumberEffect(this.playerEntity.x,
this.playerEntity.y-3,this.bonus,2,!0)),this.bonus=0,this.scoreTime=.5),q.hasCoin&&(q.hasCoin=!1,this.effects.push(new a.CoinEffect(this.playerEntity.x,this.playerEntity.y-this.playerEntity.radius,.5,a.DirectionEnum.Right,this.playerEntity)))):2===this.tutorialStep&&(this.tutorialStep=3,this.tutorialEndTime=6)):this.playerEntity.block=this.floorStream[u].block:this.playerEntity.block=null,C?(this.playerEntity.angle=0,this.playerEntity.canRotate=!0,this.playerEntity.rotateCooldown=0,this.playerEntity.rotateAccValue=
0,this.playerEntity.state=a.EntityStateEnum.Bouncing,this.playerEntity.bouncingTime=.4,this.playerEntity.vx=9,this.playerEntity.vy=-1.1*this.playerEntity.mass*this.playerEntity.gravity):p?(this.playerEntity.angle=0,this.playerEntity.canRotate=!0,this.playerEntity.rotateCooldown=0,this.playerEntity.rotateAccValue=0,this.playerEntity.state=a.EntityStateEnum.Bouncing,this.playerEntity.bouncingTime=.4,this.playerEntity.vx=-9,this.playerEntity.vy=-1.1*this.playerEntity.mass*this.playerEntity.gravity):
(this.playerEntity.angle=0,this.playerEntity.vx=0,this.playerEntity.state=a.EntityStateEnum.Holding,this.playerEntity.direction=a.DirectionEnum.Right));if(!f||this.neverHold)this.playerEntity.canShoot=!1,this.playerEntity.pullingTime&&(this.targetObject&&(this.targetObject.deadTime=Math.min(this.targetObject.deadTime,.1)),this.playerEntity.canRotate=!this.playerEntity.canRotate,this.playerEntity.rotateCooldown=0,this.playerEntity.rotateAccValue=0,this.playerEntity.state=a.EntityStateEnum.Bouncing,
this.playerEntity.bouncingTime=.4,this.playerEntity.heartBeats[2].direction=0,this.playerEntity.heartBeats[2].time=0,g=Math.min(.6,this.playerEntity.pullingTime),this.playerEntity.vy=-(1.1+.3*g)*this.playerEntity.mass*this.playerEntity.gravity,0>this.playerEntity.vx&&(this.playerEntity.vx=Math.max(this.playerEntity.vx,-9)),0<this.playerEntity.vx&&(this.playerEntity.vx=Math.min(this.playerEntity.vx,9)),this.playerEntity.pullingTime=0);if(this.playerEntity.canShoot){if(g={x:this.playerEntity.shoot.tx,
y:this.playerEntity.shoot.ty},c(this.playerEntity.shoot,g,e)){if(this.targetObject&&!this.targetObject.deadTime)if(this.targetObject.deadTime=.7,this.targetObject.catchTime=.4,this.targetObject.caught=!0,this.targetObject.catcherPos={x:this.playerEntity.x,y:this.playerEntity.y},0===this.catchCount)this.catchCount+=1,a.playSound("scared3");else if(1===this.catchCount)this.catchCount+=1,a.playSound("scared2");else if(2===this.catchCount)this.catchCount+=1,a.playSound("scared3");else switch(Math.floor(2.99*
Math.random())){case 0:a.playSound("scared1");break;case 1:a.playSound("scared2");break;case 2:a.playSound("scared3")}l=a.distance(this.playerEntity.x,this.playerEntity.y,this.playerEntity.shoot.x,this.playerEntity.shoot.y);1.5<l&&this.targetObject&&!this.targetObject.isDead?(this.playerEntity.pullingTime+=e,this.playerEntity.vx=(this.playerEntity.shoot.x-this.playerEntity.x)/l*40,this.playerEntity.vy=(this.playerEntity.shoot.y-this.playerEntity.y)/l*40,this.playerEntity.state=a.EntityStateEnum.Bouncing):
this.targetObject&&(this.targetObject.deadTime=Math.min(this.targetObject.deadTime,.2),this.playerEntity.canRotate=!this.playerEntity.canRotate,this.playerEntity.rotateCooldown=0,this.playerEntity.rotateAccValue=0,this.playerEntity.state=a.EntityStateEnum.Bouncing,this.playerEntity.bouncingTime=.4,this.playerEntity.heartBeats[2].direction=0,this.playerEntity.heartBeats[2].time=0,this.neverHold=!0,this.tutorialHoldTime=0,g=Math.min(.6,this.playerEntity.pullingTime),this.playerEntity.vy=-(1.1+.3*g)*
this.playerEntity.mass*this.playerEntity.gravity,0>this.playerEntity.vx&&(this.playerEntity.vx=Math.max(this.playerEntity.vx,-9)),0<this.playerEntity.vx&&(this.playerEntity.vx=Math.min(this.playerEntity.vx,9)),this.playerEntity.pullingTime=0)}}else g={x:this.playerEntity.x,y:this.playerEntity.y},l=a.distance(this.playerEntity.shoot.x,this.playerEntity.shoot.y,this.playerEntity.x,this.playerEntity.y),c(this.playerEntity.shoot,g,e)&&(this.playerEntity.canShoot=!0);this.playerEntity.drawShoot=(!this.playerEntity.canShoot||
f&&this.targetObject)&&!this.neverHold;this.playerEntity.state===a.EntityStateEnum.Bouncing&&(this.playerEntity.state=a.EntityStateEnum.Ready);for(g=0;g<this.objects.length;){l=this.objects[g];if(l!==this.targetObject&&l.x<this.playerEntity.x-10||l.isDead)l.destroy=!0;l.destroy?(this.effects.push(new a.BirdEffect(l.x,l.y,0)),this.objects.splice(g,1)):(l.update(e),l.deadTime&&!l.trailTime&&(l.trailTime=.2,this.effects.push(new a.SparkEffect(l.x-1,l.y-1,.5))),g+=1)}}}})(window.OkijinGame=window.OkijinGame||
{});(function(a,I){})(window.OkijinGame.Resources=window.OkijinGame.Resources||{});(function(a,I){var c={},e=!0,f=!1,g=navigator.userAgent.toLowerCase();if(-1<g.indexOf("firefox")||-1<g.indexOf("opera"))f=!0;g=!1;if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))g=!0;var l,p=window.AudioContext||window.webkitAudioContext;!f&&p?l=new p:"undefined"===typeof Audio?
e=!1:!f&&g&&(e=!1);a.canPlaySounds=function(){return e};a.registerSound=function(a,g,p){if(e)if(l){var q=new XMLHttpRequest;q.open("get",g,!0);q.responseType="arraybuffer";q.onload=function(){l.decodeAudioData(q.response,function(g){c[a]={buffer:g};p&&p()})};q.send()}else c[a]=new Audio,p&&(c[a].preload="auto",$(c[a]).on("loadeddata",p)),c[a].src=f?g.replace(".mp3",".ogg"):g;else p&&p()};a.playSound=function(g){try{var f;e&&(f=c[g])&&(l?(a.stopSound(g),f.sourceNode=l.createBufferSource(),f.sourceNode.buffer=
f.buffer,f.sourceNode.connect(l.destination),"undefined"!==typeof f.sourceNode.noteOn?f.sourceNode.noteOn(0):f.sourceNode.start(0)):(f.currentTime=0,f.play()))}catch(p){}};a.loopSound=function(g){var f;e&&(f=c[g])&&(l?(a.stopSound(g),f.sourceNode=l.createBufferSource(),f.sourceNode.loop=!0,f.sourceNode.buffer=f.buffer,f.sourceNode.connect(l.destination),"undefined"!==typeof f.sourceNode.noteOn?f.sourceNode.noteOn(0):f.sourceNode.start(0)):("boolean"===typeof f.loop?f.loop=!0:f.addEventListener("ended",
function(){this.currentTime=0;this.play()},!1),f.play()))};a.stopSound=function(a){e&&(a=c[a])&&(l?a.sourceNode&&("undefined"!==typeof a.sourceNode.noteOff?a.sourceNode.noteOff(0):a.sourceNode.stop(0),a.sourceNode=null):(a.pause(),a.currentTime=0))}})(window.AudioManager=window.AudioManager||{});
(function(a,I){var c=new Date,e=0,f=0;a.getFPS=function(){++e;var a=new Date;1E3<a.getTime()-c.getTime()&&(f=e,e=0,c=a);return f};a.clamp=function(a,c,e){return Math.max(c,Math.min(e,a))};a.circleRectIntersect=function(c,l,e,f,r,u,q){c-=a.clamp(c,f,u);l-=a.clamp(l,r,q);return c*c+l*l<e*e};a.distance=function(a,c,e,f){a=e-a;c=f-c;return Math.sqrt(a*a+c*c)};a.vectorAdd=function(a,c,e,f){return{x:a+e,y:c+f}};a.vectorSubstract=function(a,c,e,f){return{x:a-e,y:c-f}};a.vectorMultiply=function(a,c,e){return{x:a*
e,y:c*e}};a.vectorDivide=function(a,c,e){return 0===e?{x:a,y:c}:{x:a/e,y:c/e}};a.vectorDotProduct=function(a,c,e,f){return a*e+c*f};a.vectorLength=function(a,c){return Math.sqrt(a*a+c*c)};a.vectorNormalize=function(c,e){var f=a.vectorLength(c,e);return 0===f?{x:c,y:e}:{x:c/f,y:e/f}};a.vectorRotate=function(a,c,e){var f=Math.cos(e);e=Math.sin(e);return{x:f*a-e*c,y:e*a+f*c}};a.vectorAngle=function(a,c,e,f){return Math.atan2(f-c,e-a)};a.vectorFromAngle=function(a){return{x:Math.cos(a),y:Math.sin(a)}};
a.toDegrees=function(a){return 180/Math.PI*a};a.toRadians=function(a){return Math.PI/180*a};a.shortestArc=function(a,c){var e=Math.abs(a-c);e>Math.PI&&(e=2*Math.PI-e);return e};a.rectIntersect=function(a,c,e,f,r,u,q,z){return!(f<u||c>z||e<r||a>q)};a.pointInRect=function(a,c,e,f,r,u){return a>e&&a<r&&c>f&&c<u};a.circleLineIntersect=function(a,c,e,f,r,u,q){e-=a;f-=c;var z=2*(e*(a-r)+f*(c-u)),d;d=r*r+u*u+(a*a+c*c);d-=2*(r*a+u*c);d-=q*q;return 0>z*z-4*(e*e+f*f)*d?!1:!0};a.lineLineIntersect=function(a,
c,e,f,r,u,q,z){var d={intersect:!1,x:0,y:0},b=(z-u)*(e-a)-(q-r)*(f-c);0!==b?(q=((q-r)*(c-u)-(z-u)*(a-r))/b,r=((e-a)*(c-u)-(f-c)*(a-r))/b,0<=q&&1>=q&&0<=r&&1>=r?(d.intersect=!0,d.x=a+q*(e-a),d.y=c+q*(f-c)):d.intersect=!1):d.intersect=!1;return d};a.loadResources=function(a,c,e){var f,r,u={},q=0,z,d=function(){++q===r&&c&&c(u);e&&e(q,r)};f=0;for(r=a.length;f<r;f+=1)z=a[f],"img"===z.type?(u[z.id]=new Image,u[z.id].onload=d,u[z.id].src=z.src):"snd"===z.type&&AudioManager.registerSound(z.id,z.src,d)}})(window.OkijinGame=
window.OkijinGame||{});(function(a,I){var c,e,f,g,l,p,C,r,u,q,z;a.setupTileOffsets=function(){var d=1/a.getScaleUnit();c=0;e=1*d;f=2*d;g=3*d;l=4*d;p=5*d;C=6*d;r=7*d;u=8*d;q=9*d;z=10*d};a.draw=function(d,b){var e;e=a.getCurrentGameState();if(e===a.GameStateEnum.GameLogo||e===a.GameStateEnum.GameLoading)a.drawLoader(d);else if(e===a.GameStateEnum.GameRun){switch(b.theme){case 0:d.drawImage(a.Resources.background01Image,c,p,p,p,0,0,a.getCanvasWidth(),a.getCanvasHeight());break;case 1:d.drawImage(a.Resources.background01Image,
p,c,p,p,0,0,a.getCanvasWidth(),a.getCanvasHeight())}d.save();a.applySceneCameras();a.applyHereParallaxCameras();a.drawLevelPlay(d,b);for(e=0;e<b.effects.length;e+=1)a.drawEffect(d,b.effects[e],b);a.applyHudCameras();a.drawHud(d,b);d.restore()}};a.drawLoader=function(d){var b=a.getLogoTime();a.getLayoutOrientation();var k=a.screenToHud({x:a.getCanvasWidth(),y:a.getCanvasHeight()}),n=a.getGameLoadingData();d.drawImage(a.Resources.loadingScreenImage,c,c,z,6.5*e,0,0,a.getCanvasWidth(),a.getCanvasHeight());
d.save();a.applyHudCameras();n=3*n.current/n.total+(3-b)/3;d.drawImage(a.Resources.loadingScreenImage,p,r,l,e,k.x/2-2,k.y/2,4,1);d.save();d.beginPath();d.rect(k.x/2-2,k.y/2,n,1);d.closePath();d.clip();d.drawImage(a.Resources.loadingScreenImage,p,u,l,e,k.x/2-2,k.y/2,4,1);d.restore();d.drawImage(a.Resources.loadingScreenImage,p,q,l,e,k.x/2-2,k.y-1,4,1);d.drawImage(a.Resources.loadingScreenImage,g,r,f,f,k.x/2-1+.5,k.y/2-1-.5-.3*(3-b),2,2);d.drawImage(a.Resources.loadingScreenImage,c,r,g,f,k.x/2-1.5,
k.y/2-1-.5,3,2);d.restore()};a.drawLevelPlay=function(d,b){var k;switch(b.theme){case 0:d.drawImage(a.Resources.backdrop02Image,c,l,p,p,a.getCameraTranslationX()-20,b.maxY-25,30,30);break;case 1:d.drawImage(a.Resources.background01Image,p,p,p,p,a.getCameraTranslationX()-20,b.maxY-25,30,30)}k=a.getCameraTranslationX();var n=28,m=.9*(k-b.minX),m=m+Math.round((k-m)/n)*n-2*n;for(k=0;4>k;k+=1)d.drawImage(a.Resources.backdrop01Image,c,q,r,e,m-5,b.maxY-7,1.2*n,9),m+=n;k=a.getCameraTranslationX();n=36;m=
.7*(k-b.minX);m=m+Math.round((k-m)/n)*n-2*n;for(k=0;4>k;k+=1){switch(b.theme){case 0:d.drawImage(a.Resources.backdrop02Image,c,c,q,l,m,b.maxY-14.2,n,16);break;case 1:d.drawImage(a.Resources.backdrop01Image,c,g,q,l,m,b.maxY-14.2,n,16)}m+=n}k=a.getCameraTranslationX();n=36;m=.6*(k-b.minX);m=m+Math.round((k-m)/n)*n-2*n;for(k=0;4>k;k+=1)d.globalAlpha=.5,d.drawImage(a.Resources.backdrop01Image,c,r,r,e,m-7,b.maxY-1,1.2*n,4.5),d.drawImage(a.Resources.backdrop01Image,c,r,r,e,m-7,b.maxY+3,1.2*n,4.5),d.globalAlpha=
1,m+=n;k=a.getCameraTranslationX();n=28;m=.4*(k-b.minX);m=m+Math.round((k-m)/n)*n-2*n;for(k=0;4>k;k+=1)d.drawImage(a.Resources.backdrop01Image,c,r,r,e,m-1,b.maxY-.2,1.2*n,4.5),m+=n;for(k=0;k<b.floorStream.length;k+=1)b.floorStream[k].block.isDead||a.drawBlock(d,b.floorStream[k].block,b);k=a.screenToScene({x:0,y:0});n=a.screenToScene({x:a.getCanvasWidth(),y:a.getCanvasHeight()});b.showResults||b.tutorial||a.drawNumber(d,Math.floor(b.drawScore).toString(),k.x+.5*(n.x-k.x),b.minY,3+2*b.scoreTime,2,!1);
a.drawPlayer(d,b.playerEntity,b,1===b.activeEntityId);if(b.tutorial||b.entityChangeTime)d.globalAlpha=0<b.entityChangeTime?b.entityChangeTime:1,a.drawPlayer(d,b.entities[1===b.activeEntityId?0:1],b,0===b.activeEntityId),d.globalAlpha=1;for(k=0;k<b.objects.length;k+=1)b.objects[k].isDead||a.drawObject(d,b.objects[k],b);!b.tutorial&&b.firstTap&&d.drawImage(a.Resources.hud05Image,c,l,p,f,b.playerEntity.x-5,b.playerEntity.y-8+.3*a.getTitleHeartbeat4().time,10,4);b.tutorial&&2===b.tutorialStep&&b.playerEntity.state===
a.EntityStateEnum.Holding?(d.drawImage(a.Resources.hud05Image,c,c,p,l,b.playerEntity.x-5.6,b.playerEntity.y-7.3,7,5.6),d.drawImage(a.Resources.hud05Image,p,c,p,e,b.playerEntity.x-5.6,b.playerEntity.y-7.3+1.4,7,1.4)):b.tutorial&&4===b.tutorialStep&&b.playerEntity.state===a.EntityStateEnum.Holding&&4<b.tutorialEndTime?(d.drawImage(a.Resources.hud05Image,c,c,p,l,b.playerEntity.x-5.6,b.playerEntity.y-7.3,7,5.6),d.drawImage(a.Resources.hud05Image,p,e,p,f,b.playerEntity.x-5.6,b.playerEntity.y-7.3+1.1,7,
2.8)):b.tutorial&&4===b.tutorialStep&&b.playerEntity.state===a.EntityStateEnum.Holding&&2.5>b.tutorialEndTime&&(d.drawImage(a.Resources.hud05Image,c,c,p,l,b.playerEntity.x-5.6,b.playerEntity.y-7.3,7,5.6),d.drawImage(a.Resources.hud05Image,p,g,p,f,b.playerEntity.x-5.6,b.playerEntity.y-7.3+1.1,7,2.8));k=a.getTitleHeartbeat1();var m=a.getTitleHeartbeat2(),x=n.x-19,t=b.minY+.6*b.height;d.save();d.globalAlpha=.8;d.translate(x+20,t);d.rotate(.05*-k.time);d.translate(-(x+20),t);d.drawImage(a.Resources.backdrop01Image,
g,c,r,f,x,t,20,6);d.restore();d.save();x=n.x-14;t=b.minY+.8*b.height;d.translate(x+15,t);d.rotate(.05*m.time);d.translate(-(x+15),-t);d.drawImage(a.Resources.backdrop01Image,g,c,r,f,x,t,15,4);d.restore();d.save();n=a.screenToScene({x:0,y:a.getCanvasHeight()});x=n.x-3;t=b.minY+b.height;d.translate(x-2,t);d.rotate(.05*m.time);d.translate(-(x-2),-t);d.drawImage(a.Resources.backdrop01Image,g,f,r,e,x,t,21,3);d.restore()};a.drawHud=function(d,b){var k=a.screenToHud({x:a.getCanvasWidth(),y:a.getCanvasHeight()});
if(b.homeScreen){d.save();b.homeScreenTime?(d.drawImage(a.Resources.background01Image,c,c,p,.5*p,0,(1-b.homeScreenTime)*-k.y,k.x,.5*k.y),d.drawImage(a.Resources.background01Image,c,.5*p,p,.5*p,0,.5*k.y+(1-b.homeScreenTime)*k.y,k.x,.5*k.y)):d.drawImage(a.Resources.background01Image,c,c,p,p,0,0,k.x,k.y);a.applySceneCameras();a.applyHereParallaxCameras();b.homeScreenTime&&(d.globalAlpha=Math.max(0,b.homeScreenTime-.5));d.translate(0,30*Math.max(0,b.loaderTime-.5));var n=b.minX+.5*b.width-10,m=b.minY+
3;d.save();d.translate(n+6,m-10.5);d.rotate(-.3+.1*a.getTitleHeartbeat4().time*Math.PI);d.translate(-(n+6),-(m-10.5));d.drawImage(a.Resources.hud02Image,p,g,l,r,n,m,12,21);d.restore();d.drawImage(a.Resources.hud02Image,c,g,p,g,b.minX+.5*b.width-7.5,b.minY,15,9);.5>b.loaderTime&&1===a.getTitleHeartbeat5().direction&&d.drawImage(a.Resources.hud02Image,c,C,p,e,b.minX+.5*b.width-7.5,b.minY+9,15,3);d.globalAlpha=1;d.restore()}b.menu?(d.drawImage(a.Resources.hud02Image,c,q,g,e,k.x-3.3+6*b.menuTime,0,3,
.95),a.isSoundEnabled||d.drawImage(a.Resources.hud02Image,g,q,e,e,k.x-2.3+6*b.menuTime,0,1,1)):b.menuTime&&(d.drawImage(a.Resources.hud02Image,c,q,g,e,k.x-3.3+6*(.3-b.menuTime),0,3,.95),a.isSoundEnabled||d.drawImage(a.Resources.hud02Image,g,q,e,e,k.x-2.3+6*(.3-b.menuTime),0,1,1));b.credits?d.drawImage(a.Resources.hud01Image,c,c,r,z,0-20*b.creditsTime,0,.7*k.y,k.y):b.creditsTime&&d.drawImage(a.Resources.hud01Image,c,c,r,z,0-20*(.3-b.creditsTime),0,.7*k.y,k.y);b.showResults?(d.drawImage(a.Resources.hud03Image,
c,c,r,r,.5*k.x-3-20*b.showResultsTime,.5*k.y-3,6,6),a.canShare&&.1>b.showResultsTime&&(n=.5*k.x-1.5,m=.5*k.y-1.7-20*b.showResultsTime,d.save(),d.translate(n+1.5,m),d.rotate(-.1+.2*a.getTitleHeartbeat4().time),d.translate(-(n+1.5),-m),d.drawImage(a.Resources.hud03Image,r,c,g,l,n,m,3,4),d.restore()),a.drawNumber(d,Math.floor(b.drawScore).toString(),.5*k.x,.5*k.y-1.5,.7+2*b.scoreTime,2,!1),a.drawNumber(d,Math.floor(b.best).toString(),.5*k.x+.7-20*b.showResultsTime,.5*k.y-.45,.5,1,!1),b.newBest&&1===
a.getTitleHeartbeat5().direction&&d.drawImage(a.Resources.hud03Image,g,r,f,e,.5*k.x-.24-20*b.showResultsTime,.5*k.y-.65,2,1),n=.06*a.getTitleHeartbeat5().time,a.drawNumber(d,Math.min(5E3,50*b.playOn).toString(),.5*k.x+2-20*b.showResultsTime,.5*k.y+1.6,.33+n,2,!1,!0)):(b.homeScreen&&!b.homeScreenTime||b.credits||b.creditsTime||d.drawImage(a.Resources.hud02Image,c,r,f,f,0-3*b.homeScreenTime,0,1.5,1.5),d.drawImage(a.Resources.hud02Image,f,r,f,f,k.x-1.5,0,1.5,1.5));b.credits||a.drawNumber(d,a.userData.gold.toString(),
.5*k.x,k.y-.5,.4,2,!1,!0);b.goldMsgTime&&d.drawImage(a.Resources.hud03Image,p,r,p,f,.5*k.x-2.5-30*(.8<b.goldMsgTime?b.goldMsgTime-.8:0)+30*(.2>b.goldMsgTime?.2-b.goldMsgTime:0),.5*k.y-1,5,2);if(!b.homeScreen&&!b.showResults&&b.tutorial&&0===b.tutorialStep&&2.5>b.tutorialTime){var n=Math.max(0,b.tutorialTime-2),m=Math.max(0,b.tutorialTime-1.8),x=Math.max(0,b.tutorialTime-.3);d.drawImage(a.Resources.hud04Image,C,c,l,l,.5*k.x-3,.5*k.y-1-.1*a.getTitleHeartbeat4().time-30*n,3.5,3.5);d.drawImage(a.Resources.hud04Image,
c,l,r,l,.5*k.x-.5+30*x,.5*k.y-.9-.1*a.getTitleHeartbeat4().time,4.2,2.4);d.drawImage(a.Resources.hud04Image,c,c,C,l,.5*k.x-1.5,.5*k.y-2.7-.1*a.getTitleHeartbeat4().time-30*m,6*.7,2.8)}b.credits||!b.tutorial&&b.firstTap&&d.drawImage(a.Resources.hud05Image,c,C,l,l,0,k.y-3,2,2)};a.drawResults=function(c,b){var k=a.screenToScene({x:0,y:0}),g=Math.max(0,b.resultSetupTime-.7),m=a.getTitleHeartbeat1(),x=a.getTitleHeartbeat2(),t=a.getTitleHeartbeat3();c.drawImage(a.Resources.hud01Image,p,l,p,C,b.minX+.5*
b.width-6.25,k.y-20*g,12.5,15);1===t.direction?c.drawImage(a.Resources.hud01Image,f,r,f,e,b.minX+.5*b.width-2.5,k.y+3.75-20*g,5,2.5):c.drawImage(a.Resources.hud01Image,f,u,f,e,b.minX+.5*b.width-2.5,k.y+3.75-20*g,5,2.5);c.drawImage(a.Resources.hud01Image,l,u,e,e,b.minX+.5*b.width+2.25+.2*x.time,k.y+11.5-20*g,2.5,2.5);a.drawNumber(c,Math.floor(b.score).toString(),b.minX+.5*b.width-2.2,k.y+9.5-20*g,1.2,0,!0);a.drawNumber(c,Math.floor(b.best).toString(),b.minX+.5*b.width+2.7,k.y+10.6-20*g,.9,1,!0);b.newBest&&
.2<m.time&&c.drawImage(a.Resources.hud01Image,l,q,e,e,b.minX+.5*b.width+1.25,k.y+6.3-20*g,2.5,2.5)};a.drawNumber=function(d,b,f,l,m,p,t,r){var q=f-.35*b.length-(t?-.4:0),w=f+(t?.4:0);f=p*e;var z=a.Resources.hud02Image;2<p&&(f=u+(p-3)*e,z=a.Resources.hud01Image);d.save();d.translate(w,l);d.scale(m,m);d.translate(-w,-l);t&&(q+=.5,d.drawImage(z,u,f,e,e,q-1,l-1,1,1));r&&(q+=.5,d.drawImage(a.Resources.hud03Image,g,u,e,e,q-1,l-1,1,1));m=0;for(p=b.length;m<p;m+=1)t=b.charAt(m),t=parseInt(t,10)*e*.8,d.drawImage(z,
c+t,f,.77*e,e,q,l-1,.8,1),q+=.7;d.restore()};a.drawPlayer=function(d,b,k,n){var m,x,t,A,y;n=n?a.Resources.entities03Image:a.Resources.entities01Image;var w=b.heartBeats[0];t=b.heartBeats[2];A=b.heartBeats[3];y=b.y;m=b.direction;k=b.x-1.5;y-=1.5;d.save();var z=0;b.block&&b.block.bouncingTime&&(z=3*b.block.heartBeats[1].time*b.block.bouncingTime);d.translate(0,-b.scaleFactor*b.radius+z);m===a.DirectionEnum.Left&&(d.translate(2*b.x,0),d.scale(-1,1));d.translate(b.x,b.y);d.scale(b.scaleFactor,b.scaleFactor);
d.translate(-b.x,-b.y);d.translate(b.x,b.y);d.rotate(b.angle+0);d.translate(-b.x,-b.y);b.state===a.EntityStateEnum.Holding||b.state===a.EntityStateEnum.Dashing?(d.drawImage(n,l,c,e,e,k-.2,y+1.7+.15*t.time,1,1),d.drawImage(n,l,e,f,f,k-.05,y+1.3,2,2),d.drawImage(n,C,e,f,f,k+1.4,y+1.3,2,2)):d.drawImage(n,c,p,g,f,k+.25,y+1.3+.5*b.bouncingTime,3,2);0<b.bouncingTime&&.6>b.bouncingTime?d.drawImage(n,c,c,l,g,k-.5,y,4,3+3*b.bouncingTime):b.state!==a.EntityStateEnum.Holding?d.drawImage(n,c,c,l,g,k-.5,y,4,3):
d.drawImage(n,c,c,l,g,k-.5,y+.25*t.time,4,3);1===t.direction?0===A.direction?d.drawImage(n,c,g,f,f,k+.5,y+.5-b.bouncingTime+.2*t.time,2,2+2.5*b.bouncingTime):d.drawImage(n,C,g,f,f,k+.5,y+.5-b.bouncingTime+.2*t.time,2,2+2.5*b.bouncingTime):b.state===a.EntityStateEnum.Holding?d.drawImage(n,l,g,f,f,k+.5,y+.5+.2*t.time,2,2):d.drawImage(n,f,g,f,f,k+.5,y+.6-b.bouncingTime,2,2+2.5*b.bouncingTime);b.state!==a.EntityStateEnum.Holding&&b.state!==a.EntityStateEnum.Dashing||b.drawShoot||d.drawImage(n,p,c,e,e,
k+2.2,y+1.3+.15*t.time,1,1);d.restore();b.drawShoot?(t=b.x+.5,A=b.y,m=b.shoot.x,x=b.shoot.y,b=a.distance(t,A,m,x),m=a.vectorAngle(t,A,m,x),d.save(),d.translate(t,A),d.rotate(m),d.translate(-t,-A),d.drawImage(n,c,q,Math.max(.1,Math.min(u,e*b*.5)),e,t,A-.5,b,1),d.drawImage(n,C,c,e,e,t-.5,A-.5,1,1),d.restore()):b.state!==a.EntityStateEnum.Holding||b.drawShoot||(t=b.x-1.2,A=b.y-.25-.15*w.time+z,m=t-.5+w.time,x=A+2.3,b=a.distance(t,A,m,x),m=a.vectorAngle(t,A,m,x),d.save(),d.translate(t,A),d.rotate(m),
d.translate(-t,-A),d.drawImage(n,c,q,Math.max(.1,Math.min(u,e*b*.5)),e,t,A-.5,b,1),d.drawImage(n,u,u,f,f,t+1.5,A-1,2,2),d.restore(),d.drawImage(n,c,r,g,f,k+.1,y+.9-.15*w.time+z,3,2))};a.drawObject=function(c,b,f){var l=b.x-1.5,m=b.y-1.5;c.save();b.direction===a.DirectionEnum.Right&&(c.translate(2*b.x,0),c.scale(-1,1));c.translate(0,b.heartBeats[0].time);c.translate(b.x,b.y);c.scale(b.scaleFactor+.2*b.catchTime,b.scaleFactor+.4*b.catchTime);c.translate(-b.x,-b.y);var q=0;b.caught&&b.catchTime&&(q=
.3*Math.PI-b.heartBeats[0].time);c.translate(b.x,b.y);c.rotate(b.angle+q);c.translate(-b.x,-b.y);b.caught?(c.drawImage(a.Resources.entities01Image,C,p,g,g,l,m,3,3),f.playerEntity.pullingTime&&c.drawImage(a.Resources.entities01Image,p,u,g,e,l-.2,m+1,3,1)):c.drawImage(a.Resources.entities01Image,g,p,g,g,l,m,3,3);c.restore()};a.drawBlock=function(d,b,e,n,m){n=b.heartBeats[1];m=b.heartBeats[2];var p=b.x-1.5*e.blockSize,q=b.y-.1*e.blockSize;d.save();d.translate(0,b.offsetY);d.globalAlpha=1-b.offsetY/10;
b.direction===a.DirectionEnum.Left&&(d.translate(2*b.x,0),d.scale(-1,1));d.translate(b.x,b.y);d.scale(b.scaleFactor,b.scaleFactor);d.translate(-b.x,-b.y);d.translate(b.x,b.y);d.rotate(b.angle*b.rotationFactor);d.translate(-b.x,-b.y);if(b.type!==a.BlockTypeEnum.None){var u=0;b.bouncingTime&&(u=5*n.time*b.bouncingTime);b.hasCoin&&d.drawImage(a.Resources.hud03Image,r,l,f,f,p+.5*e.blockSize,q-1.5*e.blockSize+m.time,1.5*e.blockSize,1.5*e.blockSize);1===e.theme?d.drawImage(a.Resources.backdrop01Image,c,
c,g,g,p,q+u,3*e.blockSize,3*e.blockSize):d.drawImage(a.Resources.backdrop01Image,r,r,g,g,p,q+u,3*e.blockSize,3*e.blockSize)}d.restore()};a.drawEffect=function(d,b,k){var l=c;d.save();b.direction===a.DirectionEnum.Left&&(d.translate(2*b.x,0),d.scale(-1,1));d.translate(b.x,b.y);0<=b.scaleTime?d.scale(b.scaleFactor+b.scaleTime,b.scaleFactor+b.scaleTime):d.scale(b.scaleFactor,b.scaleFactor);d.translate(-b.x,-b.y);d.translate(b.x,b.y);d.rotate(b.angle);d.translate(-b.x,-b.y);b.selfDestroyTime<b.startFadeTime&&
(d.globalAlpha=b.selfDestroyTime);switch(b.type){case a.EffectTypeEnum.ImpactEffect:d.drawImage(a.Resources.entities01Image,c,q,e,e,b.x-.5,b.y-.5,1,1);break;case a.EffectTypeEnum.SparkEffect:d.drawImage(a.Resources.entities01Image,g,u,e,e,b.x-.5,b.y-.5,1,1);break;case a.EffectTypeEnum.NumberEffect:a.drawNumber(d,b.number.toString(),b.x-.5,b.y-.5,1.3,b.color,b.hasX);break;case a.EffectTypeEnum.BirdEffect:switch(b.displayType){case 0:d.drawImage(a.Resources.entities01Image,g,p,g,g,b.x-1.5,b.y-1.5,3,
3);break;case 1:d.drawImage(a.Resources.entities01Image,g,p,g,g,b.x-1.5,b.y-1.5,3,3)}break;case a.EffectTypeEnum.RumbleEffect:d.drawImage(a.Resources.entities02Image,l+(1===b.displayType?e:c),u,e,e,b.x-.5,b.y-.5,1,1);break;case a.EffectTypeEnum.CoinEffect:d.drawImage(a.Resources.hud03Image,g,u,e,e,b.x-.5*k.blockSize,b.y-.5*k.blockSize,k.blockSize,k.blockSize);break;default:d.drawImage(a.Resources.entities01Image,c,g,f,f,b.x-1,b.y-1,2,2)}d.restore()};a.drawHandEntity=function(d,b,k){k=b.heartBeats[0];
var n=b.heartBeats[1],m=d.globalAlpha,p=b.x+b.offset,q=b.y,A=p-1.5,y=q-1;d.save();b.direction===a.DirectionEnum.Left&&(d.translate(2*p,0),d.scale(-1,1));d.translate(p,q);d.scale(b.scaleFactor,b.scaleFactor);d.translate(-p,-q);n=.3*n.time;b.hold?(d.save(),b.direction===a.DirectionEnum.Left&&(d.translate(2*p-1.8,0),d.scale(-1,1)),d.drawImage(a.Resources.hud01Image,c,u,f,e,A-.3,y-1.2,2,1),d.restore(),d.drawImage(a.Resources.hud01Image,g,l,e,e,A+.1-n,y-.1-n,1+2*n,1+2*n)):1===k.direction&&(.2>k.time&&
(d.globalAlpha=Math.min(m,5*k.time)),d.save(),b.direction===a.DirectionEnum.Left&&(d.translate(2*p-1.8,0),d.scale(-1,1)),d.drawImage(a.Resources.hud01Image,c,r,f,e,A-.3,y-1.2-(1-k.time),2,1),d.restore(),d.drawImage(a.Resources.hud01Image,l,l,e,e,A+.1-n,y-.1-n,1+2*n,1+2*n));d.globalAlpha=m;b.hold?d.drawImage(a.Resources.hud01Image,c,l,g,g,A,y+.1,3,3):d.drawImage(a.Resources.hud01Image,c,l,g,g,A,y+k.maxTime-(0===k.direction?.4*k.time:.4*k.maxTime)-.3,3,3);d.restore()};a.drawIntroEntity=function(d,b,
g){var n=b.heartBeats[0],m=b.heartBeats[1],r=b.heartBeats[2],t=b.x,u=b.y,y=t-1,w=u-1;d.save();b.type===a.IntroEntityTypeEnum.Boo&&g.introTime<g.maxIntroTime-.4*g.introEvents[0]&&g.introTime>g.maxIntroTime-.6*g.introEvents[1]&&d.drawImage(a.Resources.hud01Image,c,q,l,e,g.minX+.5*g.width-2,g.maxY+.5,4,1);b.direction===a.DirectionEnum.Left&&(d.translate(2*t,0),d.scale(-1,1));d.translate(t,u);d.scale(b.scaleFactor,b.scaleFactor);d.translate(-t,-u);d.translate(t,u);d.rotate(b.angle);d.translate(-t,-u);
switch(b.type){case a.IntroEntityTypeEnum.Boo:b=.3*n.time;m=.3*m.time;t=.3*r.time;d.drawImage(a.Resources.entities01Image,c,f,f,f,y-b,w-m,2+2*b,2+2*m);g.introTime<g.maxIntroTime-g.introEvents[0]?(b=.5*n.time,d.drawImage(a.Resources.entities01Image,C,l,f,f,y-.5-b,w-1-b,3.5+2*b,3.5+2*b),d.drawImage(a.Resources.entities01Image,e,l,e,e,y+.5-b,w-4.5-5*t,4,4+2*t)):1===r.direction?d.drawImage(a.Resources.entities01Image,C,l,f,f,y+.5,w,2,2):d.drawImage(a.Resources.entities01Image,c,p,f,f,y+.5,w,2,2);break;
case a.IntroEntityTypeEnum.Spider:d.drawImage(a.Resources.entities01Image,f,f,l,p,y+.5,w,4,5)}d.restore()}})(window.OkijinGame=window.OkijinGame||{});(function(a,I){function c(){U=7;V=5.3;Y=Z=.5;aa=.1;K=N=M=0;T=a.DirectionEnum.Left}function e(){var b;F=a.GameStateEnum.GameLogo;var c=[{type:"img",id:"backdrop1",src:x.root+"/assets/img/"+m+"/backdrop1.png"},{type:"img",id:"backdrop2",src:x.root+"/assets/img/"+m+"/backdrop2.png"},{type:"img",id:"background1",src:x.root+"/assets/img/"+m+"/background1.png"},{type:"img",id:"entities1",src:x.root+"/assets/img/"+m+"/entities1.png"},{type:"img",id:"entities2",src:x.root+"/assets/img/"+m+"/entities2.png"},
{type:"img",id:"entities3",src:x.root+"/assets/img/"+m+"/entities3.png"},{type:"img",id:"hud1",src:x.root+"/assets/img/"+m+"/hud1.png"},{type:"img",id:"hud2",src:x.root+"/assets/img/"+m+"/hud2.png"},{type:"img",id:"hud3",src:x.root+"/assets/img/"+m+"/hud3.png"},{type:"img",id:"hud4",src:x.root+"/assets/img/"+m+"/hud4.png"},{type:"img",id:"hud5",src:x.root+"/assets/img/"+m+"/hud5.png"}];if(a.preloadSounds)for(b in a.soundItems)a.soundItems.hasOwnProperty(b)&&c.push({type:"snd",id:b,src:x.root+"/"+
a.soundItems[b]});a.loadResources(c,g,f)}function f(a,b){W={current:a,total:b};x.onGameLoading(Math.ceil(100*a/b))}function g(b){a.Resources.hud01Image=b.hud1;a.Resources.hud02Image=b.hud2;a.Resources.hud03Image=b.hud3;a.Resources.hud04Image=b.hud4;a.Resources.hud05Image=b.hud5;a.Resources.background01Image=b.background1;a.Resources.background02Image=b.background2;a.Resources.backdrop01Image=b.backdrop1;a.Resources.backdrop02Image=b.backdrop2;a.Resources.entities01Image=b.entities1;a.Resources.entities02Image=
b.entities2;a.Resources.entities03Image=b.entities3;a.loadShopItems();a.loadLeaderboardItems();X=!0}function l(){var b=(new Date).getTime(),c=Math.min((b-(ba||b))/1E3,.05),d=c;ba=b;window.requestAnimationFrame(l);D.setTransform(1,0,0,1,0,0);D.clearRect(0,0,w.width,w.height);0<O&&(c*=.5);p(c,d);a.draw(D,h)}function p(b,c){var d,e,f;0<P&&(P-=b,0>=P&&(P=0,F=a.GameStateEnum.GameLoading));if(X)if(F===a.GameStateEnum.GameLoading)F=a.GameStateEnum.GameRun,h=new a.SceneManager,h.size=a.screenToHud({x:w.width,
y:w.height}),R=!1,k(!0),F=a.GameStateEnum.GameRun,setTimeout(function(){a.playSound("music1")},1E3);else if(F===a.GameStateEnum.GameRun){d=0;for(e=G.length;d<e;d+=1)f=G[d],0===f.direction&&f.time<=f.maxTime?(f.time=Math.min(f.time+b*f.speed1,f.maxTime),f.time===f.maxTime&&(f.direction=1)):1===f.direction&&0<=f.time&&(f.time=Math.max(f.time-b*f.speed2,0),0===f.time&&(f.direction=0));h.update(b,S);r(b);u(b);q(b,c,L)}}function C(){var b,c,d;b=new a.Camera;var e=h.maxY-h.minY,f=h.maxX-h.minX;b.multiply(H);
b=b.screenToCamera(w.width,w.height);switch(t){case a.LayoutOrientationEnum.Landscape:d=b.y/(e+7);c=b.x/(f+7);break;case a.LayoutOrientationEnum.Portrait:d=b.y/(e+7),c=b.x/(f+7)}return{x:h.minX+.5*f,y:h.minY+.5*e,zoom:Math.min(1*c,1*d)}}function r(b){var c,d,e=[];for(c=0;c<h.effects.length;)if(d=h.effects[c],d.update(b),0===d.selfDestroyTime)h.effects.splice(c,1);else{if(d.target&&!d.activationCooldown){var f=a.distance(d.x,d.y,d.target.x,d.target.y);f>d.radius?(d.vx=(d.target.x-d.x)/f*14,d.vy=(d.target.y-
d.y)/f*14):(d.selfDestroyTime=0,a.playSound("coin"),f=5*(Math.floor(3.99*Math.random())+3),a.userData.gold+=f,e.push(new a.NumberEffect(d.x,d.y-1,f,0,!0)))}c+=1}for(c=0;c<e.length;c+=1)h.effects.push(e[c])}function u(b){b=C();h.shakeCamera&&(h.shakeCamera=!1,K=.5,T=T===a.DirectionEnum.Right?a.DirectionEnum.Left:a.DirectionEnum.Right);h.slowCamera&&(h.slowCamera=!1,O=3);h.zoomCamera&&(h.zoomCamera=!1,M=1.3);h.homeScreen?(J=0,E=b.zoom,L={x:h.minX+.5*h.width,y:h.minY+.5*h.height}):(J=0,E=b.zoom,L={x:h.playerEntity.x+
.3*h.width,y:h.minY+.5*h.height});if(h.tutorial)for(b=0;b<h.objects.length;b+=1)if(!(h.objects[b].isDead||h.objects[b].deadTime||2!==h.tutorialStep&&4!==h.tutorialStep)&&h.objects[b].x<h.playerEntity.x+9.5&&h.objects[b].x>h.playerEntity.x+8.5&&h.playerEntity.block){h.playerEntity.bouncingTime=0;h.playerEntity.grounded=!1;h.neverHold=!1;h.tutorialHoldTime=.6;h.targetObject=h.objects[b];a.playSound("slash1");break}h.endSession&&(h.endSession=!1,x.onGameSessionEnded({score:Math.floor(h.score)}))}function q(b,
c,d){var e=B.x,f=B.y;B.x=0;B.y=0;B.update();0<O&&(O-=c,0>O&&(O=0));var g=new a.Camera;g.multiply(H);g=g.screenToCamera(w.width,w.height);B.tx=g.x/2-d.x;B.ty=g.y/2-d.y;d=a.distance(e,f,B.tx,B.ty);if(1E-4<Math.abs(d)){var k=(B.tx-e)/d,l=(B.ty-f)/d,m=1;h&&h.playerEntity.state!==a.EntityStateEnum.None&&(m=h.entityChangeTime?.5:.2);var n=b*d*U,e=e+b*d*U*m*k,f=f+n*l}else e=B.tx,f=B.ty;B.x=e;B.y=f;v.x=g.x/2-e;v.y=g.y/2-f;0<K&&(K-=b,0>K&&(K=0));0<M&&(M-=b,0>M&&(M=0));0<N&&(N-=b,0>N&&(N=0));b=Z;0<M&&(E*=.6,
b=Y);0<N&&(b=aa);v.sx>E&&(v.sx-=b*c,v.sx<E&&(v.sx=E));v.sx<E&&(v.sx+=b*c,v.sx>E&&(v.sx=E));v.sy=v.sx;0===K&&(v.angle>J?(v.angle-=V*Math.PI*c,v.angle<J&&(v.angle=J)):v.angle<J&&(v.angle+=V*Math.PI*c,v.angle>J&&(v.angle=J)));0<K&&(v.angle=T===a.DirectionEnum.Right?-.05+.25*G[0].time:.05-.25*G[0].time);B.update();v.update();Q.update()}function z(b){var c,d,e;if(!R&&(S=!0,c=b.pageX,d=b.pageY,a.screenToScene({x:c/A,y:d/y}),e=a.screenToHud({x:c/A,y:d/y}),b=a.screenToHud({x:w.width,y:w.height}),a.screenToHud({x:c/
A,y:d/y}),F===a.GameStateEnum.GameRun&&(c=!1,h.menu&&!h.menuTime&&(a.pointInRect(e.x,e.y,b.x-2.2,0,b.x-1.4,1)?(a.enableSound(!a.isSoundEnabled),a.playSound("click"),c=!0):a.pointInRect(e.x,e.y,b.x-3.1,0,b.x-2.3,1)&&(h.credits=!h.credits,h.creditsTime=.3,a.playSound("click"),c=!0,h.menu&&(h.menu=!1,h.menuTime=.3))),!c)))if(h.showResults)a.pointInRect(e.x,e.y,.5*b.x+1.4,.5*b.y+1.5,.5*b.x+2.8,.5*b.y+2.8)?(a.playSound("click"),a.userData.gold>=Math.min(5E3,50*h.playOn)?(h.showResults=!1,h.showResultsTime=
.3,h.lastBlock.hasCoin=!1,h.playerEntity.x=h.lastBlock.x,h.playerEntity.y=h.lastBlock.y-10,h.bonus=0,a.userData.gold-=Math.min(5E3,50*h.playOn),h.playOn*=2,a.saveUserData(),a.playSound("playon")):h.goldMsgTime=1):a.pointInRect(e.x,e.y,.5*b.x-2.8,.5*b.y+1.5,.5*b.x-1.4,.5*b.y+2.8)?(a.playSound("click"),k(!0)):a.pointInRect(e.x,e.y,.5*b.x-1,.5*b.y,.5*b.x+1,.5*b.y+2.2)&&a.playSound("click");else if(h.credits)h.credits&&(h.credits=!1,h.creditsTime=.3);else if(a.pointInRect(e.x,e.y,b.x-1.5,0,b.x,1.5))h.menu=
h.menu?!1:!0,h.menuTime=h.menuTime?Math.min(h.menuTime,.3):.3,a.playSound("click"),h.credits&&(h.credits=!1,h.creditsTime=.3);else if(h.homeScreen&&!h.homeScreenTime)a.pointInRect(e.x,e.y,0,b.y-3,2,b.y-1)?(h.homeScreen=!1,k(!0),h.tutorial=!0,h.homeScreenTime=1):(h.homeScreenTime=1,k(!1),0===a.userData.bestScore&&(h.tutorial=!0)),h.menu&&(h.menu=!1,h.menuTime=.3),h.credits&&(h.credits=!1,h.creditsTime=.3);else if(a.pointInRect(e.x,e.y,0,0,1.5,1.5))a.playSound("click"),k(!0);else if(h.menu&&(h.menu=
!1,h.menuTime=.3),h.credits&&(h.credits=!1,h.creditsTime=.3),h.tutorial&&0===h.tutorialStep&&0===h.tutorialTime)h.playerEntity.block&&(h.tutorialStep=1,h.activeEntityId=1,a.playSound("slash2"));else if(!(h.tutorial||h.playerEntity.deadTime||h.playerEntity.isDead||(c=!1,h.firstTap&&(h.firstTap=!1,a.pointInRect(e.x,e.y,0,b.y-3,2,b.y-1)&&(h.homeScreen=!1,k(!0),c=h.tutorial=!0,h.firstTap=!0)),c)))for(h.playerEntity.bouncingTime=0,h.playerEntity.grounded=!1,h.neverHold=!1,h.targetObject=null,b=999,e=0;e<
h.objects.length;e+=1)if(!h.objects[e].isDead&&!h.objects[e].deadTime&&h.objects[e].x>h.playerEntity.x-.5&&(c=a.distance(h.objects[e].x,h.objects[e].y,h.playerEntity.x,h.playerEntity.y),c<b))switch(b=c,h.targetObject=h.objects[e],Math.floor(2.99*Math.random())){case 0:a.playSound("slash1");break;case 1:a.playSound("slash2");break;case 2:a.playSound("slash3")}}function d(b){var c;c=b.pageX;b=b.pageY;a.screenToScene({x:c/A,y:b/y});a.screenToHud({x:c/A,y:b/y});a.screenToHud({x:w.width,y:w.height})}function b(b){var c;
c=b.pageX;b=b.pageY;a.screenToScene({x:c/A,y:b/y});a.screenToHud({x:c/A,y:b/y});a.screenToHud({x:w.width,y:w.height});S&&(S=!1)}function k(b){c();b?(h.loadLevel(),J=0,L={x:h.playerEntity.x+.3*h.width,y:h.playerEntity.y+.5*h.height},E=1.8*C().zoom,b=new a.Camera,b.multiply(H),b=b.screenToCamera(w.width,w.height),B.x=b.x/2-L.x,B.y=b.y/2-L.y,v.angle=0,v.sx=E,v.sy=E,h.homeScreen?a.playSound("intro"):(a.playSound("start"),x.onGameSessionStarted())):(J=0,L={x:h.playerEntity.x+.3*h.width,y:h.playerEntity.y+
.5*h.height},E=1.8*C().zoom,b=new a.Camera,b.multiply(H),b=b.screenToCamera(w.width,w.height),B.x=b.x/2-L.x,B.y=b.y/2-L.y,v.angle=0,v.sx=E,v.sy=E,a.playSound("start"),x.onGameSessionStarted())}var n,m,x,t,A,y,w,D,R,F,ba,h,H,B,v,Q,L,E,U,V,Z,Y,aa,J,M,N,K,T,O,X,P,ca,W,S,G=[{time:0,direction:0,maxTime:.2,speed1:3,speed2:3},{time:0,direction:0,maxTime:3,speed1:1,speed2:1.5},{time:0,direction:0,maxTime:2,speed1:1,speed2:1.5},{time:0,direction:0,maxTime:1,speed1:.5,speed2:2},{time:0,direction:0,maxTime:.8,
speed1:.8,speed2:.8},{time:0,direction:0,maxTime:1,speed1:3,speed2:2},{time:0,direction:0,maxTime:1,speed1:2.5,speed2:1},{time:0,direction:0,maxTime:2,speed1:5,speed2:2.5},{time:0,direction:0,maxTime:1,speed1:1.5,speed2:1.2},{time:0,direction:0,maxTime:1,speed1:4,speed2:3}];a.getScaleUnit=function(){return n};a.getCurrentGameState=function(){return F};a.getCanvasWidth=function(){return w.width};a.getCanvasHeight=function(){return w.height};a.getLogoTime=function(){return P};a.getMenuTime=function(){return ca};
a.getGameLoadingData=function(){return W};a.getLayoutOrientation=function(){return t};a.getCameraTranslationX=function(){return v.x};a.getTitleHeartbeat1=function(){return G[1]};a.getTitleHeartbeat2=function(){return G[2]};a.getTitleHeartbeat3=function(){return G[3]};a.getTitleHeartbeat4=function(){return G[4]};a.getTitleHeartbeat5=function(){return G[5]};a.getTitleHeartbeat6=function(){return G[6]};a.getTitleHeartbeat7=function(){return G[7]};a.getTitleHeartbeat8=function(){return G[8]};a.getTitleHeartbeat9=
function(){return G[9]};a.getPaused=function(){return R};a.setPaused=function(a){R=a};a.applyHudCameras=function(){D.setTransform.apply(D,H.matrix);D.transform.apply(D,Q.matrix)};a.applySceneCameras=function(){D.setTransform.apply(D,H.matrix);D.transform.apply(D,B.matrix);D.transform.apply(D,v.matrix)};a.applyVeryFarParallaxCameras=function(){D.translate(.15*-v.x,.15*-v.y)};a.applyFarParallaxCameras=function(){D.translate(.3*-v.x,.3*-v.y)};a.applyNearParallaxCameras=function(){D.translate(.45*-v.x,
.45*-v.y)};a.applyVeryNearParallaxCameras=function(){D.translate(.75*-v.x,.75*-v.y)};a.applyHereParallaxCameras=function(){D.translate(-v.x,-v.y)};a.screenToHud=function(b){var c=new a.Camera;c.multiply(H);c.multiply(Q);return c.screenToCamera(b.x,b.y)};a.screenToScene=function(b){var c=new a.Camera;c.multiply(H);c.multiply(B);c.multiply(v);c.translate(-v.x,-v.y);return c.screenToCamera(b.x,b.y)};a.getAssetResolution=function(){return a.AssetResolutionEnum.ResolutionA};a.initialize=function(f){a.initializeSystem();
c();x={root:f&&f.root?f.root:"",onGameLoading:f&&f.onGameLoading?f.onGameLoading:function(){},onGameSessionStarted:f&&f.onGameSessionStarted?f.onGameSessionStarted:function(){},onGameSessionEnded:f&&f.onGameSessionEnded?f.onGameSessionEnded:function(){},useHighResolution:f&&f.useHighResolution?f.useHighResolution:!1,rollTime:f&&f.rollTime?f.rollTime:0};S=X=R=!1;ca=0;P=3+x.rollTime;W={current:0,total:0};f=a.AssetResolutionEnum.ResolutionA;if(!x.useHighResolution){var g=Math.max($(window).width(),$(window).height());
f=a.AssetResolutionEnum.ResolutionB;400>g?f=a.AssetResolutionEnum.ResolutionE:500>g?f=a.AssetResolutionEnum.ResolutionD:1E3>g&&(f=a.AssetResolutionEnum.ResolutionC)}switch(f){case a.AssetResolutionEnum.ResolutionA:n=1/96;m="960";break;case a.AssetResolutionEnum.ResolutionB:n=1/72;m="720";break;case a.AssetResolutionEnum.ResolutionC:n=1/65;m="650";break;case a.AssetResolutionEnum.ResolutionD:n=.025;m="400";break;case a.AssetResolutionEnum.ResolutionE:n=.03125,m="320"}a.loadUserData();a.setupTileOffsets();
w=document.getElementById("canvas");D=w.getContext("2d");$(document).bind("vmousedown",z);$(document).bind("vmouseup",b);$(document).bind("vmousemove",d);H=new a.Camera;B=new a.Camera;v=new a.Camera;Q=new a.Camera;Q.sx=1;Q.sy=1;Q.update();a.resetDisplay();a.Resources.loadingScreenImage=new Image;a.Resources.loadingScreenImage.onload=e;a.Resources.loadingScreenImage.src=x.root+"/assets/img/"+m+"/loadingscreen.png";F=a.GameStateEnum.GamePreLoading;l()};a.resetDisplay=function(){var b=1/n;t=$(window).width()>=
$(window).height()?a.LayoutOrientationEnum.Landscape:a.LayoutOrientationEnum.Portrait;w.width=t===a.LayoutOrientationEnum.Landscape?14*b:8*b;w.height=t===a.LayoutOrientationEnum.Landscape?14*b*$(window).height()/$(window).width():8*b*$(window).height()/$(window).width();A=$(window).width()/w.width;y=$(window).height()/w.height;w.style.width=$(window).width()+"px";w.style.height=$(window).height()+"px";H&&(H.sx=1/n,H.sy=1/n,H.update());h&&(h.size=a.screenToHud({x:w.width,y:w.height}))};a.navigateBack=
function(){if(F!==a.GameStateEnum.GameRun&&F!==a.GameStateEnum.GameLost&&F!==a.GameStateEnum.GameWon)return"exit";h&&(h.homeScreen=!0,h.loaderTime=1,R=!1,k(!0),F=a.GameStateEnum.GameRun);return"stay"}})(window.OkijinGame=window.OkijinGame||{});