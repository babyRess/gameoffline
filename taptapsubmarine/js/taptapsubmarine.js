function backgroundCreateBubbles(e,t){e.stage.backgroundColor=0;for(var n=0;n<BUBBLE_LAYERS;n++){t[n]=e.add.group();var r=(n+1)/(BUBBLE_LAYERS+1);var i=n+1;for(var s=0;s<i;s++){var o=e.rnd.integerInRange(0,uboat.GAME_WIDTH-32);var u=e.rnd.integerInRange(-64,uboat.GAME_HEIGHT);var a=e.add.sprite(o,u,"backobjs");a.scale.x=r;a.scale.y=r;t[n].add(a)}}}function backgroundUpdateBubbles(e,t){for(var n=0;n<BUBBLE_LAYERS;n++){var r=(n+1)/(BUBBLE_LAYERS*2);for(var i=0;i<t[n].children.length;i++){t[n].children[i].y-=r*2;if(t[n].children[i].y<-64){t[n].children[i].x=e.rnd.integerInRange(0,uboat.GAME_WIDTH-32);t[n].children[i].y=uboat.GAME_HEIGHT}}}}function backgroundFadeIn(e,t){var n=0;var r=1;if(t==true){n=1;r=0}var i=e.add.graphics(0,0);i.beginFill(0,1);i.drawRect(0,0,uboat.GAME_WIDTH,uboat.GAME_HEIGHT);i.alpha=n;var s=e.add.tween(i);s.to({alpha:r},500,Phaser.Easing.Linear.None,true);return s}MyLabelButton=function(e,t,n,r,i,s,o,u,a,f,l){Phaser.Button.call(this,e,t,n,r,s,o,u,a,f,l);this.label=new Phaser.BitmapText(e,0,0,"myfont",i,48);this.addChild(this.label);this.setLabel(i);e.add.existing(this)};MyLabelButton.prototype=Object.create(Phaser.Button.prototype);MyLabelButton.prototype.constructor=MyLabelButton;MyLabelButton.prototype.setLabel=function(e){this.label.setText(e);this.label.update();this.label.x=Math.floor((this.width-this.label.width)*.5);this.label.y=Math.floor((this.height-this.label.height)*.2)};Phaser.BitmapText.prototype.makeCentered=function(e){this.updateText();this.x=Math.floor(e-this.textWidth*.5)};var BUBBLE_LAYERS=10;var BUBBLES_PER_LAYER=10;var SUBMARINE_VERION="v1.0";var uboat={};uboat.Bootup=function(e){Cocoon.App.exitCallback(function(){console.log("** exitCallback 444 -> game="+e);console.log("** exitCallback 444 -> game.state="+e.state);console.log("** exitCallback 444 -> game.state.current="+e.state.current);switch(e.state.current){case"MainMenu":var t=e.state.states["MainMenu"].doBtnBack();return t;break;case"LevelSelect":e.state.states["LevelSelect"].doBtnBack();return false;break;case"Tutorial":e.state.states["Tutorial"].doBtnBack();return false;break;case"Game":e.state.states["Game"].doBtnBack();return false;break;default:return true}}.bind(this))};uboat.Bootup.prototype={preload:function(){this.load.image("preloaderBar","img/loading-bar.png")},create:function(){this.input.maxPointers=1;this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL;this.scale.pageAlignHorizontally=true;this.scale.pageAlignVertically=true;this.scale.setScreenSize(true);this.state.start("Preloader")}};uboat.Preloader=function(e){uboat.GAME_WIDTH=640;uboat.GAME_HEIGHT=960};uboat.Preloader.prototype={preload:function(){this.stage.backgroundColor="#B4D9E7";this.preloadBar=this.add.sprite((uboat.GAME_WIDTH-311)/2,(uboat.GAME_HEIGHT-27)/2,"preloaderBar");this.load.setPreloadSprite(this.preloadBar);this.load.setPreloadSprite(this.preloadBar);this.load.image("title","img/title.png");this.load.image("background","img/background.png");this.load.image("submarine","img/submarine.png");this.load.spritesheet("gameobjs","img/gameobjs.png",64,64);this.load.spritesheet("explosions","img/explosions.png",160,160);this.load.spritesheet("particles","img/particles.png",32,32);this.load.spritesheet("backobjs","img/backobjs.png",32,32);this.load.image("ingamepanel","img/ingamepanel.png");this.load.spritesheet("button","img/button.png",320,72);this.load.spritesheet("buttonicon","img/buttonicon.png",128,128);this.load.spritesheet("levelicons","img/levelicons.png",96,96);this.load.spritesheet("tutorialicons","img/tutorialicons.png",96,96);var e=".json";console.log("preloader - fileFormat="+e);this.load.bitmapFont("myfont","font/font.png","font/font"+e);this.load.audio("gui_back","snd/gui_back.ogg");this.load.audio("gui_button","snd/gui_button.ogg");this.load.audio("gui_forward","snd/gui_forward.ogg");this.load.audio("gui_denied","snd/gui_denied.ogg");this.load.audio("coin","snd/coin4.wav");this.load.audio("ruby","snd/ping.wav");this.load.audio("treasure","snd/treasure3.wav");this.load.audio("squid","snd/squid.wav");this.load.audio("fizzle","snd/fizzle.wav");this.load.audio("explode","snd/explode.wav")},create:function(){this.state.start("MainMenu")}};var MENU_ENTER_LEFT=1;var MENU_ENTER_RIGHT=2;var MENU_EXIT_LEFT=3;var MENU_EXIT_RIGHT=4;uboat.MainMenu=function(e){this.game=e;this._btnStart=null;this._btnCredits=null;this._txtCredits1=null;this._txtCredits2=null;this._txtCredits3=null;this._btnCreditsOk=null;this._logoBdR=null;this._logoPhaser=null;this._strCheatCode=""};uboat.MainMenu.prototype={create:function(){this.add.sprite(0,0,"background");this._backobjsGroup=[];backgroundCreateBubbles(this.game,this._backobjsGroup);var e=this.add.sprite(0,0,"title");e.x=(uboat.GAME_WIDTH-e.width)*.5;e.y=0-e.height;this.game.add.tween(e).to({y:40},400,Phaser.Easing.Back.Out,true,200);var t=this.game.add.bitmapText(320,960-64,"myfont","BdR GamesÂ©2014",48);t.makeCentered(320);e.inputEnabled=true;e.events.onInputDown.add(this.onTitleTouch,this);this._grpMainMenu=this.game.add.group();this._btnStart=new MyLabelButton(this.game,160,512,"button","Start game",this.doBtnStart,this,1,0,2);var n=new MyLabelButton(this.game,160,512+112,"button","How to play",this.doBtnTutorial,this,1,0,2);var r=new MyLabelButton(this.game,160,512+224,"button","Options",this.doBtnOptions,this,1,0,2);this._grpMainMenu.add(this._btnStart);this._grpMainMenu.add(n);this._grpMainMenu.add(r);this._grpOptions=this.game.add.group();var i=new MyLabelButton(this.game,160,512,"button","Reset game",this.doBtnResetGame,this,1,0,2);var s=new MyLabelButton(this.game,160,512+112,"button","Credits",this.doBtnCredits,this,1,0,2);var o=new MyLabelButton(this.game,160,512+224,"button","Back",this.doBtnBack,this,1,0,2);this._grpOptions.add(i);this._grpOptions.add(s);this._grpOptions.add(o);this._grpResetGame=this.game.add.group();var u=this.game.add.bitmapText(320,420,"myfont","Reset game progress,\nare you sure?",48);u.align="center";u.makeCentered(320);var a=new MyLabelButton(this.game,160,512+112,"button","Yes",this.doBtnResetGameOk,this,1,0,2);var f=new MyLabelButton(this.game,160,512+224,"button","No",this.doBtnBack,this,1,0,2);this._grpResetGame.add(u);this._grpResetGame.add(a);this._grpResetGame.add(f);this._grpCredits=this.game.add.group();var l=this.game.add.bitmapText(160,400,"myfont","Program, game design\nand graphics by\nBas de Reuver",48);l.align="center";l.makeCentered(320);this._cheatText=this.game.add.bitmapText(320,-320,"myfont","Levels unlocked",48);this._cheatText.makeCentered(320);var c=this.game.add.sprite(160,640,"buttonicon",14);var h=this.game.add.sprite(352,640,"buttonicon",15);var p=new MyLabelButton(this.game,160,800,"button","Ok",this.doBtnBack,this,1,0,2);var d=this.game.add.bitmapText(640-96,960-64,"myfont",SUBMARINE_VERION,48);this._grpCredits.add(l);this._grpCredits.add(this._cheatText);this._grpCredits.add(c);this._grpCredits.add(h);this._grpCredits.add(p);this._grpCredits.add(d);this.soundGuiButton=this.game.add.audio("gui_button");this.soundGuiForward=this.game.add.audio("gui_forward");this.soundGuiBack=this.game.add.audio("gui_back");this._grpMainMenu.x=-640;this._grpOptions.x=+640;this._grpResetGame.x=+640;this._grpCredits.x=+640;backgroundFadeIn(this.game,true);this.game.time.events.add(200,function(){this.moveScene(this._grpMainMenu,MENU_ENTER_LEFT)},this)},update:function(){backgroundUpdateBubbles(this.game,this._backobjsGroup)},onTitleTouch:function(e,t){if(this._grpCredits.x==0){console.log("onTitleTouch ----!");var n=new Phaser.Rectangle(0,0,e.width/2,e.height/2);var r=new Phaser.Rectangle(e.width/2,0,e.width/2,e.height/2);var i=new Phaser.Rectangle(0,e.height/2,e.width,e.height/2);var s=n.contains(t.x,t.y);var o="-";if(n.contains(t.x,t.y)==true){o="L"}if(r.contains(t.x,t.y)==true){o="R"}if(i.contains(t.x,t.y)==true){o="B"}this._strCheatCode+=o;if(this._strCheatCode.length>9){this._strCheatCode=this._strCheatCode.substring(this._strCheatCode.length-9)}if(this._strCheatCode=="LRBLRBLRB"){this._strCheatCode=="";this.CheatUnlockAll();this._cheatText.y=400-48;this._cheatText.alpha=1;this.game.add.tween(this._cheatText).to({y:this._cheatText.y-80,alpha:0},300,Phaser.Easing.Linear.None,true,600)}}},CheatUnlockAll:function(){if(!uboat.PlayerProgress){this.game.state.states["LevelSelect"].loadLevelProgress()}for(var e=0;e<LevelData.length;e++){if(!uboat.PlayerProgress[e]||uboat.PlayerProgress[e]<0){uboat.PlayerProgress[e]=0}}window.localStorage.setItem("taptap_progress",JSON.stringify(uboat.PlayerProgress))},doBtnStart:function(){this.soundGuiForward.play();var e=backgroundFadeIn(this.game,false);e.onComplete.add(function(){this.state.start("LevelSelect")},this)},doBtnTutorial:function(){this.soundGuiForward.play();var e=backgroundFadeIn(this.game,false);e.onComplete.add(function(){this.state.start("Tutorial")},this)},doBtnOptions:function(){this.soundGuiForward.play();this.moveScene(this._grpOptions,MENU_ENTER_RIGHT);this.moveScene(this._grpMainMenu,MENU_EXIT_LEFT)},doBtnResetGame:function(){this.soundGuiForward.play();this.moveScene(this._grpResetGame,MENU_ENTER_RIGHT);this.moveScene(this._grpOptions,MENU_EXIT_LEFT)},doBtnResetGameOk:function(){uboat.PlayerProgress=null;window.localStorage.removeItem("taptap_progress");this.soundGuiBack.play();this.doBtnBack()},doBtnCredits:function(){this.soundGuiForward.play();this.moveScene(this._grpCredits,MENU_ENTER_RIGHT);this.moveScene(this._grpOptions,MENU_EXIT_LEFT)},doBtnBack:function(){if(this._grpResetGame.x<640){this.soundGuiBack.play();this.moveScene(this._grpOptions,MENU_ENTER_LEFT);this.moveScene(this._grpResetGame,MENU_EXIT_RIGHT);return false}else if(this._grpCredits.x<640){this.soundGuiBack.play();this.moveScene(this._grpOptions,MENU_ENTER_LEFT);this.moveScene(this._grpCredits,MENU_EXIT_RIGHT);return false}else if(this._grpOptions.x<640){this.soundGuiBack.play();this.moveScene(this._grpMainMenu,MENU_ENTER_LEFT);this.moveScene(this._grpOptions,MENU_EXIT_RIGHT);return false}else{return true}},moveScene:function(e,t){var n=-640;var r=0;if(t==MENU_ENTER_RIGHT){n=+640;r=0}if(t==MENU_EXIT_LEFT){n=0;r=-640}if(t==MENU_EXIT_RIGHT){n=0;r=+640}e.x=n;this.game.add.tween(e).to({x:r},400,Phaser.Easing.Back.Out,true)}};uboat.LevelSelect=function(e){this.game=e;this._txtselect=null;this._btnGoback=null;this._icons=[]};uboat.LevelSelect.prototype={create:function(){this.add.sprite(0,0,"background");this._backobjsGroup=[];backgroundCreateBubbles(this.game,this._backobjsGroup);this._txtselect=this.game.add.bitmapText(148,-64,"myfont","Select a level",64);this._btnGoback=this.game.add.button(-160,820,"buttonicon",this.doBtnBack,this,4,0,8);this.soundGuiButton=this.game.add.audio("gui_button");this.soundGuiDenied=this.game.add.audio("gui_denied");this.soundGuiBack=this.game.add.audio("gui_back");this.loadLevelProgress();this.createLevelIcons();this.showLevelIcons();backgroundFadeIn(this.game,true)},update:function(){backgroundUpdateBubbles(this.game,this._backobjsGroup)},loadLevelProgress:function(){if(!uboat.PlayerProgress){var e=window.localStorage.getItem("taptap_progress");try{uboat.PlayerProgress=JSON.parse(e)}catch(t){uboat.PlayerProgress=[]}if(Object.prototype.toString.call(uboat.PlayerProgress)!=="[object Array]"){uboat.PlayerProgress=[]}}},createLevelIcons:function(){var e=0;for(var t=0;t<3;t++){for(var n=0;n<4;n++){e=e+1;var r=uboat.PlayerProgress[e-1];if(typeof r==="number"){}else{uboat.PlayerProgress[e-1]=-1;r=-1}if(!uboat.PlayerProgress){uboat.PlayerProgress=[]}else{if(uboat.PlayerProgress.length>=e-1){r=uboat.PlayerProgress[e-1]}else{uboat.PlayerProgress[e-1]=-1}}if(e==1&&r<0){r=0}var i=true;var s=0;if(r>-1){i=false;if(r<4){s=r}}var o=80+n*128;var u=320+t*128;this._icons[e-1]=this.createLevelIcon(o,u,e,i,s);var a=this._icons[e-1].getAt(0);a.health=e;a.inputEnabled=true;a.events.onInputDown.add(this.onLevelIconDown,this)}}},createLevelIcon:function(e,t,n,r,i){var s=this.game.add.group();s.x=e;s.y=t;s.xOrg=e;s.yOrg=t;var o=0;if(r==false){o=1}var u=this.game.add.sprite(0,0,"levelicons",o);s.add(u);var a=this.game.add.bitmapText(24,16,"myfont",""+n,48);a.makeCentered(48-4);s.add(a);if(r==false){var f=this.game.add.sprite(0,0,"levelicons",2+i);s.add(f)}return s},showLevelIcons:function(){for(var e=0;e<this._icons.length;e++){var t=this._icons[e];t.y=t.y+640;var n=t.y;this.game.add.tween(t).to({y:n-640},500,Phaser.Easing.Back.Out,true,e*40)}this.game.add.tween(this._txtselect).to({y:128},400,Phaser.Easing.Back.Out,true);this.game.add.tween(this._btnGoback).to({x:48},400,Phaser.Easing.Back.Out,true,this._icons.length*40)},onLevelIconDown:function(e,t){var n=e.health;var r=e.frame==0;if(r){var i=this._icons[n-1];var s=i.xOrg;var o=this.game.add.tween(i).to({x:s+6},20,Phaser.Easing.Linear.None).to({x:s-5},20,Phaser.Easing.Linear.None).to({x:s+4},20,Phaser.Easing.Linear.None).to({x:s-3},20,Phaser.Easing.Linear.None).to({x:s+2},20,Phaser.Easing.Linear.None).to({x:s},20,Phaser.Easing.Linear.None).start();this.soundGuiDenied.play()}else{var i=this._icons[n-1];var o=this.game.add.tween(i.scale).to({x:.9,y:.9},100,Phaser.Easing.Linear.None).to({x:1,y:1},100,Phaser.Easing.Linear.None).start();o._lastChild.onComplete.add(function(){this.onLevelSelected(e.health)},this);this.soundGuiButton.play()}},onLevelSelected:function(e){this.game.state.states["Game"]._levelIndex=e-1;var t=backgroundFadeIn(this.game,false);if(e==1&&uboat.PlayerProgress[0]==0){this.game.state.states["Tutorial"]._tutorialFull=false;t.onComplete.add(function(){this.state.start("Tutorial")},this)}else{t.onComplete.add(function(){this.state.start("Game")},this)}},doBtnBack:function(){this.soundGuiBack.play();var e=backgroundFadeIn(this.game,false);e.onComplete.add(function(){this.state.start("MainMenu")},this)}};var MOVE_CIRCLE_RADIUS=80;var MOVE_SPEED=3;var HIT_SPR_DIAMETER=24;var MARGIN_TOPBOTTOM=40;var PRECALC_SPEED=4.189;var Submarine=function(e){Phaser.Sprite.call(this,e,320,480,"submarine");this.anchor.set(.5,.5);this.game=e;this.x=320;this.y=240;this.moveAngle=0;this.moveAngleNormal=-90;this.moveAngleStep=MOVE_SPEED;this.pivotX=this.x;this.pivotY=this.y-MOVE_CIRCLE_RADIUS;this.electroCount=0;this.slowdownCount=0;this.emitBubble=e.add.emitter(0,0,10);this.emitBubble.makeParticles("particles",[2]);this.emitBubble.setXSpeed(0,0);this.emitBubble.setYSpeed(0,0);this.emitBubble.setRotation(0,0);this.emitBubble.setScale(1,.1,1,.1,2e3,Phaser.Easing.None);this.emitBubble.gravity=-50;this.emitBubble.start(false,800,200);this.mirror=e.add.sprite(0,0,"submarine");this.mirror.anchor.set(.5,.5);this.hitGroup=e.add.group();this.hitGroup.enableBody=true;this.hitGroup.physicsBodyType=Phaser.Physics.ARCADE;for(var t=0;t<3;t++){var n=e.add.sprite(0,0,null,0,this.hitGroup);n.body.setSize(32,32);n.anchor.setTo(.5,.5)}this.events.onKilled.add(this.onKilled,this);this.events.onRevived.add(this.onRevived,this)};Submarine.prototype=Object.create(Phaser.Sprite.prototype);Submarine.prototype.constructor=Submarine;Submarine.prototype.onKilled=function(){this.mirror.kill();this.emitBubble.on=false;for(var e=0;e<3;e++){this.hitGroup.children[e].kill()}};Submarine.prototype.onRevived=function(){this.x=320;this.y=240;this.moveAngle=270;this.moveAngleNormal=+90;this.moveAngleStep=-1*MOVE_SPEED;this.pivotX=this.x;this.pivotY=this.y+MOVE_CIRCLE_RADIUS;this.electroCount=0;this.slowdownCount=0;this.mirror.revive();this.emitBubble.on=true;for(var e=0;e<3;e++){this.hitGroup.children[e].reset(this.x,this.y);this.hitGroup.children[e].revive()}this.update()};Submarine.prototype.doTap=function(){this.pivotX=this.pivotX+Math.cos(2*Math.PI*this.moveAngle/360)*MOVE_CIRCLE_RADIUS*2;this.pivotY=this.pivotY+Math.sin(2*Math.PI*this.moveAngle/360)*MOVE_CIRCLE_RADIUS*2;if(this.pivotX>640){this.pivotX=this.pivotX-=640}if(this.pivotX<0){this.pivotX=this.pivotX+=640}this.moveAngle=this.moveAngle+180;this.moveAngleStep=-1*this.moveAngleStep;if(this.moveAngleStep>0){this.moveAngleNormal=-90}else{this.moveAngleNormal=90}};Submarine.prototype.update=function(){if(GLOBAL_PAUSE_FLAG==false){if(this.alive){var e=false;var t;var n;if(this.electroCount>0){e=true;if(this.electroCount<104){if(this.moveAngleStep>0){t=Math.cos(2*Math.PI*(this.moveAngle+90)/360)*PRECALC_SPEED;n=Math.sin(2*Math.PI*(this.moveAngle+90)/360)*PRECALC_SPEED}else{t=Math.cos(2*Math.PI*(this.moveAngle+270)/360)*PRECALC_SPEED;n=Math.sin(2*Math.PI*(this.moveAngle+270)/360)*PRECALC_SPEED}this.x+=t;this.y+=n;this.pivotX+=t;this.pivotY+=n}this.electroCount-=1}if(this.slowdownCount>0){this.slowdownCount-=1;e=this.slowdownCount%4!=0}if(e==false){this.moveAngle+=this.moveAngleStep;if(this.moveAngle<0){this.moveAngle+=360}if(this.moveAngle>=360){this.moveAngle-=360}this.x=this.pivotX+Math.cos(2*Math.PI*this.moveAngle/360)*MOVE_CIRCLE_RADIUS;this.y=this.pivotY+Math.sin(2*Math.PI*this.moveAngle/360)*MOVE_CIRCLE_RADIUS;this.rotation=2*Math.PI*((this.moveAngle+this.moveAngleNormal)/360)}if(this.x>640){this.x=this.x-=640}if(this.x<0){this.x=this.x+=640}if(this.y>960-MARGIN_TOPBOTTOM){this.pivotY=this.pivotY-(this.y-960+MARGIN_TOPBOTTOM);this.y=960-MARGIN_TOPBOTTOM}if(this.y<MARGIN_TOPBOTTOM){this.pivotY=this.pivotY+(MARGIN_TOPBOTTOM-this.y);this.y=MARGIN_TOPBOTTOM}if(this.x>320){this.mirror.x=this.x-640}else{this.mirror.x=this.x+640}this.mirror.y=this.y;this.mirror.rotation=this.rotation;this.hitGroup.children[0].x=this.x+Math.cos(2*Math.PI*this.angle/360)*HIT_SPR_DIAMETER*2;this.hitGroup.children[0].y=this.y+Math.sin(2*Math.PI*this.angle/360)*HIT_SPR_DIAMETER*2;this.hitGroup.children[1].x=this.x;this.hitGroup.children[1].y=this.y;this.hitGroup.children[2].x=this.x+Math.cos(2*Math.PI*(this.angle+180)/360)*HIT_SPR_DIAMETER*2;this.hitGroup.children[2].y=this.y+Math.sin(2*Math.PI*(this.angle+180)/360)*HIT_SPR_DIAMETER*2;for(var r=0;r<3;r++){if(this.hitGroup.children[r].x>640){this.hitGroup.children[r].x=this.hitGroup.children[r].x-=640}if(this.hitGroup.children[r].x<0){this.hitGroup.children[r].x=this.hitGroup.children[r].x+=640}}this.emitBubble.x=this.hitGroup.children[0].x;this.emitBubble.y=this.hitGroup.children[0].y}}};var OBJ_COIN=0;var OBJ_RUBY=1;var OBJ_STARFISH=2;var OBJ_SQUID=3;var OBJ_STINGRAY=4;var OBJ_MINE=5;var OBJ_TREASURE=6;var GAMEOBJ_SPEED=2;var GameObj=function(e,t,n){Phaser.Sprite.call(this,e,t,n,"gameobjs");this.anchor.set(.5,.5);this.ObjType=0;this.MoveType=0;this.xSpeed=0;this.ySpeed=0;this.xPivot=0;this.yPivot=0;this.Radius=null;this.Angle=null;e.physics.enable(this,Phaser.Physics.ARCADE);this.animations.add("coin",[0,1,2,3,4,5,6,7],10,true);this.animations.add("ruby",[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,13,12,10,9],10,true);this.animations.add("starfish",[16,17,18,19,20,21,22,23],10,true);this.animations.add("squid",[24,25,26,27,28,29,30,31],10,true);this.animations.add("stingray",[32,33,34,35,36,37,38,39,39,38,37,36,35,34,33,32],10,true);this.animations.add("mine",[40,41,42,43,44,45,46,47],15,true);this.animations.add("treasure",[63],10,true)};GameObj.prototype=Object.create(Phaser.Sprite.prototype);GameObj.prototype.constructor=GameObj;GameObj.prototype.init=function(e,t,n,r,i,s,o){this.reset(t,n);this.MoveType=0;this.xSpeed=0;this.ySpeed=0;this.xPivot=0;this.yPivot=0;this.Radius=null;this.Angle=null;this.body.enable=true;this.animations.stop(null,true);if(CHEAT_RUBY==true){if(e=="coin"){e="ruby"}else if(e=="ruby"){e="coin"}}switch(e){case"ruby":this.ObjType=OBJ_RUBY;this.play("ruby",15,true,false);break;case"star":this.ObjType=OBJ_STARFISH;this.play("starfish",15,true,false);break;case"stingray":this.ObjType=OBJ_STINGRAY;this.play("stingray",15,true,false);break;case"squid":this.ObjType=OBJ_SQUID;this.play("squid",15,true,false);break;case"mine":this.ObjType=OBJ_MINE;this.play("mine",15,true,false);break;case"treasure":this.ObjType=OBJ_TREASURE;this.play("treasure",15,true,false);break;default:this.ObjType=OBJ_COIN;this.play("coin",15,true,false);break}this.animations.next(o);switch(r){case"rand":this.MoveType=1;this.xSpeed=GAMEOBJ_SPEED;this.ySpeed=GAMEOBJ_SPEED;break;case"horz":this.MoveType=2;this.xSpeed=GAMEOBJ_SPEED;break;case"vert":this.MoveType=3;this.ySpeed=GAMEOBJ_SPEED;break;case"circ":this.MoveType=4;this.xPivot=this.x;this.yPivot=this.y;this.Radius=i;this.Angle=s;break;case"cirh":this.MoveType=5;this.xPivot=this.x;this.Radius=i;this.Angle=s;break;case"cirv":this.MoveType=6;this.yPivot=this.y;this.Radius=i;this.Angle=s;break;default:this.MoveType=0;break}};GameObj.prototype.update=function(){if(GLOBAL_PAUSE_FLAG==false){if(this.alive){if(uboat._levelstate==STATE_PLAYING){this.y=this.y+SCROLL_SPEED;this.yPivot=this.yPivot+SCROLL_SPEED}switch(this.MoveType){case 1:this.x=this.x+this.xSpeed;this.y=this.y+this.ySpeed;break;case 2:this.x=this.x+this.xSpeed;break;case 3:this.y=this.y+this.ySpeed;break;case 4:this.x=this.xPivot+Math.cos(2*Math.PI*this.Angle/360)*this.Radius;this.y=this.yPivot+Math.sin(2*Math.PI*this.Angle/360)*this.Radius;break;case 5:this.x=this.xPivot+Math.cos(2*Math.PI*this.Angle/360)*this.Radius;break;case 6:this.y=this.yPivot+Math.sin(2*Math.PI*this.Angle/360)*this.Radius;break}if(this.MoveType>0){if(this.MoveType<4){if(this.x<0||this.x>640-64){this.xSpeed=-1*this.xSpeed}if(this.y<0||this.y>960-64){this.ySpeed=-1*this.ySpeed}}else{this.Angle=this.Angle+.5}}}}};uboat.Tutorial=function(e){this.game=e;this._txtselect=null;this._btnMore=null;this._btnBack=null;this._angleStep=2;this._angleSubmarine=0;this._arrows=[];this._indexScreen=-1;this._tutorialFull=true};uboat.Tutorial.prototype={create:function(){this.add.sprite(0,0,"background");this._backobjsGroup=[];backgroundCreateBubbles(this.game,this._backobjsGroup);this.game.add.bitmapText(148,8,"myfont","How to play",64);if(this._tutorialFull==true){this._btnMore=new MyLabelButton(this.game,200,960-140,"button","More",this.doBtnMore,this,1,0,2);this._btnBack=this.game.add.button(0,800,"buttonicon",this.doBtnBack,this,4,0,8)}else{this._btnPlay=new MyLabelButton(this.game,160,960+140,"button","Got it!",this.doBtnPlay,this,1,0,2);this.game.add.tween(this._btnPlay).to({y:960-140},1e3,Phaser.Easing.Back.Out,true,2e3)}this._grp1=this.game.add.group();var e=this.game.add.bitmapText(24,120,"myfont","Tap anywhere on screen\nto rotate the submarine\nin the other direction.",48);e.align="center";e.makeCentered(320);this._dummySubmarine=this.game.add.sprite(440,560,"submarine");this._handIcon=this.game.add.sprite(184+20,600+40,"tutorialicons",0);this._tapIcon=this.game.add.sprite(184-38,600-45,"tutorialicons",1);this._tapIcon.alpha=0;this._dummySubmarine.anchor.setTo(.5,.5);this._handIcon.anchor.setTo(.5,.5);this._tapIcon.anchor.setTo(.5,.5);this._grp1.add(e);this._grp1.add(this._dummySubmarine);this._grp1.add(this._handIcon);this._grp1.add(this._tapIcon);for(var t=0;t<6;t++){this._arrows[t]=this.game.add.sprite(440,560,"tutorialicons",2);this._arrows[t].anchor.setTo(.5,.5);this._grp1.add(this._arrows[t])}this._grp1.x=-640;if(this._tutorialFull==true){this._grp2=this.game.add.group();var n=this.game.add.bitmapText(148,120,"myfont","Complete each level by\ncollecting the treasure\nat the bottom of the ocean.\nCollect all coins and rubies\nto earn additional stars.",48);n.align="center";n.makeCentered(320);var r=this.game.add.sprite(148,460,"gameobjs");r.frame=63;var i=this.game.add.bitmapText(240,460,"myfont","Treasure",48);var s=this.game.add.sprite(148,460+112,"gameobjs");s.animations.add("loop",[0,1,2,3,4,5,6,7],10,true,true);s.animations.play("loop");var o=this.game.add.bitmapText(240,460+112,"myfont","Coin",48);var u=this.game.add.sprite(148,460+224,"gameobjs");u.animations.add("loop",[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,13,12,10,9],10,true,true);u.animations.play("loop");var a=this.game.add.bitmapText(240,460+224,"myfont","Ruby",48);this._grp2.add(n);this._grp2.add(i);this._grp2.add(o);this._grp2.add(a);this._grp2.add(r);this._grp2.add(s);this._grp2.add(u);this._grp2.x=-640;this._grp3=this.game.add.group();var f=this.game.add.bitmapText(148,120,"myfont","Warning, beware of the\nfollowing obstacles",48);f.align="center";f.makeCentered(320);var l=this.game.add.sprite(148,288,"gameobjs");l.animations.add("loop",[40,41,42,43,44,45,46,47],15,true,true);l.animations.play("loop");var c=this.game.add.bitmapText(240,288,"myfont","Danger, avoid!",48);var h=this.game.add.sprite(148,288+128,"gameobjs");h.animations.add("loop",[24,25,26,27,28,29,30,31],10,true,true);h.animations.play("loop");var p=this.game.add.bitmapText(240,288+128,"myfont","Ink blocks view",48);var d=this.game.add.sprite(148,288+256,"gameobjs");d.animations.add("loop",[32,33,34,35,36,37,38,39,39,38,37,36,35,34,33,32],10,true,true);d.animations.play("loop");var v=this.game.add.bitmapText(240,288+256,"myfont","Locks controls",48);var m=this.game.add.sprite(148,288+384,"gameobjs");m.animations.add("loop",[16,17,18,19,20,21,22,23],10,true,true);m.animations.play("loop");var g=this.game.add.bitmapText(240,288+384,"myfont","Slows you down",48);this._grp3.add(f);this._grp3.add(c);this._grp3.add(p);this._grp3.add(v);this._grp3.add(g);this._grp3.add(l);this._grp3.add(h);this._grp3.add(d);this._grp3.add(m);this._grp3.add(f);this._grp3.x=-640}this.soundGuiButton=this.game.add.audio("gui_button");this.soundGuiBack=this.game.add.audio("gui_back");this._indexScreen=-1;backgroundFadeIn(this.game,true);this.switchNextScreen();this.onHandIconIsUp();this._tutorialFull=true},update:function(){backgroundUpdateBubbles(this.game,this._backobjsGroup);if(this._indexScreen==0){this._angleSubmarine+=this._angleStep;if(this._angleSubmarine<0){this._angleSubmarine+=360}if(this._angleSubmarine>=360){this._angleSubmarine-=360}this._dummySubmarine.rotation=2*Math.PI*(this._angleSubmarine/360);var e=100;var t=+90;if(this._angleStep>0){t=-90}for(var n=0;n<6;n++){var r=this._angleSubmarine+n*60;this._arrows[n].rotation=2*Math.PI*((r+t)/360);this._arrows[n].x=440+Math.cos(2*Math.PI*r/360)*e;this._arrows[n].y=560+Math.sin(2*Math.PI*r/360)*e}}},doBtnMore:function(){this.soundGuiButton.play();this.switchNextScreen()},doBtnBack:function(){this.soundGuiBack.play();var e=backgroundFadeIn(this.game,false);e.onComplete.add(function(){this.state.start("MainMenu")},this)},doBtnPlay:function(){this.soundGuiButton.play();var e=backgroundFadeIn(this.game,false);e.onComplete.add(function(){this.state.start("Game")},this)},switchNextScreen:function(){this._indexScreen=(this._indexScreen+1)%3;switch(this._indexScreen){case 0:if(this._tutorialFull==true){this.game.add.tween(this._grp3).to({x:this._grp3.x-640},400,Phaser.Easing.Back.Out,true)}this._grp1.x=640;this.game.add.tween(this._grp1).to({x:this._grp1.x-640},400,Phaser.Easing.Back.Out,true);this._angleStep=2;this._angleSubmarine=0;break;case 1:this.game.add.tween(this._grp1).to({x:this._grp1.x-640},400,Phaser.Easing.Back.Out,true);this._grp2.x=640;this.game.add.tween(this._grp2).to({x:this._grp2.x-640},400,Phaser.Easing.Back.Out,true);break;case 2:this.game.add.tween(this._grp2).to({x:this._grp2.x-640},400,Phaser.Easing.Back.Out,true);this._grp3.x=640;this.game.add.tween(this._grp3).to({x:this._grp3.x-640},400,Phaser.Easing.Back.Out,true);break}},onHandIconIsUp:function(){var e=500+this.game.rnd.integerInRange(0,1500);var t=this.game.add.tween(this._handIcon).to({x:184,y:600},200,Phaser.Easing.Sinusoidal.Out,true,e);t.onComplete.add(this.onHandIconIsDown,this)},onHandIconIsDown:function(){this._angleStep=-1*this._angleStep;this._tapIcon.alpha=1;this._tapIcon.scale.x=.8;this._tapIcon.scale.y=.8;var e=this.game.add.tween(this._tapIcon.scale).to({x:1.2,y:1.2},200,Phaser.Easing.Sinusoidal.Out,true);this.game.add.tween(this._tapIcon).to({alpha:0},100,Phaser.Easing.Sinusoidal.Out,true,240);var t=this.game.add.tween(this._handIcon).to({x:184+20,y:600+40},400,Phaser.Easing.Sinusoidal.Out,true,500);t.onComplete.add(this.onHandIconIsUp,this)}};uboat.WinScreen=function(e){this.game=e;this._dummySubmarine=null;this._emitBubble=null;this._objGroup=null;this._objRotate=0};uboat.WinScreen.prototype={create:function(){console.log("uboat.WinScreen.create() -- was called..");this.add.sprite(0,0,"background");this._backobjsGroup=[];backgroundCreateBubbles(this.game,this._backobjsGroup);var e=this.game.add.bitmapText(148,48,"myfont","Congratulations!",72);var t=this.game.add.bitmapText(148,128+64,"myfont","You have completed all levels!",48);var n=this.game.add.bitmapText(148,128+128,"myfont","Thank you for playing.",48);e.alpha=0;t.alpha=0;n.alpha=0;e.makeCentered(320);t.makeCentered(320);n.makeCentered(320);this._btnClose=new MyLabelButton(this.game,160,960+128,"button","Ok",this.doBtnClose,this,1,0,2);this.game.add.tween(e).to({alpha:1},1e3,Phaser.Easing.Linear.None,true,200);this.game.add.tween(t).to({alpha:1},1e3,Phaser.Easing.Linear.None,true,1200);this.game.add.tween(n).to({alpha:1},1e3,Phaser.Easing.Linear.None,true,2200);this.game.add.tween(this._btnClose).to({y:960-128},1e3,Phaser.Easing.Back.Out,true,3200);this._dummySubmarine=this.game.add.sprite(320,560,"submarine");this._dummySubmarine.anchor.setTo(.5,.5);this._dummySubmarine.scale.x=-1;this._emitBubble=this.game.add.emitter(320-64,560+10,10);this._emitBubble.makeParticles("particles",[2]);this._emitBubble.setXSpeed(-260,-260);this._emitBubble.setYSpeed(0,0);this._emitBubble.setRotation(0,0);this._emitBubble.setScale(1,.1,1,.1,2e3,Phaser.Easing.None);this._emitBubble.gravity=0;this._emitBubble.start(false,800,200);this._objGroup=this.game.add.group();var r=0;for(var i=0;i<360;i=i+20){var s=new GameObj(this.game,0,0);if(r==0){s.animations.add("coin",[0,1,2,3,4,5,6,7],10,true);s.play("coin",15,true,false)}else if(r==1){s.animations.add("ruby",[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,13,12,10,9],10,true);s.play("ruby",15,true,false)}else{s.animations.add("treasure",[63],10,true);s.play("treasure",15,true,false)}this._objGroup.add(s);r=(r+1)%3}backgroundFadeIn(this.game,true)},update:function(){backgroundUpdateBubbles(this.game,this._backobjsGroup);var e=320;var t=560;var n=192;this._objRotate++;var r=this._objRotate;for(var i=0;i<this._objGroup.length;i++){this._objGroup.children[i].x=e+Math.cos(2*Math.PI*r/360)*n;this._objGroup.children[i].y=t+Math.sin(2*Math.PI*r/360)*n;r=r+20}},doBtnClose:function(){var e=backgroundFadeIn(this.game,false);e.onComplete.add(function(){this.state.start("LevelSelect")},this)}};var LevelData=[{comment:"level 1",parts:[{ysize:800,objs:[{objname:"coin",x:227,y:50},{objname:"coin",x:160,y:64},{objname:"coin",x:96,y:81},{objname:"coin",x:49,y:128},{objname:"coin",x:32,y:192},{objname:"ruby",x:49,y:256},{objname:"coin",x:96,y:303},{objname:"coin",x:160,y:320},{objname:"coin",x:224,y:303},{objname:"coin",x:297,y:279},{objname:"coin",x:369,y:256},{objname:"coin",x:416,y:209},{objname:"coin",x:480,y:192},{objname:"coin",x:544,y:209},{objname:"coin",x:591,y:256},{objname:"ruby",x:608,y:320},{objname:"coin",x:591,y:384},{objname:"coin",x:544,y:431},{objname:"coin",x:480,y:448},{objname:"coin",x:397,y:436},{objname:"coin",x:320,y:416},{objname:"coin",x:256,y:433},{objname:"coin",x:209,y:480},{objname:"coin",x:192,y:544},{objname:"coin",x:209,y:608},{objname:"coin",x:256,y:655},{objname:"coin",x:320,y:672},{objname:"coin",x:364,y:721},{objname:"ruby",x:370,y:786}]},{ysize:320,objs:[{objname:"treasure",x:320,y:256}]}]},{comment:"level 2",parts:[{ysize:320,objs:[{objname:"coin",x:320,y:160,movetype:"circ",radius:112,angle:270},{objname:"coin",x:320,y:160,movetype:"circ",radius:64,angle:300},{objname:"coin",x:320,y:160,movetype:"circ",radius:64,angle:0},{objname:"coin",x:320,y:160,movetype:"circ",radius:111,angle:30},{objname:"coin",x:320,y:160,movetype:"circ",radius:64,angle:60},{objname:"coin",x:320,y:160,movetype:"circ",radius:64,angle:120},{objname:"coin",x:320,y:160,movetype:"circ",radius:111,angle:150},{objname:"coin",x:320,y:160,movetype:"circ",radius:64,angle:180},{objname:"coin",x:320,y:160,movetype:"circ",radius:64,angle:240},{objname:"ruby",x:320,y:160},{objname:"mine",x:32,y:160},{objname:"mine",x:608,y:160}]},{ysize:640,objs:[{objname:"coin",x:256,y:208},{objname:"coin",x:320,y:208},{objname:"coin",x:384,y:208},{objname:"coin",x:416,y:264},{objname:"coin",x:448,y:320},{objname:"coin",x:416,y:376},{objname:"coin",x:384,y:432},{objname:"coin",x:320,y:432},{objname:"coin",x:256,y:432},{objname:"coin",x:224,y:376},{objname:"coin",x:192,y:320},{objname:"coin",x:224,y:264},{objname:"coin",x:288,y:264},{objname:"coin",x:352,y:264},{objname:"coin",x:384,y:320},{objname:"coin",x:352,y:376},{objname:"coin",x:288,y:376},{objname:"coin",x:256,y:320},{objname:"ruby",x:320,y:320},{objname:"mine",x:320,y:608},{objname:"mine",x:32,y:320},{objname:"mine",x:320,y:32},{objname:"mine",x:608,y:320}]},{ysize:480,objs:[{objname:"coin",x:320,y:240,movetype:"circ",radius:112,angle:270},{objname:"coin",x:320,y:240,movetype:"circ",radius:64,angle:300},{objname:"coin",x:320,y:240,movetype:"circ",radius:64,angle:0},{objname:"coin",x:320,y:240,movetype:"circ",radius:111,angle:30},{objname:"coin",x:320,y:240,movetype:"circ",radius:64,angle:60},{objname:"coin",x:320,y:240,movetype:"circ",radius:64,angle:120},{objname:"coin",x:320,y:240,movetype:"circ",radius:111,angle:150},{objname:"coin",x:320,y:240,movetype:"circ",radius:64,angle:180},{objname:"coin",x:320,y:240,movetype:"circ",radius:64,angle:240},{objname:"ruby",x:320,y:240}]},{ysize:320,objs:[{objname:"treasure",x:320,y:256}]}]},{comment:"level 3",parts:[{ysize:640,objs:[{objname:"mine",x:320,y:94},{objname:"coin",x:433,y:207},{objname:"mine",x:546,y:320},{objname:"coin",x:207,y:207},{objname:"ruby",x:320,y:320},{objname:"coin",x:433,y:433},{objname:"mine",x:94,y:320},{objname:"coin",x:207,y:433},{objname:"mine",x:320,y:546}]},{ysize:480,objs:[{objname:"coin",x:464,y:240},{objname:"coin",x:422,y:342},{objname:"coin",x:320,y:384},{objname:"coin",x:218,y:342},{objname:"coin",x:176,y:240},{objname:"coin",x:218,y:138},{objname:"coin",x:320,y:96},{objname:"coin",x:422,y:138},{objname:"squid",x:560,y:240},{objname:"squid",x:552,y:302},{objname:"squid",x:528,y:360},{objname:"squid",x:490,y:410},{objname:"squid",x:150,y:410},{objname:"squid",x:112,y:360},{objname:"squid",x:88,y:302},{objname:"squid",x:80,y:240},{objname:"squid",x:88,y:178},{objname:"squid",x:112,y:120},{objname:"squid",x:150,y:70},{objname:"squid",x:490,y:70},{objname:"squid",x:528,y:120},{objname:"squid",x:552,y:178},{objname:"ruby",x:320,y:240}]},{ysize:640,objs:[{objname:"mine",x:316,y:323,movetype:"circ",radius:272,angle:225},{objname:"coin",x:316,y:323,movetype:"circ",radius:202,angle:252},{objname:"coin",x:316,y:323,movetype:"circ",radius:202,angle:288},{objname:"mine",x:316,y:323,movetype:"circ",radius:272,angle:315},{objname:"coin",x:316,y:323,movetype:"circ",radius:202,angle:198},{objname:"coin",x:316,y:323,movetype:"circ",radius:91,angle:225},{objname:"coin",x:316,y:323,movetype:"circ",radius:91,angle:315},{objname:"coin",x:316,y:323,movetype:"circ",radius:202,angle:342},{objname:"ruby",x:320,y:320},{objname:"coin",x:316,y:323,movetype:"circ",radius:202,angle:162},{objname:"coin",x:316,y:323,movetype:"circ",radius:91,angle:135},{objname:"coin",x:316,y:323,movetype:"circ",radius:91,angle:45},{objname:"coin",x:316,y:323,movetype:"circ",radius:202,angle:18},{objname:"mine",x:316,y:323,movetype:"circ",radius:272,angle:135},{objname:"coin",x:316,y:323,movetype:"circ",radius:202,angle:108},{objname:"coin",x:316,y:323,movetype:"circ",radius:202,angle:72},{objname:"mine",x:316,y:323,movetype:"circ",radius:272,angle:45}]},{ysize:256,objs:[{objname:"treasure",x:320,y:192}]}]},{comment:"level 4",parts:[{ysize:440,objs:[{objname:"stingray",x:106,y:80,movetype:"cirh",radius:60,angle:0},{objname:"stingray",x:320,y:80,movetype:"cirh",radius:60,angle:10},{objname:"stingray",x:534,y:80,movetype:"cirh",radius:60,angle:20},{objname:"mine",x:106,y:240,movetype:"cirh",radius:60,angle:30},{objname:"mine",x:320,y:240,movetype:"cirh",radius:60,angle:40},{objname:"mine",x:534,y:240,movetype:"cirh",radius:60,angle:50}]},{ysize:540,objs:[{objname:"coin",x:32,y:207},{objname:"coin",x:96,y:207},{objname:"coin",x:160,y:207},{objname:"coin",x:224,y:207},{objname:"coin",x:288,y:207},{objname:"coin",x:352,y:207},{objname:"coin",x:416,y:207},{objname:"coin",x:480,y:207},{objname:"coin",x:544,y:207},{objname:"coin",x:608,y:207},{objname:"coin",x:96,y:271},{objname:"coin",x:160,y:271},{objname:"coin",x:224,y:271},{objname:"coin",x:288,y:271},{objname:"coin",x:352,y:271},{objname:"coin",x:416,y:271},{objname:"coin",x:480,y:271},{objname:"coin",x:544,y:271},{objname:"coin",x:608,y:271},{objname:"coin",x:96,y:335},{objname:"coin",x:160,y:335},{objname:"coin",x:224,y:335},{objname:"coin",x:288,y:335},{objname:"coin",x:352,y:335},{objname:"coin",x:416,y:335},{objname:"coin",x:480,y:335},{objname:"coin",x:544,y:335},{objname:"coin",x:608,y:335},{objname:"stingray",x:32,y:49},{objname:"stingray",x:320,y:49},{objname:"stingray",x:608,y:49},{objname:"stingray",x:32,y:481},{objname:"stingray",x:320,y:481},{objname:"coin",x:32,y:271},{objname:"coin",x:32,y:335},{objname:"stingray",x:608,y:481}]},{ysize:640,objs:[{objname:"coin",x:320,y:320,movetype:"circ",radius:252,angle:270},{objname:"coin",x:320,y:320,movetype:"circ",radius:182,angle:258},{objname:"coin",x:320,y:320,movetype:"circ",radius:126,angle:234},{objname:"coin",x:320,y:320,movetype:"circ",radius:180,angle:210},{objname:"coin",x:320,y:320,movetype:"circ",radius:252,angle:198},{objname:"coin",x:320,y:320,movetype:"circ",radius:180,angle:186},{objname:"coin",x:320,y:320,movetype:"circ",radius:126,angle:162},{objname:"coin",x:320,y:320,movetype:"circ",radius:181,angle:138},{objname:"coin",x:320,y:320,movetype:"circ",radius:252,angle:126},{objname:"coin",x:320,y:320,movetype:"circ",radius:181,angle:114},{objname:"coin",x:320,y:320,movetype:"circ",radius:126,angle:90},{objname:"coin",x:320,y:320,movetype:"circ",radius:181,angle:66},{objname:"coin",x:320,y:320,movetype:"circ",radius:252,angle:54},{objname:"coin",x:320,y:320,movetype:"circ",radius:181,angle:42},{objname:"coin",x:320,y:320,movetype:"circ",radius:126,angle:18},{objname:"coin",x:320,y:320,movetype:"circ",radius:179,angle:354},{objname:"coin",x:320,y:320,movetype:"circ",radius:251,angle:342},{objname:"coin",x:320,y:320,movetype:"circ",radius:180,angle:330},{objname:"coin",x:320,y:320,movetype:"circ",radius:125,angle:306},{objname:"coin",x:320,y:320,movetype:"circ",radius:182,angle:281}]},{ysize:448,objs:[{objname:"star",x:160,y:64},{objname:"star",x:224,y:64},{objname:"star",x:288,y:64},{objname:"star",x:352,y:64},{objname:"star",x:416,y:64},{objname:"star",x:480,y:64},{objname:"star",x:160,y:128},{objname:"star",x:224,y:128},{objname:"coin",x:288,y:128},{objname:"coin",x:352,y:128},{objname:"star",x:416,y:128},{objname:"star",x:480,y:128},{objname:"star",x:160,y:192},{objname:"coin",x:224,y:192},{objname:"ruby",x:288,y:192},{objname:"ruby",x:352,y:192},{objname:"coin",x:416,y:192},{objname:"star",x:480,y:192},{objname:"star",x:160,y:256},{objname:"coin",x:224,y:256},{objname:"ruby",x:288,y:256},{objname:"ruby",x:352,y:256},{objname:"coin",x:416,y:256},{objname:"star",x:480,y:256},{objname:"star",x:160,y:320},{objname:"star",x:224,y:320},{objname:"coin",x:288,y:320},{objname:"coin",x:352,y:320},{objname:"star",x:416,y:320},{objname:"star",x:480,y:320},{objname:"star",x:160,y:384},{objname:"star",x:224,y:384},{objname:"star",x:288,y:384},{objname:"star",x:352,y:384},{objname:"star",x:416,y:384},{objname:"star",x:480,y:384}]},{ysize:256,objs:[{objname:"treasure",x:320,y:192}]}]},{comment:"level 5",parts:[{ysize:360,objs:[{objname:"coin",x:200,y:300},{objname:"coin",x:115,y:265},{objname:"coin",x:80,y:180},{objname:"coin",x:115,y:95},{objname:"coin",x:200,y:60},{objname:"coin",x:285,y:95},{objname:"coin",x:320,y:180},{objname:"coin",x:355,y:265},{objname:"coin",x:440,y:300},{objname:"coin",x:525,y:265},{objname:"coin",x:560,y:180},{objname:"coin",x:525,y:95},{objname:"coin",x:440,y:60},{objname:"mine",x:200,y:180},{objname:"mine",x:440,y:180}]},{ysize:640,objs:[{objname:"coin",x:160,y:80},{objname:"coin",x:240,y:160},{objname:"coin",x:320,y:240},{objname:"coin",x:400,y:320},{objname:"coin",x:480,y:400},{objname:"coin",x:560,y:480},{objname:"coin",x:80,y:160},{objname:"coin",x:160,y:240},{objname:"coin",x:240,y:320},{objname:"coin",x:320,y:400},{objname:"coin",x:400,y:480},{objname:"coin",x:480,y:560},{objname:"mine",x:160,y:160},{objname:"mine",x:320,y:320},{objname:"mine",x:480,y:480}]},{ysize:600,objs:[{objname:"coin",x:320,y:180},{objname:"coin",x:285,y:95},{objname:"coin",x:200,y:60},{objname:"coin",x:115,y:95},{objname:"coin",x:80,y:180},{objname:"coin",x:115,y:265},{objname:"coin",x:200,y:300},{objname:"coin",x:115,y:335},{objname:"coin",x:80,y:420},{objname:"coin",x:115,y:505},{objname:"coin",x:200,y:540},{objname:"coin",x:285,y:505},{objname:"coin",x:320,y:420},{objname:"coin",x:355,y:505},{objname:"coin",x:440,y:540},{objname:"coin",x:525,y:505},{objname:"coin",x:560,y:420},{objname:"coin",x:525,y:335},{objname:"coin",x:440,y:300},{objname:"coin",x:525,y:265},{objname:"coin",x:560,y:180},{objname:"coin",x:525,y:95},{objname:"coin",x:440,y:60},{objname:"coin",x:355,y:95},{objname:"coin",x:285,y:265},{objname:"coin",x:355,y:265},{objname:"coin",x:285,y:335},{objname:"coin",x:355,y:335},{objname:"mine",x:200,y:180},{objname:"mine",x:440,y:180},{objname:"mine",x:200,y:420},{objname:"mine",x:440,y:420}]},{ysize:256,objs:[{objname:"ruby",x:160,y:128},{objname:"ruby",x:320,y:128},{objname:"ruby",x:480,y:128}]},{ysize:256,objs:[{objname:"treasure",x:320,y:192}]}]},{comment:"level 6",parts:[{ysize:440,objs:[{objname:"coin",x:440,y:220,movetype:"circ",radius:45,angle:0},{objname:"coin",x:405,y:305,movetype:"circ",radius:45,angle:45},{objname:"coin",x:320,y:340,movetype:"circ",radius:45,angle:90},{objname:"coin",x:235,y:305,movetype:"circ",radius:45,angle:135},{objname:"coin",x:200,y:220,movetype:"circ",radius:45,angle:180},{objname:"coin",x:235,y:135,movetype:"circ",radius:45,angle:225},{objname:"coin",x:320,y:100,movetype:"circ",radius:45,angle:270},{objname:"coin",x:405,y:135,movetype:"circ",radius:45,angle:315},{objname:"mine",x:32,y:220},{objname:"mine",x:320,y:220},{objname:"mine",x:608,y:220}]},{ysize:440,objs:[{objname:"coin",x:440,y:220,movetype:"circ",radius:45,angle:0},{objname:"coin",x:440,y:220,movetype:"circ",radius:45,angle:45},{objname:"coin",x:440,y:220,movetype:"circ",radius:45,angle:90},{objname:"coin",x:405,y:305,movetype:"circ",radius:45,angle:45},{objname:"coin",x:405,y:305,movetype:"circ",radius:45,angle:90},{objname:"coin",x:405,y:305,movetype:"circ",radius:45,angle:135},{objname:"coin",x:320,y:340,movetype:"circ",radius:45,angle:90},{objname:"coin",x:320,y:340,movetype:"circ",radius:45,angle:135},{objname:"coin",x:320,y:340,movetype:"circ",radius:45,angle:180},{objname:"coin",x:235,y:305,movetype:"circ",radius:45,angle:135},{objname:"coin",x:235,y:305,movetype:"circ",radius:45,angle:180},{objname:"coin",x:235,y:305,movetype:"circ",radius:45,angle:225},{objname:"coin",x:200,y:220,movetype:"circ",radius:45,angle:180},{objname:"coin",x:200,y:220,movetype:"circ",radius:45,angle:225},{objname:"coin",x:200,y:220,movetype:"circ",radius:45,angle:270},{objname:"coin",x:235,y:135,movetype:"circ",radius:45,angle:225},{objname:"coin",x:235,y:135,movetype:"circ",radius:45,angle:270},{objname:"coin",x:235,y:135,movetype:"circ",radius:45,angle:315},{objname:"coin",x:320,y:100,movetype:"circ",radius:45,angle:270},{objname:"coin",x:320,y:100,movetype:"circ",radius:45,angle:315},{objname:"coin",x:320,y:100,movetype:"circ",radius:45,angle:0},{objname:"coin",x:405,y:135,movetype:"circ",radius:45,angle:315},{objname:"coin",x:405,y:135,movetype:"circ",radius:45,angle:0},{objname:"coin",x:405,y:135,movetype:"circ",radius:45,angle:45},{objname:"mine",x:32,y:220},{objname:"mine",x:320,y:220},{objname:"mine",x:608,y:220}]},{ysize:440,objs:[{objname:"mine",x:176,y:220},{objname:"coin",x:280,y:220,movetype:"circ",radius:40,angle:0},{objname:"coin",x:250,y:294,movetype:"circ",radius:40,angle:45},{objname:"coin",x:176,y:324,movetype:"circ",radius:40,angle:90},{objname:"coin",x:102,y:294,movetype:"circ",radius:40,angle:135},{objname:"coin",x:72,y:220,movetype:"circ",radius:40,angle:180},{objname:"coin",x:102,y:146,movetype:"circ",radius:40,angle:225},{objname:"coin",x:176,y:116,movetype:"circ",radius:40,angle:270},{objname:"coin",x:250,y:146,movetype:"circ",radius:40,angle:315},{objname:"mine",x:464,y:220},{objname:"coin",x:568,y:220,movetype:"circ",radius:40,angle:0},{objname:"coin",x:538,y:294,movetype:"circ",radius:40,angle:45},{objname:"coin",x:464,y:324,movetype:"circ",radius:40,angle:90},{objname:"coin",x:390,y:294,movetype:"circ",radius:40,angle:135},{objname:"coin",x:360,y:220,movetype:"circ",radius:40,angle:180},{objname:"coin",x:390,y:146,movetype:"circ",radius:40,angle:225},{objname:"coin",x:464,y:116,movetype:"circ",radius:40,angle:270},{objname:"coin",x:538,y:146,movetype:"circ",radius:40,angle:315}]},{ysize:256,objs:[{objname:"ruby",x:160,y:128},{objname:"ruby",x:320,y:128},{objname:"ruby",x:480,y:128}]},{ysize:256,objs:[{objname:"treasure",x:320,y:192}]}]},{comment:"level 7",parts:[{ysize:640,objs:[{objname:"coin",x:320,y:352,movetype:"circ",radius:261,angle:270},{objname:"coin",x:320,y:352,movetype:"circ",radius:207,angle:261},{objname:"coin",x:320,y:352,movetype:"circ",radius:207,angle:279},{objname:"coin",x:320,y:352,movetype:"circ",radius:162,angle:247},{objname:"ruby",x:320,y:352,movetype:"circ",radius:149,angle:270},{objname:"coin",x:320,y:352,movetype:"circ",radius:162,angle:293},{objname:"coin",x:320,y:352,movetype:"circ",radius:134,angle:224},{objname:"coin",x:320,y:352,movetype:"circ",radius:98,angle:251},{objname:"coin",x:320,y:352,movetype:"circ",radius:98,angle:289},{objname:"coin",x:320,y:352,movetype:"circ",radius:134,angle:316},{objname:"coin",x:320,y:352,movetype:"circ",radius:133,angle:196},{objname:"coin",x:320,y:352,movetype:"circ",radius:133,angle:344},{objname:"coin",x:320,y:352,movetype:"circ",radius:161,angle:173},{objname:"coin",x:320,y:352,movetype:"circ",radius:98,angle:169},{objname:"coin",x:320,y:352,movetype:"circ",radius:161,angle:7},{objname:"coin",x:320,y:352,movetype:"circ",radius:206,angle:159},{objname:"ruby",x:320,y:352,movetype:"circ",radius:148,angle:150},{objname:"coin",x:320,y:352,movetype:"circ",radius:99,angle:130},{objname:"ruby",x:320,y:352,movetype:"circ",radius:148,angle:30},{objname:"coin",x:320,y:352,movetype:"circ",radius:206,angle:21},{objname:"coin",x:320,y:352,movetype:"circ",radius:259,angle:150},{objname:"coin",x:320,y:352,movetype:"circ",radius:207,angle:141},{objname:"coin",x:320,y:352,movetype:"circ",radius:162,angle:126},{objname:"coin",x:320,y:352,movetype:"circ",radius:135,angle:104},{objname:"coin",x:320,y:352,movetype:"circ",radius:162,angle:54},{objname:"coin",x:320,y:352,movetype:"circ",radius:207,angle:39},{objname:"coin",x:320,y:352,movetype:"circ",radius:259,angle:30},{objname:"coin",x:320,y:352,movetype:"circ",radius:98,angle:11},{objname:"coin",x:320,y:352,movetype:"circ",radius:99,angle:50},{objname:"coin",x:320,y:352,movetype:"circ",radius:135,angle:76},{objname:"ruby",x:320,y:352}]},{ysize:728,objs:[{objname:"coin",x:192,y:140},{objname:"coin",x:256,y:140},{objname:"coin",x:320,y:140},{objname:"coin",x:384,y:140},{objname:"coin",x:448,y:140},{objname:"coin",x:480,y:196},{objname:"coin",x:512,y:252},{objname:"coin",x:544,y:308},{objname:"coin",x:160,y:196},{objname:"coin",x:224,y:196},{objname:"coin",x:288,y:196},{objname:"coin",x:352,y:196},{objname:"coin",x:416,y:196},{objname:"coin",x:448,y:252},{objname:"coin",x:480,y:308},{objname:"coin",x:512,y:364},{objname:"coin",x:128,y:252},{objname:"coin",x:192,y:252},{objname:"coin",x:256,y:252},{objname:"coin",x:320,y:252},{objname:"coin",x:384,y:252},{objname:"coin",x:416,y:308},{objname:"coin",x:448,y:364},{objname:"coin",x:480,y:420},{objname:"coin",x:96,y:308},{objname:"coin",x:160,y:308},{objname:"coin",x:224,y:308},{objname:"coin",x:224,y:420},{objname:"coin",x:256,y:476},{objname:"coin",x:320,y:476},{objname:"coin",x:384,y:476},{objname:"coin",x:416,y:532},{objname:"coin",x:64,y:364},{objname:"coin",x:128,y:364},{objname:"coin",x:192,y:364},{objname:"coin",x:192,y:476},{objname:"coin",x:224,y:532},{objname:"coin",x:288,y:532},{objname:"coin",x:352,y:532},{objname:"coin",x:384,y:588},{objname:"coin",x:576,y:364},{objname:"coin",x:96,y:420},{objname:"coin",x:160,y:420},{objname:"coin",x:160,y:532},{objname:"coin",x:192,y:588},{objname:"coin",x:256,y:588},{objname:"coin",x:320,y:588},{objname:"coin",x:448,y:476},{objname:"coin",x:512,y:476},{objname:"mine",x:320,y:32},{objname:"coin",x:128,y:476},{objname:"mine",x:608,y:530},{objname:"mine",x:32,y:198},{objname:"mine",x:32,y:530},{objname:"coin",x:416,y:420},{objname:"mine",x:320,y:696},{objname:"coin",x:544,y:420},{objname:"coin",x:480,y:532},{objname:"coin",x:448,y:588},{objname:"mine",x:608,y:198},{objname:"mine",x:320,y:364}]},{ysize:256,objs:[{objname:"ruby",x:160,y:128},{objname:"ruby",x:320,y:128},{objname:"ruby",x:480,y:128}]},{ysize:256,objs:[{objname:"treasure",x:320,y:192}]}]},{comment:"level 8",parts:[{ysize:640,objs:[{objname:"coin",x:279,y:250},{objname:"coin",x:360,y:250},{objname:"coin",x:240,y:320},{objname:"ruby",x:320,y:320},{objname:"coin",x:400,y:320},{objname:"coin",x:280,y:389},{objname:"coin",x:360,y:389},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:180},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:200},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:220},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:240},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:260},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:280},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:300},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:0},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:20},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:40},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:60},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:80},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:100},{objname:"mine",x:320,y:320,movetype:"circ",radius:280,angle:120}]},{ysize:400,objs:[{objname:"coin",x:49,y:137},{objname:"coin",x:61,y:106},{objname:"coin",x:91,y:92},{objname:"coin",x:121,y:106},{objname:"coin",x:135,y:136},{objname:"coin",x:133,y:167},{objname:"coin",x:119,y:197},{objname:"coin",x:99,y:223},{objname:"coin",x:79,y:249},{objname:"coin",x:60,y:276},{objname:"coin",x:48,y:307},{objname:"coin",x:80,y:307},{objname:"coin",x:112,y:307},{objname:"coin",x:144,y:307},{objname:"coin",x:274,y:108},{objname:"coin",x:285,y:138},{objname:"coin",x:287,y:170},{objname:"coin",x:289,y:200},{objname:"coin",x:287,y:229},{objname:"coin",x:285,y:261},{objname:"coin",x:274,y:291},{objname:"coin",x:245,y:307},{objname:"coin",x:216,y:291},{objname:"coin",x:205,y:261},{objname:"coin",x:203,y:229},{objname:"coin",x:201,y:200},{objname:"coin",x:203,y:170},{objname:"coin",x:205,y:138},{objname:"coin",x:216,y:108},{objname:"coin",x:245,y:92},{objname:"coin",x:367,y:142},{objname:"coin",x:388,y:116},{objname:"coin",x:409,y:92},{objname:"coin",x:409,y:123},{objname:"coin",x:409,y:154},{objname:"coin",x:409,y:184},{objname:"coin",x:409,y:215},{objname:"coin",x:409,y:246},{objname:"coin",x:409,y:276},{objname:"coin",x:409,y:307},{objname:"coin",x:572,y:307},{objname:"coin",x:572,y:277},{objname:"coin",x:572,y:246},{objname:"coin",x:572,y:215},{objname:"coin",x:572,y:184},{objname:"coin",x:572,y:154},{objname:"coin",x:572,y:123},{objname:"coin",x:572,y:92},{objname:"coin",x:557,y:123},{objname:"coin",x:539,y:154},{objname:"coin",x:521,y:184},{objname:"coin",x:503,y:215},{objname:"coin",x:487,y:246},{objname:"coin",x:540,y:246},{objname:"coin",x:604,y:246}]},{ysize:256,objs:[{objname:"treasure",x:320,y:192}]}]},{comment:"level 9",parts:[{ysize:544,objs:[{objname:"mine",x:32,y:128},{objname:"mine",x:104,y:128},{objname:"mine",x:176,y:128},{objname:"mine",x:248,y:128},{objname:"mine",x:320,y:128},{objname:"mine",x:320,y:200},{objname:"mine",x:320,y:272},{objname:"mine",x:320,y:344},{objname:"mine",x:320,y:416},{objname:"mine",x:392,y:416},{objname:"mine",x:464,y:416},{objname:"mine",x:536,y:416},{objname:"mine",x:608,y:416},{objname:"coin",x:463,y:56},{objname:"coin",x:463,y:128},{objname:"coin",x:482,y:200},{objname:"coin",x:535,y:253},{objname:"coin",x:607,y:272},{objname:"coin",x:32,y:272},{objname:"coin",x:104,y:291},{objname:"coin",x:157,y:344},{objname:"coin",x:176,y:416},{objname:"coin",x:176,y:488}]},{ysize:240,objs:[{objname:"squid",x:320,y:40,movetype:"cirh",radius:250,angle:0},{objname:"squid",x:320,y:80,movetype:"cirh",radius:250,angle:10},{objname:"squid",x:320,y:120,movetype:"cirh",radius:250,angle:20},{objname:"squid",x:320,y:160,movetype:"cirh",radius:250,angle:30},{objname:"squid",x:320,y:40,movetype:"cirh",radius:250,angle:180},{objname:"squid",x:320,y:80,movetype:"cirh",radius:250,angle:190},{objname:"squid",x:320,y:120,movetype:"cirh",radius:250,angle:200},{objname:"squid",x:320,y:160,movetype:"cirh",radius:250,angle:210}]},{ysize:256,objs:[{objname:"ruby",x:160,y:128},{objname:"ruby",x:320,y:128},{objname:"ruby",x:480,y:128}]},{ysize:256,objs:[{objname:"treasure",x:320,y:192}]}]},{comment:"level 10",parts:[{ysize:720,objs:[{objname:"squid",x:256,y:32,movetype:"cirh",radius:224,angle:180},{objname:"squid",x:320,y:32,movetype:"cirh",radius:224,angle:180},{objname:"squid",x:384,y:32,movetype:"cirh",radius:224,angle:180},{objname:"coin",x:32,y:96},{objname:"coin",x:96,y:96},{objname:"coin",x:160,y:96},{objname:"coin",x:224,y:96},{objname:"coin",x:288,y:96},{objname:"coin",x:352,y:96},{objname:"coin",x:416,y:96},{objname:"coin",x:480,y:96},{objname:"coin",x:544,y:96},{objname:"coin",x:608,y:96},{objname:"coin",x:32,y:160},{objname:"coin",x:96,y:160},{objname:"coin",x:160,y:160},{objname:"coin",x:224,y:160},{objname:"coin",x:288,y:160},{objname:"coin",x:352,y:160},{objname:"coin",x:416,y:160},{objname:"coin",x:480,y:160},{objname:"coin",x:544,y:160},{objname:"coin",x:608,y:160},{objname:"squid",x:256,y:224,movetype:"cirh",radius:224,angle:0},{objname:"squid",x:320,y:224,movetype:"cirh",radius:224,angle:0},{objname:"squid",x:384,y:224,movetype:"cirh",radius:224,angle:0},{objname:"coin",x:32,y:288},{objname:"coin",x:96,y:288},{objname:"coin",x:160,y:288},{objname:"coin",x:224,y:288},{objname:"coin",x:288,y:288},{objname:"coin",x:352,y:288},{objname:"coin",x:416,y:288},{objname:"coin",x:480,y:288},{objname:"coin",x:544,y:288},{objname:"coin",x:608,y:288},{objname:"coin",x:32,y:352},{objname:"coin",x:96,y:352},{objname:"coin",x:160,y:352},{objname:"coin",x:224,y:352},{objname:"coin",x:288,y:352},{objname:"coin",x:352,y:352},{objname:"coin",x:416,y:352},{objname:"coin",x:480,y:352},{objname:"coin",x:544,y:352},{objname:"coin",x:608,y:352},{objname:"squid",x:256,y:416,movetype:"cirh",radius:224,angle:180},{objname:"squid",x:320,y:416,movetype:"cirh",radius:224,angle:180},{objname:"squid",x:384,y:416,movetype:"cirh",radius:224,angle:180},{objname:"coin",x:32,y:480},{objname:"coin",x:96,y:480},{objname:"coin",x:160,y:480},{objname:"coin",x:224,y:480},{objname:"coin",x:288,y:480},{objname:"coin",x:352,y:480},{objname:"coin",x:416,y:480},{objname:"coin",x:480,y:480},{objname:"coin",x:544,y:480},{objname:"coin",x:608,y:480},{objname:"coin",x:32,y:544},{objname:"coin",x:96,y:544},{objname:"coin",x:160,y:544},{objname:"coin",x:224,y:544},{objname:"coin",x:288,y:544},{objname:"coin",x:352,y:544},{objname:"coin",x:416,y:544},{objname:"coin",x:480,y:544},{objname:"coin",x:544,y:544},{objname:"coin",x:608,y:544},{objname:"squid",x:256,y:608,movetype:"cirh",radius:224,angle:0},{objname:"squid",x:320,y:608,movetype:"cirh",radius:224,angle:0},{objname:"squid",x:384,y:608,movetype:"cirh",radius:224,angle:0}]},{ysize:640,objs:[{objname:"coin",x:320,y:133},{objname:"coin",x:288,y:189},{objname:"coin",x:352,y:189},{objname:"coin",x:256,y:245},{objname:"coin",x:320,y:245},{objname:"coin",x:384,y:245},{objname:"coin",x:224,y:301},{objname:"coin",x:416,y:301},{objname:"coin",x:192,y:357},{objname:"coin",x:256,y:357},{objname:"coin",x:384,y:357},{objname:"coin",x:448,y:357},{objname:"coin",x:160,y:413},{objname:"coin",x:224,y:413},{objname:"coin",x:288,y:413},{objname:"coin",x:352,y:413},{objname:"coin",x:416,y:413},{objname:"coin",x:480,y:413},{objname:"ruby",x:320,y:320},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:0},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:60},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:75},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:90},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:105},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:120},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:180},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:195},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:210},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:225},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:240},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:300},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:315},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:330},{objname:"mine",x:320,y:320,movetype:"circ",radius:288,angle:345}]},{ysize:840,objs:[{objname:"coin",x:256,y:180},{objname:"coin",x:288,y:236},{objname:"coin",x:320,y:292},{objname:"coin",x:320,y:356},{objname:"coin",x:320,y:484},{objname:"coin",x:320,y:548},{objname:"coin",x:288,y:604},{objname:"coin",x:256,y:660},{objname:"coin",x:320,y:180},{objname:"coin",x:352,y:236},{objname:"ruby",x:320,y:420},{objname:"mine",x:179,y:297},{objname:"mine",x:212,y:354},{objname:"mine",x:224,y:420},{objname:"coin",x:352,y:604},{objname:"coin",x:320,y:660},{objname:"coin",x:384,y:180},{objname:"mine",x:212,y:486},{objname:"mine",x:179,y:543},{objname:"mine",x:461,y:297},{objname:"mine",x:428,y:354},{objname:"mine",x:416,y:420},{objname:"mine",x:428,y:486},{objname:"coin",x:384,y:660},{objname:"mine",x:461,y:543}]},{ysize:320,objs:[{objname:"treasure",x:320,y:256}]}]},{comment:"level 11 prefinal",parts:[{ysize:1280,objs:[{objname:"mine",x:32,y:288},{objname:"mine",x:96,y:288},{objname:"mine",x:160,y:288},{objname:"mine",x:224,y:288},{objname:"mine",x:288,y:288},{objname:"mine",x:352,y:288},{objname:"mine",x:416,y:288},{objname:"mine",x:224,y:544},{objname:"mine",x:288,y:544},{objname:"mine",x:352,y:544},{objname:"mine",x:416,y:544},{objname:"mine",x:480,y:544},{objname:"mine",x:544,y:544},{objname:"mine",x:608,y:544},{objname:"coin",x:96,y:32},{objname:"coin",x:113,y:96},{objname:"coin",x:160,y:143},{objname:"coin",x:224,y:160},{objname:"coin",x:288,y:160},{objname:"coin",x:352,y:160},{objname:"coin",x:416,y:160},{objname:"coin",x:480,y:177},{objname:"coin",x:527,y:224},{objname:"ruby",x:544,y:288},{objname:"coin",x:527,y:352},{objname:"coin",x:480,y:399},{objname:"coin",x:416,y:416},{objname:"coin",x:352,y:416},{objname:"coin",x:288,y:416},{objname:"coin",x:224,y:416},{objname:"coin",x:158,y:433},{objname:"coin",x:111,y:480},{objname:"ruby",x:94,y:544},{objname:"coin",x:113,y:608},{objname:"coin",x:160,y:655},{objname:"coin",x:224,y:672},{objname:"coin",x:288,y:672},{objname:"coin",x:352,y:672},{objname:"coin",x:416,y:672},{objname:"coin",x:480,y:689},{objname:"coin",x:527,y:736},{objname:"ruby",x:544,y:800},{objname:"coin",x:527,y:864},{objname:"coin",x:480,y:911},{objname:"coin",x:416,y:928},{objname:"coin",x:352,y:928},{objname:"coin",x:288,y:928},{objname:"coin",x:224,y:928},{objname:"coin",x:158,y:945},{objname:"coin",x:111,y:992},{objname:"coin",x:94,y:1056},{objname:"coin",x:94,y:1120},{objname:"mine",x:32,y:800},{objname:"mine",x:96,y:800},{objname:"mine",x:160,y:800},{objname:"mine",x:224,y:800},{objname:"mine",x:288,y:800},{objname:"mine",x:352,y:800},{objname:"mine",x:416,y:800},{objname:"mine",x:224,y:1056},{objname:"mine",x:288,y:1056},{objname:"mine",x:352,y:1056},{objname:"mine",x:416,y:1056},{objname:"mine",x:480,y:1056},{objname:"mine",x:544,y:1056},{objname:"mine",x:608,y:1056}]},{ysize:560,objs:[{objname:"coin",x:40,y:80},{objname:"coin",x:120,y:80},{objname:"coin",x:200,y:80},{objname:"coin",x:280,y:80},{objname:"coin",x:360,y:80},{objname:"coin",x:440,y:80},{objname:"coin",x:520,y:80},{objname:"coin",x:600,y:80},{objname:"coin",x:40,y:160},{objname:"coin",x:120,y:160},{objname:"coin",x:200,y:160},{objname:"coin",x:280,y:160},{objname:"coin",x:360,y:160},{objname:"coin",x:440,y:160},{objname:"coin",x:520,y:160},{objname:"coin",x:600,y:160},{objname:"mine",x:320,y:240,movetype:"cirh",radius:240,angle:0},{objname:"mine",x:320,y:320,movetype:"cirh",radius:240,angle:0},{objname:"mine",x:320,y:400,movetype:"cirh",radius:240,angle:180},{objname:"mine",x:320,y:480,movetype:"cirh",radius:240,angle:180}]},{ysize:560,objs:[{objname:"coin",x:40,y:80},{objname:"coin",x:120,y:80},{objname:"coin",x:40,y:160},{objname:"coin",x:120,y:160},{objname:"ruby",x:220,y:120},{objname:"ruby",x:320,y:120},{objname:"ruby",x:420,y:120},{objname:"coin",x:520,y:80},{objname:"coin",x:600,y:80},{objname:"coin",x:520,y:160},{objname:"coin",x:600,y:160},{objname:"mine",x:320,y:240,movetype:"cirh",radius:240,angle:0},{objname:"mine",x:320,y:320,movetype:"cirh",radius:240,angle:180},{objname:"mine",x:320,y:400,movetype:"cirh",radius:240,angle:0},{objname:"mine",x:320,y:480,movetype:"cirh",radius:240,angle:180}]},{ysize:480,objs:[{objname:"coin",x:40,y:80},{objname:"coin",x:120,y:80},{objname:"coin",x:200,y:80},{objname:"coin",x:280,y:80},{objname:"coin",x:360,y:80},{objname:"coin",x:440,y:80},{objname:"coin",x:520,y:80},{objname:"coin",x:600,y:80},{objname:"coin",x:40,y:160},{objname:"coin",x:120,y:160},{objname:"coin",x:200,y:160},{objname:"coin",x:280,y:160},{objname:"coin",x:360,y:160},{objname:"coin",x:440,y:160},{objname:"coin",x:520,y:160},{objname:"coin",x:600,y:160},{objname:"treasure",x:320,y:416}]}]},{comment:"level 12 HARDEST!",parts:[{ysize:640,objs:[{objname:"mine",x:32,y:280},{objname:"mine",x:80,y:280},{objname:"mine",x:320,y:280,movetype:"circ",radius:192,angle:180},{objname:"mine",x:320,y:280,movetype:"circ",radius:144,angle:180},{objname:"mine",x:320,y:280,movetype:"circ",radius:96,angle:180},{objname:"mine",x:320,y:280,movetype:"circ",radius:48,angle:180},{objname:"mine",x:320,y:280},{objname:"mine",x:320,y:280,movetype:"circ",radius:48,angle:0},{objname:"mine",x:320,y:280,movetype:"circ",radius:96,angle:0},{objname:"mine",x:320,y:280,movetype:"circ",radius:144,angle:0},{objname:"mine",x:320,y:280,movetype:"circ",radius:192,angle:0},{objname:"mine",x:560,y:280},{objname:"mine",x:608,y:280},{objname:"coin",x:32,y:88},{objname:"coin",x:96,y:88},{objname:"coin",x:160,y:88},{objname:"coin",x:224,y:88},{objname:"coin",x:416,y:88},{objname:"coin",x:480,y:88},{objname:"coin",x:544,y:88},{objname:"coin",x:608,y:88},{objname:"coin",x:32,y:152},{objname:"coin",x:96,y:152},{objname:"coin",x:160,y:152},{objname:"coin",x:480,y:152},{objname:"coin",x:544,y:152},{objname:"coin",x:608,y:152},{objname:"coin",x:32,y:408},{objname:"coin",x:160,y:408},{objname:"coin",x:480,y:408},{objname:"coin",x:544,y:408},{objname:"coin",x:608,y:408},{objname:"coin",x:96,y:408},{objname:"coin",x:32,y:472},{objname:"coin",x:96,y:472},{objname:"coin",x:160,y:472},{objname:"coin",x:224,y:472},{objname:"coin",x:416,y:472},{objname:"coin",x:480,y:472},{objname:"coin",x:544,y:472},{objname:"coin",x:608,y:472}]},{ysize:1280,objs:[{objname:"mine",x:320,y:32,movetype:"cirh",radius:288,angle:0},{objname:"mine",x:320,y:64,movetype:"cirh",radius:288,angle:10},{objname:"mine",x:320,y:96,movetype:"cirh",radius:288,angle:20},{objname:"mine",x:320,y:128,movetype:"cirh",radius:288,angle:10},{objname:"mine",x:320,y:160,movetype:"cirh",radius:288,angle:0},{objname:"coin",x:226,y:224},{objname:"coin",x:290,y:224},{objname:"coin",x:354,y:224},{objname:"coin",x:418,y:224},{objname:"coin",x:226,y:608},{objname:"coin",x:290,y:608},{objname:"coin",x:354,y:608},{objname:"coin",x:418,y:608},{objname:"mine",x:320,y:352,movetype:"cirh",radius:288,angle:180},{objname:"mine",x:320,y:384,movetype:"cirh",radius:288,angle:190},{objname:"mine",x:320,y:416,movetype:"cirh",radius:288,angle:200},{objname:"mine",x:320,y:448,movetype:"cirh",radius:288,angle:190},{objname:"mine",x:320,y:480,movetype:"cirh",radius:288,angle:180},{objname:"coin",x:226,y:544},{objname:"coin",x:290,y:544},{objname:"coin",x:354,y:544},{objname:"coin",x:418,y:544},{objname:"coin",x:226,y:288},{objname:"coin",x:290,y:288},{objname:"coin",x:354,y:288},{objname:"coin",x:418,y:288},{objname:"mine",x:320,y:672,movetype:"cirh",radius:288,angle:0},{objname:"mine",x:320,y:704,movetype:"cirh",radius:288,angle:10},{objname:"mine",x:320,y:736,movetype:"cirh",radius:288,angle:20},{objname:"mine",x:320,y:768,movetype:"cirh",radius:288,angle:10},{objname:"mine",x:320,y:800,movetype:"cirh",radius:288,angle:0},{objname:"coin",x:226,y:864},{objname:"coin",x:290,y:864},{objname:"coin",x:354,y:864},{objname:"coin",x:418,y:864},{objname:"mine",x:320,y:992,movetype:"cirh",radius:288,angle:180},{objname:"mine",x:320,y:1024,movetype:"cirh",radius:288,angle:190},{objname:"mine",x:320,y:1056,movetype:"cirh",radius:288,angle:200},{objname:"mine",x:320,y:1088,movetype:"cirh",radius:288,angle:190},{objname:"mine",x:320,y:1120,movetype:"cirh",radius:288,angle:180},{objname:"coin",x:226,y:928},{objname:"coin",x:290,y:928},{objname:"coin",x:354,y:928},{objname:"coin",x:418,y:928}]},{ysize:560,objs:[{objname:"mine",x:320,y:280,movetype:"circ",radius:192,angle:180},{objname:"mine",x:320,y:280,movetype:"circ",radius:144,angle:180},{objname:"mine",x:320,y:280,movetype:"circ",radius:96,angle:180},{objname:"mine",x:320,y:280,movetype:"circ",radius:48,angle:180},{objname:"mine",x:320,y:280},{objname:"mine",x:320,y:280,movetype:"circ",radius:48,angle:0},{objname:"mine",x:320,y:280,movetype:"circ",radius:96,angle:0},{objname:"mine",x:320,y:280,movetype:"circ",radius:144,angle:0},{objname:"mine",x:320,y:280,movetype:"circ",radius:192,angle:0},{objname:"coin",x:608,y:280},{objname:"coin",x:598,y:355},{objname:"coin",x:569,y:424},{objname:"coin",x:524,y:484},{objname:"coin",x:116,y:484},{objname:"coin",x:71,y:424},{objname:"coin",x:42,y:355},{objname:"coin",x:32,y:280},{objname:"coin",x:42,y:205},{objname:"coin",x:71,y:136},{objname:"coin",x:116,y:76},{objname:"coin",x:524,y:76},{objname:"coin",x:569,y:136},{objname:"coin",x:598,y:205}]},{ysize:320,objs:[{objname:"treasure",x:320,y:256}]}]}];var STATE_INTRO=0;var STATE_PLAYING=1;var STATE_ATBOTTOM=2;var SCROLL_SPEED=-1;var EXPL_MINE=1;var EXPL_INK=2;var EXPL_ELECTRO=3;var CHEAT_INVINCIBLE=false;var CHEAT_RUBY=false;var GLOBAL_PAUSE_FLAG=false;uboat.Game=function(e){this.game=e;this._player=null;this._objGroup=null;this._explosionGroup=null;uboat._popupText=null;uboat._levelstate=STATE_INTRO;uboat._stateCountDown=0;this._leveldepth=0;this._levelIndex=0;this._partsIndex=0;this._partsBar=0;this._backobjsCountdown=0;this._collectedCoins=0;this._collectedRuby=0;this._collectedTreasure=0;this._totalCoins=0;this._totalRuby=0;this._totalTreasure=0;this._levelGameOver=0;this._strCheatCode="";this._panelGameOver=null;this._panelStar1=null;this._panelStar2=null;this._panelStar3=null;this._panelText1=null;this._panelText2=null;this._panelText3=null;this._btnGoback=null;this._btnRestart=null;this._btnNextLevel=null};uboat.Game.prototype={create:function(){this.game.physics.startSystem(Phaser.Physics.ARCADE);this.add.sprite(0,0,"background");this._backobjsGroup=[];backgroundCreateBubbles(this.game,this._backobjsGroup);this._player=new Submarine(this.game);this.game.world.add(this._player);this.game.physics.enable(this._player,Phaser.Physics.ARCADE);this.emitCoin=this.game.add.emitter(0,0,200);this.emitCoin.makeParticles("particles",[0]);this.emitCoin.setXSpeed(-400,+400);this.emitCoin.setYSpeed(-400,+400);this.emitCoin.setRotation(-1600,+1600);this.emitCoin.setScale(1,.1,1,.1,1600,Phaser.Easing.None);this.emitCoin.gravity=0;this.emitExplode=this.game.add.emitter(0,0,50);this.emitExplode.makeParticles("particles",[3,4,5,6]);this.emitExplode.setXSpeed(-240,+240);this.emitExplode.setYSpeed(-240,+240);this.emitExplode.setRotation(-720,+720);this.emitExplode.setScale(2,.1,2,.1,2e3,Phaser.Easing.None);this.emitExplode.gravity=0;this._objGroup=this.game.add.group();this._objGroup.enableBody=true;this._objGroup.physicsBodyType=Phaser.Physics.ARCADE;this._explosionGroup=this.game.add.group();this.emitInkblob=this.game.add.emitter(0,0,50);this.emitInkblob.makeParticles("particles",[7]);this.emitInkblob.setXSpeed(0,0);this.emitInkblob.setYSpeed(0,-50);this.emitInkblob.setRotation(0,0);this.emitInkblob.setScale(.1,1,.1,1,800,Phaser.Easing.None);this.emitInkblob.gravity=0;this._panelGameOver=this.game.add.group();var e=this.game.add.sprite(0,0,"ingamepanel");this._panelCaption=this.game.add.bitmapText(144,16,"myfont","Excellent!",48);this._panelCaption.align="center";this._panelStar1=this.game.add.sprite(48,160,"buttonicon",13);this._panelStar2=this.game.add.sprite(176,160,"buttonicon",13);this._panelStar3=this.game.add.sprite(304,160,"buttonicon",13);var t=this.game.add.sprite(80,200,"gameobjs",63);var n=this.game.add.sprite(208,200,"gameobjs",0);var r=this.game.add.sprite(336,200,"gameobjs",8);this._panelText1=this.game.add.bitmapText(80,280,"myfont","0/0",32);this._panelText2=this.game.add.bitmapText(208,280,"myfont","0/0",32);this._panelText3=this.game.add.bitmapText(336,280,"myfont","0/0",32);this._panelGameOver.add(e);this._panelGameOver.add(this._panelCaption);this._panelGameOver.add(this._panelStar1);this._panelGameOver.add(this._panelStar2);this._panelGameOver.add(this._panelStar3);this._panelGameOver.add(t);this._panelGameOver.add(n);this._panelGameOver.add(r);this._panelGameOver.add(this._panelText1);this._panelGameOver.add(this._panelText2);this._panelGameOver.add(this._panelText3);this._panelGameOver.x=80;this._panelGameOver.y=-480;this._btnGoback=this.game.add.button(0,1120,"buttonicon",this.doBtnGoback,this,4,0,8);this._btnRestart=this.game.add.button(0,1120,"buttonicon",this.doBtnRestart,this,5,1,9);this._btnNextLevel=this.game.add.button(0,1120,"buttonicon",this.doBtnNextLevel,this,6,2,10);this.soundCoin=this.game.add.audio("coin");this.soundRuby=this.game.add.audio("ruby");this.soundTreasure=this.game.add.audio("treasure");this.soundExplode=this.game.add.audio("explode");this.soundSquid=this.game.add.audio("squid");this.soundFizzle=this.game.add.audio("fizzle");this.soundGuiButton=this.game.add.audio("gui_button");this.soundGuiForward=this.game.add.audio("gui_forward");this.soundGuiBack=this.game.add.audio("gui_back");uboat._popupText=this.game.add.bitmapText(320,-320,"myfont","no text yet",64);this._boxBlack=this.game.add.graphics(0,0);this._boxBlack.beginFill(0,.5);this._boxBlack.drawRect(0,0,uboat.GAME_WIDTH,uboat.GAME_HEIGHT);this._boxBlack.y=0;this._cheatText=this.game.add.bitmapText(320,-320,"myfont","no text yet",64);this._btnPause=this.game.add.button(640-120,-8,"buttonicon",this.doBtnPause,this,7,3,11);this._btnContinue=new MyLabelButton(this.game,160,960+352,"button","Continue",this.doBtnContinue,this,1,0,2);this._btnLevels=new MyLabelButton(this.game,160,960+352+128,"button","Level select",this.doBtnLevels,this,1,0,2);this._btnMainMenu=new MyLabelButton(this.game,160,960+352+256,"button","Main menu",this.doBtnMainMenu,this,1,0,2);this.game.input.onDown.add(this.ingameOnDown,this);this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR).onDown.add(this.ingameOnDown,this);CHEAT_INVINCIBLE=false;CHEAT_RUBY=false;backgroundFadeIn(this.game,true);this.startNewGame()},update:function(){if(GLOBAL_PAUSE_FLAG==false){this.game.physics.arcade.overlap(this._player.hitGroup,this._objGroup,this.playerHitsObj,null,this);if(uboat._stateCountDown>0){uboat._stateCountDown-=1;switch(uboat._levelstate){case STATE_INTRO:if(uboat._stateCountDown==45){this.doPopupText(uboat._popupText,"Level "+(this._levelIndex+1),480)}if(uboat._stateCountDown==1){this.doPopupText(uboat._popupText,"Go!!",480);uboat._levelstate=STATE_PLAYING}break}}if(uboat._levelstate==STATE_PLAYING){this._leveldepth=this._leveldepth-SCROLL_SPEED;this._partsBar=this._partsBar+SCROLL_SPEED;if(this._partsBar<=uboat.GAME_HEIGHT){this.spawnLevelPart()}}backgroundUpdateBubbles(this.game,this._backobjsGroup)}},render:function(){},ingameOnDown:function(e){if(GLOBAL_PAUSE_FLAG==false){this._player.doTap()}else{this.onPauseBackTouch(e)}},startNewGame:function(){this.togglePauseMenu(false);GLOBAL_PAUSE_FLAG=false;for(var e=0;e<this._objGroup.length;e++){if(this._objGroup.children[e].alive){this._objGroup.children[e].kill()}}this._leveldepth=0;this._partsIndex=0;uboat._levelstate=STATE_INTRO;uboat._stateCountDown=60;this._levelGameOver=0;this._player.revive();this._level=-1;this._collectedCoins=0;this._collectedRuby=0;this._collectedTreasure=0;this._totalCoins=0;this._totalRuby=0;this._totalTreasure=0;for(var t=0;t<LevelData[this._levelIndex].parts.length;t++){for(var n=0;n<LevelData[this._levelIndex].parts[t].objs.length;n++){var r=LevelData[this._levelIndex].parts[t].objs[n].objname;if(r=="coin"){this._totalCoins++}if(r=="ruby"){this._totalRuby++}if(r=="treasure"){this._totalTreasure++}}}this._partsBar=480;while(this._partsBar<uboat.GAME_HEIGHT&&this._partsIndex<LevelData[this._levelIndex].parts.length){this.spawnLevelPart()}},spawnLevelPart:function(){if(this._partsIndex>LevelData[this._levelIndex].parts.length-1){uboat._levelstate=STATE_ATBOTTOM;return}var e=LevelData[this._levelIndex].parts[this._partsIndex].objs;for(var t=0;t<e.length;t++){var n=e[t].x;var r=e[t].y+this._partsBar;var i=this._objGroup.getFirstDead();if(i===null){i=new GameObj(this.game,n,r);this._objGroup.add(i)}i.init(e[t].objname,n,r,e[t].movetype,e[t].radius,e[t].angle,t%8);i.revive()}this._partsBar=this._partsBar+LevelData[this._levelIndex].parts[this._partsIndex].ysize;this._partsIndex++},playerHitsObj:function(e,t){if(!t.body.enable){return false}switch(t.ObjType){case OBJ_COIN:this.soundCoin.play();this._collectedCoins++;this.doParticleEffect(t.x,t.y,t.ObjType);break;case OBJ_RUBY:this.soundRuby.play();this._collectedRuby++;this.doParticleEffect(t.x,t.y,t.ObjType);break;case OBJ_TREASURE:this.soundTreasure.play();this._collectedTreasure++;this.doParticleEffect(t.x,t.y,t.ObjType);this.checkGameWin();break;case OBJ_STARFISH:this._player.slowdownCount=15;break;case OBJ_STINGRAY:this.soundFizzle.play();this._player.electroCount=120;this.addExplosion(this._player.x,this._player.y,EXPL_ELECTRO);break;case OBJ_SQUID:this.soundSquid.play();for(var n=0;n<15;n++){this.game.time.events.add(n*40,function(){this.addExplosion(this._player.x,this._player.y,EXPL_INK)},this)}this.doParticleEffect(this._player.x,this._player.y,t.ObjType);break;case OBJ_MINE:this.addExplosion(t.x,t.y,EXPL_MINE);if(CHEAT_INVINCIBLE==false){this.soundExplode.play();this.doParticleEffect(this._player.x,this._player.y,t.ObjType);this.game.time.events.add(120,function(){this.addExplosion(this._player.x,this._player.y,EXPL_MINE)},this);this.game.time.events.add(240,function(){this.addExplosion(t.x-32,t.y-32,EXPL_MINE)},this);this.game.time.events.add(360,function(){this.addExplosion(t.x+32,t.y+32,EXPL_MINE)},this);this._player.kill();if(this._levelGameOver==0){this._levelGameOver=-1;this.game.time.events.add(1e3,function(){this.showGameOverPanel(true)},this)}this._btnPause.y-=960}break}if(t.ObjType==OBJ_STARFISH||t.ObjType==OBJ_STINGRAY||t.ObjType==OBJ_SQUID){var r=4;var i=400;if(t.ObjType==OBJ_STARFISH){r=1;i=800}if(t.ObjType==OBJ_STARFISH){r=1;i=800}var s=t.x-r*(e.x-t.x);var o=t.y-r*(e.y-t.y);t.body.enable=false;var u=this.game.add.tween(t).to({x:s,y:o},i,Phaser.Easing.Linear.None,true);u.onComplete.add(function(){t.kill()},this)}else{t.kill()}},onLevelWin:function(){},doPopupText:function(e,t,n){e.text=t;e.makeCentered(320);e.y=n;e.alpha=1;this.game.add.tween(e).to({y:n-80,alpha:0},300,Phaser.Easing.Linear.None,true,300)},displayGameOverText:function(e,t){},addExplosion:function(e,t,n){if(n==EXPL_INK){e=e+this.game.rnd.integerInRange(-100,100);t=t+this.game.rnd.integerInRange(-100,100)}var r=1;if(e>640-80){r=2;e=e-640}if(e<80){r=2}for(var i=0;i<r;i++){var s=this._explosionGroup.getFirstExists(false);if(s===null){var s=this._explosionGroup.create(0,0,"explosions",null,false);s.anchor.setTo(.5,.5);s.animations.add("explode",[0,1,1,2,3,4,5,6,7],5,true);s.animations.add("expl_ink",[9,11,13,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],5,true);s.animations.add("expl_elec",[16,17,18,19,17,16,19,18,16,17,18,19,17,16,19,18],5,true)}s.reset(e,t);if(n==EXPL_MINE){s.play("explode",30,false,true)}if(n==EXPL_INK){s.play("expl_ink",30,false,true)}if(n==EXPL_ELECTRO){s.play("expl_elec",60,false,true)}e=e+640}},doParticleEffect:function(e,t,n){switch(n){case OBJ_COIN:this.emitCoin.x=e;this.emitCoin.y=t;this.doParticlesCircle(this.emitCoin,200,400,8);break;case OBJ_RUBY:case OBJ_TREASURE:this.emitCoin.x=e;this.emitCoin.y=t;this.doParticlesCircle(this.emitCoin,300,800,12);this.doParticlesCircle(this.emitCoin,400,800,8);break;case OBJ_SQUID:for(var r=0;r<6;r++){this.emitInkblob.x=e+this.game.rnd.integerInRange(-240,240);this.emitInkblob.y=t+this.game.rnd.integerInRange(-240,240);var i=1200+this.game.rnd.integerInRange(-800,800);this.emitInkblob.start(true,i,null,1);this.emitInkblob.update()}break;case OBJ_MINE:this.emitExplode.x=e;this.emitExplode.y=t;var s;var o;if(this._player.moveAngleStep>0){s=Math.cos(2*Math.PI*(this._player.moveAngle+90)/360)*PRECALC_SPEED*40;o=Math.sin(2*Math.PI*(this._player.moveAngle+90)/360)*PRECALC_SPEED*40}else{s=Math.cos(2*Math.PI*(this._player.moveAngle+270)/360)*PRECALC_SPEED*40;o=Math.sin(2*Math.PI*(this._player.moveAngle+270)/360)*PRECALC_SPEED*40}this.emitExplode.setXSpeed(s-120,s+120);this.emitExplode.setYSpeed(o-120,o+120);this.emitExplode.start(true,800,null,16);break}},doParticlesCircle:function(e,t,n,r){var i=Math.round(360/r);for(var s=0;s<360;s=s+i){var o=Math.cos(2*Math.PI*s/360)*t;e.setXSpeed(o,o);var u=Math.sin(2*Math.PI*s/360)*t;e.setYSpeed(u,u);e.start(true,n,null,1);e.update()}},doBtnPause:function(){this.togglePauseMenu(true);GLOBAL_PAUSE_FLAG=true;this.soundGuiButton.play();for(var e=0;e<this._objGroup.length;e++){if(this._objGroup.children[e].alive){this._objGroup.children[e].animations.currentAnim.paused=true}}this._player.emitBubble.on=false;this._strCheatCode=""},doBtnContinue:function(){this.togglePauseMenu(false);GLOBAL_PAUSE_FLAG=false;this.soundGuiButton.play();for(var e=0;e<this._objGroup.length;e++){var t=this._objGroup.children[e];if(t.alive){t.animations.currentAnim.paused=false}}this._player.emitBubble.on=true},doBtnLevels:function(){this.soundGuiBack.play();var e=backgroundFadeIn(this.game,false);e.onComplete.add(function(){this.state.start("LevelSelect")},this)},doBtnMainMenu:function(){this.soundGuiBack.play();var e=backgroundFadeIn(this.game,false);e.onComplete.add(function(){this.state.start("MainMenu")},this)},doBtnBack:function(){if(this._levelGameOver!=0){this.doBtnGoback()}else if(GLOBAL_PAUSE_FLAG==true){this.doBtnLevels()}else{this.doBtnPause()}},togglePauseMenu:function(e){var t=0;if(e){t=960}this._btnPause.y=-8+t;this._boxBlack.y=960-t;this._btnContinue.y=960+352-t;this._btnLevels.y=960+352+128-t;this._btnMainMenu.y=960+352+256-t},checkGameWin:function(){if(this._collectedTreasure==this._totalTreasure){this._levelGameOver=1;var e=0;if(this._collectedTreasure>=this._totalTreasure){e++}if(this._collectedCoins>=this._totalCoins){e++}if(this._collectedRuby>=this._totalRuby){e++}if(!uboat.PlayerProgress[this._levelIndex]||uboat.PlayerProgress[this._levelIndex]<e){uboat.PlayerProgress[this._levelIndex]=e}if(this._levelIndex<LevelData.length-1){if(!uboat.PlayerProgress[this._levelIndex+1]||uboat.PlayerProgress[this._levelIndex+1]<0){uboat.PlayerProgress[this._levelIndex+1]=0}}window.localStorage.setItem("taptap_progress",JSON.stringify(uboat.PlayerProgress));this._btnPause.y-=960;this.game.time.events.add(400,function(){this.showGameOverPanel(true)},this)}},showGameOverPanel:function(e){var t=0;var n=0;if(e==true){t=160;n=512;if(this._totalTreasure==1){if(this._collectedTreasure==1){this._panelText1.text="Ok"}else{this._panelText1.text="X"}}else{this._panelText1.text=this._collectedTreasure+"/"+this._totalTreasure}this._panelText2.text=this._collectedCoins+"/"+this._totalCoins;this._panelText3.text=this._collectedRuby+"/"+this._totalRuby;this._panelStar1.y=120;this._panelStar2.y=120;this._panelStar3.y=120;this._panelStar1.alpha=0;this._panelStar2.alpha=0;this._panelStar3.alpha=0;if(this._levelGameOver>0){var r=0;if(this._collectedTreasure>=this._totalTreasure){r++;this.game.add.tween(this._panelStar1).to({y:160,alpha:1},120,Phaser.Easing.Back.Out,true,400+240)}if(this._collectedCoins>=this._totalCoins){r++;this.game.add.tween(this._panelStar2).to({y:160,alpha:1},120,Phaser.Easing.Back.Out,true,400+480)}if(this._collectedRuby>=this._totalRuby){r++;this.game.add.tween(this._panelStar3).to({y:160,alpha:1},120,Phaser.Easing.Back.Out,true,400+720)}var i="Good!";if(r==2){i="Fantastic!"}if(r==3){i="Excellent!"}this._panelCaption.text=i+"\nLevel "+(this._levelIndex+1)+" completed";this._btnGoback.x=112;this._btnRestart.x=256;this._btnNextLevel.x=400}else{var s=["Try again!","Try again!","Try again!","Try again!","You're not trying!","Try harder!","Don't give up!","haha you suck!"];var o=this.game.rnd.integerInRange(0,s.length-1);this._panelCaption.text="Game over\n"+s[o];this._btnGoback.x=184;this._btnRestart.x=328}this._panelCaption.makeCentered(240);this._panelText1.makeCentered(112);this._panelText2.makeCentered(240);this._panelText3.makeCentered(368)}else{t=-480;n=1120}this.game.add.tween(this._panelGameOver).to({y:t},400,Phaser.Easing.Back.Out,true);this.game.add.tween(this._btnGoback).to({y:n},400,Phaser.Easing.Back.Out,true);this.game.add.tween(this._btnRestart).to({y:n},400,Phaser.Easing.Back.Out,true,40);if(this._levelGameOver>0){this.game.add.tween(this._btnNextLevel).to({y:n},400,Phaser.Easing.Back.Out,true,80)}},doBtnGoback:function(){this.soundGuiBack.play();this.showGameOverPanel(false);this.doBtnLevels()},doBtnRestart:function(){this.soundGuiButton.play();this.showGameOverPanel(false);this.startNewGame()},doBtnNextLevel:function(){this.showGameOverPanel(false);this.soundGuiForward.play();this._levelIndex++;if(this._levelIndex<LevelData.length){this.startNewGame()}else{var e=backgroundFadeIn(this.game,false);e.onComplete.add(function(){this.state.start("WinScreen")},this)}},onPauseBackTouch:function(e){var t=new Phaser.Rectangle(0,0,uboat.GAME_WIDTH,352);var n=new Phaser.Rectangle(0,uboat.GAME_HEIGHT-352,uboat.GAME_WIDTH,352);var r=new Phaser.Rectangle(0,352,160,uboat.GAME_HEIGHT-352-352);var i=new Phaser.Rectangle(uboat.GAME_WIDTH-160,352,160,uboat.GAME_HEIGHT-352-352);var s="-";if(t.contains(e.x,e.y)==true){s="U"}if(n.contains(e.x,e.y)==true){s="D"}if(r.contains(e.x,e.y)==true){s="L"}if(i.contains(e.x,e.y)==true){s="R"}this._strCheatCode+=s;if(this._strCheatCode.length>8){this._strCheatCode=this._strCheatCode.substring(this._strCheatCode.length-8)}if(this._strCheatCode=="UUDDLRLR"){CHEAT_INVINCIBLE=true;this.doPopupText(this._cheatText,"Invincible",352-128);this.soundCoin.play()}}};(function(e){function t(){}function n(){}function r(e){return new i(e)}function i(e){this.attributes=this.convertContent(e);this.length=Object.keys(this.attributes).length}e.utils={fixDOMParser:function(){console.log("cocoonjsphaser.utils.fixDOMParser starts..");window.DOMParser=t;console.log("cocoonjsphaser.utils.fixDOMParser is ready..")}};t.prototype.parseFromString=function(e){return new i(JSON.parse(e))};n.prototype.getNamedItem=function(e){return{nodeValue:this[e]||null}};i.prototype.documentElement=document;i.prototype.convertContent=function(e){var t=new n,s;for(s in e){if(e[s]!==null&&typeof e[s]==="object"){t[s]=Array.isArray(e[s])?e[s].map(r):new i(e[s])}else{t[s]=e[s]}}return t};i.prototype.getElementsByTagName=function(e){return this.attributes[e]?Array.isArray(this.attributes[e])?this.attributes[e]:[this.attributes[e]]:[]};i.prototype.getAttribute=function(e){return this.attributes.getNamedItem(e).nodeValue}})(window.cocoonjsphaser=window.cocoonjsphaser||{});console.log("cocoonjsphaser - fixDOMParser starts");cocoonjsphaser.utils.fixDOMParser();Cocoon.Ad.banner.on("shown",function(){console.log("Banner shown!")});Cocoon.Ad.banner.on("ready",function(){Cocoon.Ad.setBannerLayout(Cocoon.Ad.BannerLayout.BOTTOM_CENTER);Cocoon.Ad.showBanner()});Cocoon.Ad.banner.on("hidden",function(){console.log("Banner hidden!")});Cocoon.Ad.loadBanner()